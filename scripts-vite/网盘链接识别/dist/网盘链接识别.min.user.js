// ==UserScript==
// @name         ç½‘ç›˜é“¾æ¥è¯†åˆ«
// @namespace    https://github.com/WhiteSevs/TamperMonkeyScript
// @version      2026.2.20
// @author       WhiteSevs
// @description  è¯†åˆ«ç½‘é¡µä¸­æ˜¾ç¤ºçš„ç½‘ç›˜é“¾æ¥ï¼Œç›®å‰æ”¯æŒçš„ç½‘ç›˜å¦‚ï¼šç™¾åº¦ç½‘ç›˜ã€è“å¥äº‘ã€å¤©ç¿¼äº‘ã€ä¸­å›½ç§»åŠ¨äº‘ç›˜(åŸ:å’Œå½©äº‘)ã€é˜¿é‡Œäº‘ç›˜ã€æ–‡å”å”ã€123ç›˜ã€è…¾è®¯å¾®äº‘ã€è¿…é›·ç½‘ç›˜ã€115ç½‘ç›˜ã€å¤¸å…‹ç½‘ç›˜ã€åŸé€šç½‘ç›˜(éƒ¨åˆ†)ã€åšæœäº‘ã€UCç½‘ç›˜ã€BTç£åŠ›ã€360äº‘ç›˜ã€å°é£æœºç½‘ç›˜ï¼Œé¡µé¢åŠ¨æ€ç›‘æ§åŠ è½½çš„é“¾æ¥ï¼Œå¯æ·»åŠ è‡ªå®šä¹‰è§„åˆ™æ¥è¯†åˆ«å°ä¼—ç½‘ç›˜/ç½‘èµšç½‘ç›˜æˆ–è€…å…¶å®ƒé“¾æ¥ã€‚
// @license      GPL-3.0-only
// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAACsJJREFUeF7tXW+IHdUVP2c2u8kHIQYL0TRIaK1SgrFFaZsvVkpAo6YR1LJpa9jUd++83SUpSrUNBFRCrVgxNOv+mTOvJBBNmtpamoQG9UNBKLHFDzEtFttKBdOYQENE/Lb75vZd2cVNum/uvXNnZt/MnoGQD+/c8+d3fu+c+2f2PgR+ljQCuKSj5+CBCbDEScAEYAIscQSWePhcAZgASxyBJR4+VwAmQHEIjIyM3DAzM/M1pdSXEfEWALgVANbkaPE0ABwhomdz1GmtSgixHxF3Wg8wC55HxPeVUu8DgP7/jRUrVvxpbGzsY/PQbBK5VwCd9Ha7vVkptRkA9L8yHiKisAxDczaklL8GgAfLsImIryql3gSAqBPnh3nazI0AjUZjbRAEjwLAI3k6aKtLKbUjjuODtvI+cs1m894kSY776Mg49hwAxHkSIRcCSCl10nXy12YMLI9hrxDR/XkoMukQQrQQ8WGTXIGfn0PEZ6IoGvO14U0AKeUJALjH15Ecxr9ARHn2464uCSEOI+K2HHz2VXGUiAZ9lHgRQEp5BgBu9nEgr7FBEGyZmprSZCz8EUIMIuKRwg3ZGfiAiK63E/1/qcwEkFJ+BAArsxrOedzLRPSdnHWmqgvD8EBntj5Ups0UWxeI6NosvmQigBDibUTckMVgAWNKXwHMxSClfBwAtgPA+gLiclX5GhHd6TrImQBhGO5RSu11MHQREY8nSXICEf/R399/bnx8/KLD+CUl2plf3BgEwa1JktyOiN8HgKscAHCuhE4EaDabQ0mSHLBxSCml5weHlFKHWq3WBZsxLHM5AlLKLwLAQwCwCwBWWeLzKBHts5S1fx9ASnkdALxluZPXIiJh6wTLpSMwPDx8U7vd/iEADFtgdTZJko2tVuushawTAZ4EgCdMSpVSW+M4PmaS48/dEZBSWuWgMznfR0R6X8b4WLUA228/Ig5GUXTUaJUFMiMghNiEiK+bFCxbtuxLExMT/zLJ2RLAhnmTRDRiMsif+yMQhuFupdTTaZoQcZfNTqEVAYQQf0TEO1IMXurr69s4OTn5rn94rMEGAYul+Ekiutuky0iAoaGhqwcGBi4ZFD1FRLpK8FMSAkKIHyHiz9PM2bQBIwGklPcBwO9SDH0CAF8hovdKip3NAECj0VgdBMHf05aHSqntcRwfSm0VJjSllD8DgJ90k1NKTcVxbLM8MZnizx0RkFL+BgC6noAi4nNRFD3mSwB96NH1xKnMc3hHfGovbnEoZdweNraAMAxPKaW+0Q1NRFwfRdE7tUe7BwOUUuqTWL3j2u0xHhIZCSCl1K8gdT1pIiKjjh7ErhYujY6OXjM9Pf3ftGBM+TEmT0qpfAzUAukeDsI3P0yAHk6ujWtMABuUaizDBKhxcm1CYwLYoFRjGSZAjZNrExoTwAalGsswAWqcXJvQmAA2KNVYhglQ4+TahMYEsEGpxjK1IYCU8vcAcJvlW8dVTqn+C9+3iGhrHkHUggCmIPIAqhd1mA5qbHw2YWeysehnAWVetGADaMkyzn/Jc6V/dSDAeQBYXTLwvWLOeF5vcrQOBEg9bjYBUPXPTSXaFB8TwIRQj3/OBDC8cNLj+fN2r+oEOE1EX/VBwVTCfHRXYWzBBDDmx7gKMNyF92PfO/pMBPAFKO9Zsyupio7PNz9GAuiAuyzVcrmZo2iA6k4A3/xYEUAb0Xfjtdvt+xBxlVLqeF538jEB8nmrOmt+rAngWvps5ZkA+RDAFu8r5XqBAP9J2f8/R0SfzxrcQuMWgXClxueKVS8QQB8CfbuL48fyOjSZ078IBCg1vsoRYHYSs+BuYN4rgDRbc8CVabMIW5UkwLyZ7O2zAbxR1MWPZVeAeZVH3y5eeHyVJYCr41nlF4sAWf0tetyizwGKDnCx9wHKjs/VHhPgCsR6oS+7JtFHngnABPDhT/XG8hzg8pxxBeAKUL1vsY/HXAG4AvCNJ/M4wC2AW4BPQa3eWG4B3AK4BXAL6F65eCOoelXdyWNuAdwCuAVwC+AWMIcALwN5GejUQisvzHMAngPwHIDnADwH4DlAFw7wPkDlu3x6ADwHyDgHCMPwLqXUJgCYDoLgpampqb9VkSt1JUDW/FgtA6WUvwSAH1yR8Bc7vxSmf9i4Uk8dCeCTHyMBDL8a9j0iOlwlBtSNAL75sSGA/v1Z/TPmCz3/JqIvMAEWDwEppVd+bAhQq3VzDSuAV36YABXfCvYlNBOACbC01s2+35jF6/YLW/aNhysAVwCuAPMRqNpWMFcAx5rsC5ijucLFfePhFsAtgFsAt4AUDviWmMJroKMBjsfxNJABc2RYyeK++VmKc4CevrfPlT9MAEfEZn+cqrR7CR3dcxZnAjhD9unl16XdS5jBPachTAAnuD4Tnr0Bvefu7XMNhwngiljN5JkANUuoazhMAFfEaia/6ATo7+//3Pj4+MWa4VqZcAwEOE9E16UFY7MPkLZu1ro3ENFfK4NYjRwVQtyIiO92CwkR34yiaKMvAY4BwJZuSpRSD8Rx/Nsa4VqZUMIw3KaUSnsr+1dEtM2LAEKIvYi4J4VlB6Mo2lEZ1GrkqBBiEhGbKSE9Q0S7vQggpfwuALyUouRikiTrW63WhRph2/OhSCn1q/qnAeCqlOp8dxzHJ70IMDIycsPMzMw/05QopR6L4/i5nketRg5KKZ8EgCfSQlq+fPnKsbGxj70IoAdLKf8AAJtTmHYmjuNbaoRvT4cyPDx8U7vdPgUAq1Ja86tRFN1lCsS4CtAKwjDcqZTab1DWIiJhMsif+yMgpZwAgGGDpqeISFeJ1MeKADZtQFtRSm2N41ivGvgpCAGb0t8p2ucA4DYi+tDkhhUBZtvA8wDwiFEh4mAURUdNcvy5OwJCiE2I+LrFSKtvv9ZjTYBGo7E2CALdd9ZaODDZ19f3i8nJya6bFBY6WGQeAmEY7lZKPW0BivW334kAs1VAVwBdCWyeSwCg5w2HOvcIvGczgGUuR6DRaKxGRH0Hw0OIuMEGH0TcFUXRmI2sMwFmSXACAO6xNQAAnyilXuysIv4cBMFfoih6x2HskhIdHR29Znp6eo1Saj0iPgAA30qb6S8AzlEiGnQBzboFzFcqpTwDADe7GCpIVm+EHCGiZwvSn6pWCLEfEXcuhu0FbH5ARNe7+pKJALOV4CMAWOlqsCB56sx4w4J0L6h29o2iB8u0mWLrAhFdm8WXzATQxoQQb9v2pizOuYxRSu2I4/igy5isss1m894kSY5nHZ/zuNeI6M6sOr0IoI2GYbhHKbU3qwM5jnulcyx9f476uqoSQrQQ8eEybBlsvOz7G8veBNAONpvNoSRJfgoAaxYRlBeIqJR+3DmHP9w5h089Zi0Yh7N6NUZE+3zt5EKA2TmBfvNE92G9HVw6EYIg2DI1NaVXKIU/QohBRDxSuKGFDexLkuT5VqulSeD95EaAOU+klJ8SQSn1TUS8w9tDOwXepdDOzGdSYRgeUEoNuY7LKH8SEU/29fWdnJiY0LeC5fbkToD5ng0NDV09MDCgSfB1AFiHiOuUUusAINOMtUvUpa8A5pH9cQDYDgDrc8sIgH6vQk+uzyRJcqa/v/9U3kmf72uhBMgRFFZVEAJMgIKArYpaJkBVMlWQn0yAgoCtilomQFUyVZCfTICCgK2KWiZAVTJVkJ9MgIKArYra/wGYigzMiqJYZwAAAABJRU5ErkJggg==
// @supportURL   https://github.com/WhiteSevs/TamperMonkeyScript/issues
// @match        *://*/*
// @require      https://fastly.jsdelivr.net/gh/WhiteSevs/TamperMonkeyScript@86be74b83fca4fa47521cded28377b35e1d7d2ac/lib/CoverUMD/index.js
// @require      https://fastly.jsdelivr.net/gh/WhiteSevs/TamperMonkeyScript@fd6abf2d553ad697ff037f59a12cb800aaa88b53/scripts-vite/%E7%BD%91%E7%9B%98%E9%93%BE%E6%8E%A5%E8%AF%86%E5%88%AB/%E7%BD%91%E7%9B%98%E9%93%BE%E6%8E%A5%E8%AF%86%E5%88%AB-%E5%9B%BE%E6%A0%87.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/utils@2.11.0/dist/index.umd.min.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/domutils@1.9.2/dist/index.umd.min.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/pops@3.3.0/dist/index.umd.min.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/data-paging@0.0.4/dist/index.umd.min.js
// @require      https://fastly.jsdelivr.net/npm/qmsg@1.7.0/dist/index.umd.min.js
// @require      https://fastly.jsdelivr.net/npm/viewerjs@1.11.7/dist/viewer.min.js
// @require      https://fastly.jsdelivr.net/gh/WhiteSevs/TamperMonkeyScript@886625af68455365e426018ecb55419dd4ea6f30/lib/CryptoJS/index.js
// @resource     ViewerCSS  https://fastly.jsdelivr.net/npm/viewerjs@1.11.7/dist/viewer.min.css
// @connect      *
// @connect      lanzoub.com
// @connect      lanzouc.com
// @connect      lanzoue.com
// @connect      lanzouf.com
// @connect      lanzoug.com
// @connect      lanzouh.com
// @connect      lanzoui.com
// @connect      lanzouj.com
// @connect      lanzouk.com
// @connect      lanzoul.com
// @connect      lanzoum.com
// @connect      lanzouo.com
// @connect      lanzoup.com
// @connect      lanzouq.com
// @connect      lanzous.com
// @connect      lanzout.com
// @connect      lanzouu.com
// @connect      lanzouv.com
// @connect      lanzouw.com
// @connect      lanzoux.com
// @connect      lanzouy.com
// @connect      lanosso.com
// @connect      lanzn.com
// @connect      lanzog.com
// @connect      lanpw.com
// @connect      lanpv.com
// @connect      lanzv.com
// @connect      wwentua.com
// @connect      ilanzou.com
// @connect      189.cn
// @connect      123pan.com
// @connect      123pan.cn
// @connect      wenshushu.cn
// @connect      jianguoyun.com
// @connect      cowcs.com
// @connect      aliyundrive.com
// @connect      baidu.com
// @connect      139.com
// @connect      weiyun.com
// @connect      xunlei.com
// @connect      115.com
// @connect      quark.cn
// @connect      jianguoyun.com
// @connect      uc.cn
// @connect      ctfile.com
// @connect      sharepoint.com
// @connect      whatslink.info
// @connect      www.yunpan.com
// @connect      link.yunpan.com
// @connect      api.feijipan.com
// @grant        GM_deleteValue
// @grant        GM_download
// @grant        GM_getResourceText
// @grant        GM_getValue
// @grant        GM_info
// @grant        GM_listValues
// @grant        GM_openInTab
// @grant        GM_registerMenuCommand
// @grant        GM_setValue
// @grant        GM_setValues
// @grant        GM_unregisterMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @run-at       document-start
// ==/UserScript==

(function (U, ct, Ce, g, Vt, aa, na) {
  'use strict';

  var Ye=typeof GM_deleteValue<"u"?GM_deleteValue:void 0,Bt=typeof GM_download<"u"?GM_download:void 0,Rt=typeof GM_getResourceText<"u"?GM_getResourceText:void 0,ie=typeof GM_getValue<"u"?GM_getValue:void 0,je=typeof GM_info<"u"?GM_info:void 0,et=typeof GM_listValues<"u"?GM_listValues:void 0,ia=typeof GM_openInTab<"u"?GM_openInTab:void 0,sa=typeof GM_registerMenuCommand<"u"?GM_registerMenuCommand:void 0,he=typeof GM_setValue<"u"?GM_setValue:void 0,At=typeof GM_setValues<"u"?GM_setValues:void 0,oa=typeof GM_unregisterMenuCommand<"u"?GM_unregisterMenuCommand:void 0,ra=typeof GM_xmlhttpRequest<"u"?GM_xmlhttpRequest:void 0,ne=typeof unsafeWindow<"u"?unsafeWindow:void 0,la=window;const ca={Viewer:{keyName:"ViewerCSS",url:"https://fastly.jsdelivr.net/npm/viewerjs@latest/dist/viewer.min.css"}},Ie={waitRemove(...t){t.forEach(e=>{typeof e=="string"&&U.waitNodeList(e).then(a=>{a.forEach(n=>n.remove());});});},createBlockCSSNode(...t){let e=[];if(t.length!==0&&!(t.length===1&&typeof t[0]=="string"&&t[0].trim()===""))return t.forEach(a=>{Array.isArray(a)?e=e.concat(a):e.push(a);}),U.createElement("style",{type:"text/css",innerHTML:`${e.join(`,
`)}{display: none !important;}`})},addBlockCSS(...t){let e=[];if(t.length!==0&&!(t.length===1&&typeof t[0]=="string"&&t[0].trim()===""))return t.forEach(a=>{Array.isArray(a)?e=e.concat(a):e.push(a);}),$t(`${e.join(`,
`)}{display: none !important;}`)},setGMResourceCSS(t){const e=typeof Rt=="function"?Rt(t.keyName):null;return typeof e=="string"&&e?$t(e):Ie.loadStyleLink(t.url)},async loadStyleLink(t){let e=document.createElement("link");return e.rel="stylesheet",e.type="text/css",e.href=t,new Promise(a=>{U.onReady(()=>{document.head.appendChild(e),a(e);});})},async loadScript(t){let e=document.createElement("script");return e.src=t,new Promise(a=>{e.onload=()=>{a(null);},(document.head||document.documentElement).appendChild(e);})},fixUrl(t){return t=t.trim(),t.startsWith("data:")||t.match(/^http(s|):\/\//i)?t:t.startsWith("//")?(t.startsWith("///")||(t=window.location.protocol+t),t):(t.startsWith("/")||(t+="/"),t=window.location.origin+t,t)},fixHttps(t){if(t.startsWith("https://")||!t.startsWith("http://"))return t;try{let e=new URL(t);return e.protocol="https:",e.toString()}catch{return t}},lockScroll(...t){let e=document.createElement("style");e.innerHTML=`
			.pops-overflow-hidden-important {
				overflow: hidden !important;
			}
		`;let a=[document.documentElement,document.body].concat(...t||[]);return a.forEach(n=>{n.classList.add("pops-overflow-hidden-important");}),(document.head||document.documentElement).appendChild(e),{recovery(){a.forEach(n=>{n.classList.remove("pops-overflow-hidden-important");}),e.remove();}}},async getClipboardText(){function t(n){navigator.clipboard.readText().then(i=>{n(i);}).catch(i=>{m.error("è¯»å–å‰ªè´´æ¿å†…å®¹å¤±è´¥ğŸ‘‰",i),n("");});}function e(n){navigator.permissions.query({name:"clipboard-read"}).then(i=>{t(n);}).catch(i=>{m.error("ç”³è¯·å‰ªè´´æ¿æƒé™å¤±è´¥ï¼Œå°è¯•ç›´æ¥è¯»å–ğŸ‘‰",i.message??i.name??i.stack),t(n);});}function a(){return !(typeof navigator?.clipboard?.readText!="function"||typeof navigator?.permissions?.query!="function")}return new Promise(n=>{if(!a()){n("");return}document.hasFocus()?e(n):window.addEventListener("focus",()=>{e(n);},{once:true});})},escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/Â©/g,"&copy;").replace(/Â®/g,"&reg;").replace(/â„¢/g,"&trade;").replace(/â†’/g,"&rarr;").replace(/â†/g,"&larr;").replace(/â†‘/g,"&uarr;").replace(/â†“/g,"&darr;").replace(/â€”/g,"&mdash;").replace(/â€“/g,"&ndash;").replace(/â€¦/g,"&hellip;").replace(/ /g,"&nbsp;").replace(/\r\n/g,"<br>").replace(/\r/g,"<br>").replace(/\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;")},interval(t,e,a=5e3){let n,i=a-e,s=e,r=async l=>{const o=await t(l);if(typeof o=="boolean"&&o||l){f.workerClearTimeout(n);return}if(s+=e,s>i){r(true);return}n=f.workerSetTimeout(()=>{r(false);},e);};r(false);},findParentNode(t,e,a){if(a){let n=U.closest(t,a);if(n)return n.querySelector(e)}else return U.matches(t,e)?t:U.closest(t,e)},toStr(t){const e="__undefined__placeholder__replaced__str__";return JSON.stringify(t,(n,i)=>i===void 0?e:i,2).replace(new RegExp(`"${e}"`,"g"),"undefined")}},st="GM_Panel",xt="data-init",be="data-key",Re="data-default-value",ua="data-init-more-value",da="data-plugin-search-config",j="data-storage-api",ve={get width(){return globalThis.innerWidth},get height(){return globalThis.innerHeight}},P={setting:{get width(){return ve.width<550?"88vw":ve.width<700?"550px":"700px"},get height(){return ve.height<450?"70vh":ve.height<550?"450px":"550px"}},settingMiddle:{get width(){return ve.width<350?"88vw":"350px"},get height(){return ve.height<450?"88vh":"450px"}},settingBig:{get width(){return ve.width<800?"92vw":"800px"},get height(){return ve.height<600?"80vh":"600px"}},info:{get width(){return ve.width<350?"88vw":"350px"},get height(){return ve.height<250?"88vh":"250px"}}},Be={$data:{__contentConfig:null,get contentConfig(){return this.__contentConfig==null&&(this.__contentConfig=new f.Dictionary),this.__contentConfig},__defaultBottomContentConfig:[]},addContentConfig(t){Array.isArray(t)||(t=[t]);let e=this.$data.contentConfig.keys().length;this.$data.contentConfig.set(e,t);},getAllContentConfig(){return this.$data.contentConfig.values().flat()},getConfig(t=0){return this.$data.contentConfig.get(t)??[]},getDefaultBottomContentConfig(){if(this.$data.__defaultBottomContentConfig.length)return this.$data.__defaultBottomContentConfig;let t=false,e;const a=(s,r)=>{typeof r!="string"&&(r=Ie.toStr(r));const l=new Blob([r]),o=globalThis.URL.createObjectURL(l);h.createElement("a",{href:o,download:s}).click(),f.workerSetTimeout(()=>{globalThis.URL.revokeObjectURL(o);},500);},n=()=>{const s=d=>{const p=z.alert({title:{text:"è¯·é€‰æ‹©å¯¼å…¥æ–¹å¼",position:"center"},content:{text:`
            <div class="btn-control" data-mode="local">æœ¬åœ°å¯¼å…¥</div>
            <div class="btn-control" data-mode="network">ç½‘ç»œå¯¼å…¥</div>
            <div class="btn-control" data-mode="clipboard">å‰ªè´´æ¿å¯¼å…¥</div>`,html:true},btn:{ok:{enable:false},close:{enable:true,callback(M,T){M.close();}}},drag:true,mask:{enable:true},width:P.info.width,height:P.info.height,style:`
          .btn-control{
              display: inline-block;
              margin: 10px;
              padding: 10px;
              border: 1px solid #ccc;
              border-radius: 5px;
              cursor: pointer;
          }
          .btn-control:hover{
            color: #409eff;
            border-color: #c6e2ff;
            background-color: #ecf5ff;
          }`}),w=p.$shadowRoot.querySelector(".btn-control[data-mode='local']"),b=p.$shadowRoot.querySelector(".btn-control[data-mode='network']"),x=p.$shadowRoot.querySelector(".btn-control[data-mode='clipboard']"),C=async M=>{confirm("æ˜¯å¦æ¸…ç©ºè„šæœ¬å­˜å‚¨çš„é…ç½®ï¼Ÿï¼ˆå¦‚æœç‚¹å‡»å–æ¶ˆæŒ‰é’®ï¼Œåˆ™ä»…åšé…ç½®è¦†ç›–å¤„ç†ï¼‰")&&(typeof et=="function"?typeof Ye=="function"?(et().forEach(y=>{Ye(y);}),g.success("å·²æ¸…ç©ºè„šæœ¬å­˜å‚¨çš„é…ç½®")):g.error("ä¸æ”¯æŒGM_deleteValueå‡½æ•°ï¼Œæ— æ³•æ‰§è¡Œåˆ é™¤è„šæœ¬é…ç½®"):g.error("ä¸æ”¯æŒGM_listValueså‡½æ•°ï¼Œæ— æ³•æ¸…ç©ºè„šæœ¬å­˜å‚¨çš„é…ç½®")),typeof At=="function"?At(M):Object.keys(M).forEach(y=>{const v=M[y];he(y,v);}),g.success("é…ç½®å¯¼å…¥å®Œæ¯•");},R=M=>new Promise(async T=>{const _=f.toJSON(M);Object.keys(_).length===0?g.warning("è§£æä¸ºç©ºé…ç½®ï¼Œä¸å¯¼å…¥"):await C(_),T(true);});h.on(w,"click",M=>{h.preventEvent(M),p.close();const T=h.createElement("input",{type:"file",accept:".json"});h.on(T,["propertychange","input"],_=>{if(!T.files?.length)return;const y=T.files[0],v=new FileReader;v.onload=()=>{R(v.result);},v.readAsText(y,"UTF-8");}),T.click();}),h.on(b,"click",M=>{h.preventEvent(M),p.close();const T=z.prompt({title:{text:"ç½‘ç»œå¯¼å…¥",position:"center"},content:{text:"",placeholder:"è¯·å¡«å†™URL",focus:true},btn:{close:{enable:true,callback(v,$){v.close();}},ok:{text:"å¯¼å…¥",callback:async(v,$)=>{const D=v.text;if(f.isNull(D)){g.error("è¯·å¡«å…¥å®Œæ•´çš„url");return}const E=g.loading("æ­£åœ¨è·å–é…ç½®..."),I=await L.get(D,{allowInterceptConfig:false});if(E.close(),!I.status){m.error(I),g.error("è·å–é…ç½®å¤±è´¥",{consoleLogContent:true});return}await R(I.data.responseText)&&v.close();}},cancel:{enable:false}},drag:true,mask:{enable:true},width:P.info.width,height:"auto"}),_=T.$shadowRoot.querySelector("input"),y=T.$shadowRoot.querySelector(".pops-prompt-btn-ok");h.on(_,["input","propertychange"],v=>{h.val(_)===""?h.attr(y,"disabled","true"):h.removeAttr(y,"disabled");}),h.onKeyboard(_,"keydown",(v,$,D)=>{v==="Enter"&&D.length===0&&h.val(_)!==""&&h.emit(y,"click");}),h.emit(_,"input");}),h.on(x,"click",async M=>{h.preventEvent(M),p.close();let T=await Ie.getClipboardText();if(T.trim()===""){g.warning("è·å–åˆ°çš„å‰ªè´´æ¿å†…å®¹ä¸ºç©º");return}await R(T);});},r=(d=`${ot}_panel-setting-${f.formatTime(Date.now(),"yyyy_MM_dd_HH_mm_ss")}.json`,p)=>{const w=z.alert({title:{text:"è¯·é€‰æ‹©å¯¼å‡ºæ–¹å¼",position:"center"},content:{text:`
            <div class="btn-control" data-mode="export-to-file">å¯¼å‡ºè‡³æ–‡ä»¶</div>
            <div class="btn-control" data-mode="export-to-clipboard">å¯¼å‡ºè‡³å‰ªè´´æ¿</div>
            `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(C,R){C.close();}}},drag:true,mask:{enable:true},width:P.info.width,height:P.info.height,style:`
          .btn-control{
              display: inline-block;
              margin: 10px;
              padding: 10px;
              border: 1px solid #ccc;
              border-radius: 5px;
              cursor: pointer;
          }
          .btn-control:hover{
            color: #409eff;
            border-color: #c6e2ff;
            background-color: #ecf5ff;
          }`}),b=w.$shadowRoot.querySelector(".btn-control[data-mode='export-to-file']"),x=w.$shadowRoot.querySelector(".btn-control[data-mode='export-to-clipboard']");h.on(b,"click",C=>{h.preventEvent(C);try{a(d,p),w.close();}catch(R){g.error(R.toString(),{consoleLogContent:true});}}),h.on(x,"click",async C=>{await f.copy(p)?(g.success("å¤åˆ¶æˆåŠŸ"),w.close()):g.error("å¤åˆ¶å¤±è´¥");});},o=z.confirm({title:{text:"é…ç½®",position:"center"},content:{text:`
            <textarea name="config-value" id="config" readonly></textarea>
          `,html:true},btn:{ok:{enable:true,type:"primary",text:"å¯¼å…¥",callback(d,p){s();}},cancel:{enable:true,text:"å¯¼å‡º",callback(d,p){r(void 0,u);}}},width:ve.width<450?"90vw":"450px",height:"auto",style:`
          .pops-content textarea {
            --textarea-bd-color: #dcdfe6;
            display: inline-block;
            resize: vertical;
            padding: 5px 15px;
            margin: 0;
            line-height: normal;
            box-sizing: border-box;
            color: #606266;
            border: 0;
            border-radius: 0;
            outline: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background: none;
            width: 100%;
            height: 100%;
            appearance: none;
            resize: none;
          }
          .pops-content textarea{
            height: 500px;
          }
          .pops-content textarea:focus {
            --textarea-bd-color: #3677f0;
          }
          .pops-content textarea:hover {
            --textarea-bd-color: #c0c4cc;
          }
        `}).$shadowRoot.querySelector("textarea"),c={};if(typeof et=="function")et().forEach(p=>{const w=ie(p);Reflect.set(c,p,w);});else {g.warning("ä¸æ”¯æŒå‡½æ•°GM_listValuesï¼Œä»…å¯¼å‡ºèœå•é…ç½®");const d=ie(st);Reflect.set(c,st,d);}const u=Ie.toStr(c);o.value=u;},i=()=>{let s=je?.script?.supportURL||je?.script?.namespace;typeof s=="string"&&f.isNotNull(s)&&window.open(s,"_blank");};return [{id:"script-version",title:`ç‰ˆæœ¬ï¼š${je?.script?.version||"æœªçŸ¥"}`,isBottom:true,views:[],clickFirstCallback(){return  false},afterRender(s){new Ut(s.$asideLiElement).on("tap",function(l){clearTimeout(e),e=void 0,t?(t=false,n()):(e=setTimeout(()=>{t=false,i();},200),t=true);});}}]},setDefaultBottomContentConfig(t){this.$data.__defaultBottomContentConfig=t;}},ut={$data:{__menuOption:[{key:"show_pops_panel_setting",text:"âš™ è®¾ç½®",autoReload:false,isStoreValue:false,showText(t){return t},callback:()=>{F.showPanel(Be.getConfig(0));}}],get menuOption(){return this.__menuOption}},init(){this.initExtensionsMenu();},initExtensionsMenu(){F.isTopWindow()&&Ke.add(this.$data.menuOption);},addMenuOption(t){Array.isArray(t)||(t=[t]),this.$data.menuOption.push(...t);},updateMenuOption(t){Array.isArray(t)||(t=[t]),t.forEach(e=>{let a=this.$data.menuOption.findIndex(n=>n.key===e.key);a!==-1&&(this.$data.menuOption[a]=e);});},getMenuOption(t=0){return this.$data.menuOption[t]},deleteMenuOption(t=0){this.$data.menuOption.splice(t,1);}};class ze{storageKey;listenerData;constructor(e){if(typeof e=="string"){const a=e.trim();if(a=="")throw new Error("keyå‚æ•°ä¸èƒ½ä¸ºç©ºå­—ç¬¦ä¸²");this.storageKey=a;}else throw new Error("keyå‚æ•°ç±»å‹é”™è¯¯ï¼Œå¿…é¡»æ˜¯å­—ç¬¦ä¸²");this.listenerData=new Ce.Dictionary,this.getLocalValue=this.getLocalValue.bind(this),this.set=this.set.bind(this),this.get=this.get.bind(this),this.getAll=this.getAll.bind(this),this.delete=this.delete.bind(this),this.has=this.has.bind(this),this.keys=this.keys.bind(this),this.values=this.values.bind(this),this.clear=this.clear.bind(this),this.addValueChangeListener=this.addValueChangeListener.bind(this),this.removeValueChangeListener=this.removeValueChangeListener.bind(this),this.emitValueChangeListener=this.emitValueChangeListener.bind(this);}getLocalValue(){let e=ie(this.storageKey);return e==null&&(e={},this.setLocalValue(e)),e}setLocalValue(e){he(this.storageKey,e);}set(e,a){const n=this.get(e),i=this.getLocalValue();Reflect.set(i,e,a),this.setLocalValue(i),this.emitValueChangeListener(e,a,n);}get(e,a){const n=this.getLocalValue();return Reflect.get(n,e)??a}getAll(){return this.getLocalValue()}delete(e){const a=this.get(e),n=this.getLocalValue();Reflect.deleteProperty(n,e),this.setLocalValue(n),this.emitValueChangeListener(e,void 0,a);}has(e){const a=this.getLocalValue();return Reflect.has(a,e)}keys(){const e=this.getLocalValue();return Reflect.ownKeys(e)}values(){const e=this.getLocalValue();return Reflect.ownKeys(e).map(a=>Reflect.get(e,a))}clear(){Ye(this.storageKey);}addValueChangeListener(e,a){const n=Math.random(),i=this.listenerData.get(e)||[];return i.push({id:n,key:e,callback:a}),this.listenerData.set(e,i),n}removeValueChangeListener(e){let a=false;for(const[n,i]of this.listenerData.entries()){for(let s=0;s<i.length;s++){const r=i[s];(typeof e=="string"&&r.key===e||typeof e=="number"&&r.id===e)&&(i.splice(s,1),s--,a=true);}this.listenerData.set(n,i);}return a}async emitValueChangeListener(...e){const[a,n,i]=e;if(!this.listenerData.has(a))return;const s=this.listenerData.get(a);for(let r=0;r<s.length;r++){const l=s[r];if(typeof l.callback=="function"){let o,c;e.length===1||(e.length===2?o=n:e.length===3&&(o=n,c=i)),await l.callback(a,o,c);}}}}const Le=new ze(st),F={$data:{__contentConfigInitDefaultValue:null,__onceExecMenuData:null,__urlChangeReloadMenuExecOnce:null,__onceExecData:null,__panelConfig:{},$panel:null,panelContent:[],get contentConfigInitDefaultValue(){return this.__contentConfigInitDefaultValue==null&&(this.__contentConfigInitDefaultValue=new f.Dictionary),this.__contentConfigInitDefaultValue},contentConfigInitDisabledKeys:[],get onceExecMenuData(){return this.__onceExecMenuData==null&&(this.__onceExecMenuData=new f.Dictionary),this.__onceExecMenuData},get urlChangeReloadMenuExecOnce(){return this.__urlChangeReloadMenuExecOnce==null&&(this.__urlChangeReloadMenuExecOnce=new f.Dictionary),this.__urlChangeReloadMenuExecOnce},get onceExecData(){return this.__onceExecData==null&&(this.__onceExecData=new f.Dictionary),this.__onceExecData},get scriptName(){return ot},get panelConfig(){return this.__panelConfig},set panelConfig(t){this.__panelConfig=t;},key:st,attributeKeyName:be,attributeDefaultValueName:Re},init(){this.initContentDefaultValue(),ut.init();},isTopWindow(){return ne.top===ne.self},initContentDefaultValue(){const t=n=>{if(!n.attributes||n.type==="button"||n.type==="container"||n.type==="deepMenu")return;const i=n.attributes;let s=i[xt];if(typeof s=="function"){let c=s();if(typeof c=="boolean"&&!c)return}let r=new Map,l=i[be];if(l!=null){const c=i[Re];r.set(l,c);}let o=i[ua];if(typeof o=="object"&&o&&Object.keys(o).forEach(c=>{const u=o[c];r.set(c,u);}),!r.size){m.warn("è¯·å…ˆé…ç½®é”®",n);return}if(n.type==="switch"){let c=typeof n.disabled=="function"?n.disabled():n.disabled;typeof c=="boolean"&&c&&this.$data.contentConfigInitDisabledKeys.push(...r.keys());}for(const[c,u]of r.entries())this.setDefaultValue(c,u);},e=n=>{for(let i=0;i<n.length;i++){let s=n[i];t(s);let r=s.views;r&&Array.isArray(r)&&e(r);}},a=[...Be.getAllContentConfig()];for(let n=0;n<a.length;n++){let i=a[n];if(!i.views)continue;const s=i.views;s&&Array.isArray(s)&&e(s);}this.$data.contentConfigInitDisabledKeys=[...new Set(this.$data.contentConfigInitDisabledKeys)];},setDefaultValue(t,e){this.$data.contentConfigInitDefaultValue.has(t)&&m.warn("è¯·æ£€æŸ¥è¯¥key(å·²å­˜åœ¨): "+t),this.$data.contentConfigInitDefaultValue.set(t,e);},getDefaultValue(t){return this.$data.contentConfigInitDefaultValue.get(t)},setValue(t,e){Le.set(t,e);},getValue(t,e){const a=Le.get(t);return a??(this.$data.contentConfigInitDefaultValue.has(t)?this.$data.contentConfigInitDefaultValue.get(t):e)},deleteValue(t){Le.delete(t);},hasKey(t){return Le.has(t)},addValueChangeListener(t,e,a){const n=Le.addValueChangeListener(t,e);if(a?.immediate||a?.immediateAll){const i=this.getValue(t);a?.immediate?e(t,i,i):a?.immediateAll&&F.emitMenuValueChange(t,i,i);}return n},removeValueChangeListener(t){Le.removeValueChangeListener(t);},emitMenuValueChange(t,e,a){Le.emitValueChangeListener(t,e,a);},async exec(t,e,a,n=true){const i=this;let s;typeof t=="string"||Array.isArray(t)?s=()=>t:s=t;let r=false;const l=s();let o=[];Array.isArray(l)?(r=true,o=l):o.push(l);const c=o.find(y=>!this.$data.contentConfigInitDefaultValue.has(y));if(c){m.warn(`${c} é”®ä¸å­˜åœ¨`);return}const u=JSON.stringify(o);if(n&&this.$data.onceExecMenuData.has(u))return this.$data.onceExecMenuData.get(u);let d=[];const p=[];let w=[];const b=(y,v)=>{let $=[],D=[],E=[];if(Array.isArray(v))E=E.concat(v);else {const N=H=>{if(typeof H=="object"&&H!=null)if(H instanceof Element)E.push(H);else {const{$css:W,destory:X}=H;W!=null&&(Array.isArray(W)?E=E.concat(W):E.push(W)),typeof X=="function"&&E.push(X);}else E.push(H);};if(v!=null&&Array.isArray(v))for(const H of v)N(H);else N(v);}const I=N=>{if(N!=null){if(N instanceof Element){$.push(N);return}if(typeof N=="function"){D.push(N);return}}};for(const N of E){const H=I(N);if(typeof H=="boolean"&&!H)break;if(Array.isArray(N))for(const W of N){const X=I(W);if(typeof X=="boolean"&&!X)break}}C(),R(),y&&(d=d.concat($),w=w.concat(D));},x=y=>!!this.getValue(y),C=()=>{for(let y=0;y<d.length;y++)d[y]?.remove(),d.splice(y,1),y--;},R=()=>{for(let y=0;y<w.length;y++){const v=w[y];v(),w.splice(y,1),y--;}},M=()=>{let y=false;return typeof a=="function"?y=a(o):y=o.every(v=>x(v)),y},T=async y=>{const v=M();let $=[];if(v){const D=o.map(E=>this.getValue(E));$=await e({key:o,value:r?D:D[0],addStoreValue:(...E)=>b(v,E)});}b(v,$);};n&&o.forEach(y=>{const v=this.addValueChangeListener(y,($,D,E)=>T());p.push(v);}),await T();const _={reload(){this.clearStoreStyleElements(),this.destory(),T();},clear(){this.clearStoreStyleElements(),this.destory(),this.removeValueChangeListener(),this.clearOnceExecMenuData();},clearStoreStyleElements:()=>C(),destory(){return R()},removeValueChangeListener:()=>{p.forEach(y=>{this.removeValueChangeListener(y);});},clearOnceExecMenuData(){n&&i.$data.onceExecMenuData.delete(u);}};return this.$data.onceExecMenuData.set(u,_),_},async execMenu(t,e,a=false,n=false){return await this.exec(t,async i=>await e(i),i=>i.every(r=>{let l=!!this.getValue(r);return F.$data.contentConfigInitDisabledKeys.includes(r)&&(l=false,m.warn(`.execMenu${n?"Once":""} ${r} è¢«ç¦ç”¨`)),a&&(l=!l),l}),n)},async execMenuOnce(t,e,a=false,n=false){const i=await this.execMenu(t,e,a,true);if(n&&i){const s=()=>{i.reload();};this.removeUrlChangeWithExecMenuOnceListener(t),this.addUrlChangeWithExecMenuOnceListener(t,s);}return i},deleteExecMenuOnce(t){return t=this.transformKey(t),this.$data.onceExecMenuData.delete(t),this.$data.urlChangeReloadMenuExecOnce.delete(t),Le.removeValueChangeListener(t)},onceExec(t,e){if(t=this.transformKey(t),typeof t!="string")throw new TypeError("key å¿…é¡»æ˜¯å­—ç¬¦ä¸²");this.$data.onceExecData.has(t)||(e(),this.$data.onceExecData.set(t,1));},deleteOnceExec(t){t=this.transformKey(t),this.$data.onceExecData.delete(t);},addUrlChangeWithExecMenuOnceListener(t,e){t=this.transformKey(t),this.$data.urlChangeReloadMenuExecOnce.set(t,e);},removeUrlChangeWithExecMenuOnceListener(t){t=this.transformKey(t),this.$data.urlChangeReloadMenuExecOnce.delete(t);},hasUrlChangeWithExecMenuOnceListener(t){return t=this.transformKey(t),this.$data.urlChangeReloadMenuExecOnce.has(t)},async emitUrlChangeWithExecMenuOnceEvent(t){const e=this.$data.urlChangeReloadMenuExecOnce.values();for(const a of e)await a(t);},showPanel(t,e=`${ot}-è®¾ç½®`,a=false,n=false){this.$data.$panel=null,this.$data.panelContent=[];const i=t.findIndex(r=>(typeof r.isBottom=="function"?r.isBottom():!!r.isBottom)&&r.id==="script-version")!==-1;!a&&!i&&t.push(...Be.getDefaultBottomContentConfig());const s=z.panel({title:{text:e,position:"center",html:false,style:""},content:t,btn:{close:{enable:true,callback:(r,l)=>{r.close(),this.$data.$panel=null;}}},mask:{enable:true,clickEvent:{toClose:true,toHide:false},clickCallBack:(r,l)=>{r(),this.$data.$panel=null;}},width:P.setting.width,height:P.setting.height,drag:true,only:true,style:`
        .pops-switch-shortcut-wrapper{
          margin-right: 5px;
          display: inline-flex;
        }
        .pops-switch-shortcut-wrapper:hover .pops-bottom-icon{
          cursor: pointer;
        }
        `,...this.$data.panelConfig});this.$data.$panel=s,this.$data.panelContent=t,n||this.registerConfigSearch({$panel:s,content:t});},registerConfigSearch(t){const{$panel:e,content:a}=t,n=async(p,w)=>{if(p==null)return;const b=await w(p);return b&&typeof b.isFind=="boolean"&&b.isFind?b.data:await n(b.data,w)},i=(p,w)=>{const b=new IntersectionObserver(x=>{x.forEach(C=>{C.isIntersecting&&(w?.(),b.disconnect());});},{root:null,threshold:1});b.observe(p),p.scrollIntoView({behavior:"smooth",block:"center"});},s=p=>{const w="pops-flashing";h.onAnimationend(p,()=>{p.classList.remove(w);}),p.classList.add(w);},r=p=>{if(p.type==="dblclick"&&d)return;h.preventEvent(p),o=null;const w=z.alert({title:{text:"æœç´¢é…ç½®",position:"center"},content:{text:`
						<div class="search-wrapper">
							<input class="search-config-text" name="search-config" type="text" placeholder="è¯·è¾“å…¥éœ€è¦æœç´ çš„é…ç½®åç§°">
						</div>
						<div class="search-result-wrapper"></div>
					`,html:true},btn:{ok:{enable:false}},mask:{clickEvent:{toClose:true}},width:P.settingMiddle.width,height:"auto",drag:true,style:`
					${z.config.cssText.panelCSS}

					.search-wrapper{
						border-bottom: 1px solid rgb(235, 238, 245, 1);
					}
					.pops-content:has(.search-result-wrapper:empty) .search-wrapper{
						border-bottom: 0;
					}
					.search-config-text{
						width: 100%;
						border: 0;
						height: 32px;
						padding: 0px 10px;
						outline: none;
					}
					.search-result-wrapper{
						max-height: 400px;
						overflow: auto;
					}
					.search-result-item{
						cursor: pointer;
						padding: 5px 10px;
						display: flex;
						flex-direction: column;
					}
					.search-result-item:hover{
						background-color: #D8F1FD;
					}
					.search-result-item-path{
						display: flex;
    					align-items: center;
					}
					.search-result-item-description{
						font-size: 0.8em;
						color: #6c6c6c;
					}
					${t.searchDialogStyle??""}
				`});w.$shadowRoot.querySelector(".search-wrapper");const b=w.$shadowRoot.querySelector(".search-config-text"),x=w.$shadowRoot.querySelector(".search-result-wrapper");b.focus();const C=()=>{h.empty(x);},R=T=>{const _=f.queryProperty(T,$=>$?.next?{isFind:false,data:$.next}:{isFind:true,data:$}),y=h.createElement("div",{className:"search-result-item",innerHTML:`
							<div class="search-result-item-path">${_.matchedData?.path}</div>
							<div class="search-result-item-description">${_.matchedData?.description??""}</div>
						`}),v=z.config.PanelHandlerComponents();return h.on(y,"click",$=>{const E=e.$shadowRoot.querySelectorAll("aside.pops-panel-aside .pops-panel-aside-top-container li")[T.index];if(!E){g.error(`å·¦ä¾§é¡¹ä¸‹æ ‡${T.index}ä¸å­˜åœ¨`);return}E.scrollIntoView({behavior:"smooth",block:"center"}),E.click(),n(T.next,async I=>{if(I?.next){const N=await h.waitNode(()=>Array.from(e.$shadowRoot.querySelectorAll(".pops-panel-deepMenu-nav-item")).find(H=>{const W=Reflect.get(H,v.$data.nodeStoreConfigKey);return typeof W=="object"&&W!=null&&W.text===I.name}),2500);if(N)N.click();else return g.error("æœªæ‰¾åˆ°å¯¹åº”çš„äºŒçº§èœå•"),{isFind:true,data:I};return {isFind:false,data:I.next}}else {const N=await h.waitNode(()=>Array.from(e.$shadowRoot.querySelectorAll("li:not(.pops-panel-deepMenu-nav-item)")).find(H=>Reflect.get(H,v.$data.nodeStoreConfigKey)===I.matchedData?.formConfig),2500);if(N){i(N);const H=N.closest(".pops-panel-forms-fold[data-fold-enable]");H&&(H.querySelector(".pops-panel-forms-fold-container").click(),await f.sleep(500)),i(N,()=>{s(N);});}else g.error("æœªæ‰¾åˆ°å¯¹åº”çš„èœå•é¡¹");return {isFind:true,data:I}}});}),y},M=T=>{const _=new RegExp(T,"i"),y=[],v=(D,E)=>{for(let I=0;I<D.length;I++){const N=D[I],H=N.views;if(H&&Array.isArray(H)){const W=f.deepClone(E);if(N.type==="deepMenu"){const X=f.queryProperty(W,oe=>oe?.next?{isFind:false,data:oe.next}:{isFind:true,data:oe});X.next={name:N.text};}v(H,W);}else {let W,X;if(N.type==="own"){const Q=Reflect.get(N.attributes||{},da);Q&&(typeof Q.text=="string"&&(W=Q.text),typeof Q.desc=="string"&&(X=Q.desc));}else W=N.text,X=Reflect.get(N,"description");const oe=[W,X],_e=oe.findIndex(Q=>{if(typeof Q=="string")return Q.match(_)});if(_e!==-1){const Q=f.deepClone(E),ge=f.queryProperty(Q,Ee=>Ee?.next?{isFind:false,data:Ee.next}:{isFind:true,data:Ee});ge.next={name:W,matchedData:{path:"",formConfig:N,matchedText:oe[_e],description:X}};const mt=[];f.queryProperty(Q,Ee=>{const wt=Ee?.name;return typeof wt=="string"&&wt.trim()!==""&&mt.push(wt),Ee?.next?{isFind:false,data:Ee.next}:{isFind:true,data:Ee}});const ta=mt.join(Ie.escapeHtml(" - "));ge.next.matchedData.path=ta,y.push(Q);}}}};for(let D=0;D<a.length;D++){const E=a[D];if(!E.views||E.isBottom&&E.id==="script-version")continue;const I=E.views;if(I&&Array.isArray(I)){let N=E.title;typeof N=="function"&&(N=N()),v(I,{index:D,name:N});}}const $=document.createDocumentFragment();for(const D of y){let E=R(D);$.appendChild(E);}C(),x.append($);};h.on(b,"input",f.debounce(T=>{h.preventEvent(T);let _=h.val(b).trim();if(_===""){C();return}M(_);},200));};e.$shadowRoot.querySelectorAll("aside.pops-panel-aside .pops-panel-aside-item:not(#script-version)").forEach(p=>{h.on(p,"dblclick",r);});let o=null,c=false,u,d=false;h.on(e.$shadowRoot,"touchend","aside.pops-panel-aside .pops-panel-aside-item:not(#script-version)",(p,w)=>{d=true,clearTimeout(u),u=void 0,c&&o===w?(c=false,o=null,r(p)):(u=setTimeout(()=>{c=false;},200),c=true,o=w);},{capture:true}),e.$shadowRoot.appendChild(h.createElement("style",{type:"text/css",textContent:`
					.pops-flashing{
						animation: double-blink 1.5s ease-in-out;
					}
					@keyframes double-blink {
						 0% {
							background-color: initial;
						}
						25% {
							background-color: yellow;
						}
						50% {
							background-color: initial;
						}
						75% {
							background-color: yellow;
						}
						100% {
							background-color: initial;
						}
					}
				`}));},transformKey(t){if(Array.isArray(t)){const e=t.sort();return JSON.stringify(e)}else return t},getDynamicValue(t,e){const a=this;let n=false,i=e;const s=this.addValueChangeListener(t,(r,l)=>{i=l;});return {get value(){return n||(n=true,i=a.getValue(t,e)),i},destory(){a.removeValueChangeListener(s);}}}},Pe={qmsg_config_position:{key:"qmsg-config-position",defaultValue:"bottom"},qmsg_config_maxnums:{key:"qmsg-config-maxnums",defaultValue:3},qmsg_config_showreverse:{key:"qmsg-config-showreverse",defaultValue:false}},f=Ce.noConflict(),h=U.noConflict(),z=ct,m=new f.Log(je,ne.console||la.console),ot=je?.script?.name||void 0,Ut=ct.config.Utils.AnyTouch(),pa=false;m.config({debug:false,logMaxCount:250,autoClearConsole:true,tag:true});g.config({isHTML:true,autoClose:true,showClose:false,consoleLogContent(t){const e=t.setting.type;if(e==="loading")return  false;const a=t.setting.content;return e==="warning"?m.warn(a):e==="error"?m.error(a):m.info(a),false},get position(){return F.getValue(Pe.qmsg_config_position.key,Pe.qmsg_config_position.defaultValue)},get maxNums(){return F.getValue(Pe.qmsg_config_maxnums.key,Pe.qmsg_config_maxnums.defaultValue)},get showReverse(){return F.getValue(Pe.qmsg_config_showreverse.key,Pe.qmsg_config_showreverse.defaultValue)},get zIndex(){let t=Ce.getMaxZIndex(),e=ct.config.InstanceUtils.getPopsMaxZIndex().zIndex;return Ce.getMaxValue(t,e)+100}});z.GlobalConfig.setGlobalConfig({zIndex:()=>{const t=Ce.getMaxZIndex(void 0,void 0,a=>{if(a?.classList?.contains("qmsg-shadow-container")||a?.closest("qmsg")&&a.getRootNode()instanceof ShadowRoot)return  false}),e=ct.config.InstanceUtils.getPopsMaxZIndex().zIndex;return Ce.getMaxValue(t,e)+100},mask:{enable:true,clickEvent:{toClose:false,toHide:false}},drag:true});const Ke=new f.GM_Menu({GM_getValue:ie,GM_setValue:he,GM_registerMenuCommand:sa,GM_unregisterMenuCommand:oa}),L=new f.Httpx({xmlHttpRequest:ra,logDetails:pa});L.interceptors.request.use(t=>t);L.interceptors.response.use(void 0,t=>(m.error("æ‹¦æˆªå™¨-è¯·æ±‚é”™è¯¯",t),t.type==="onabort"?g.warning("è¯·æ±‚å–æ¶ˆ",{consoleLogContent:true}):t.type==="onerror"?g.error("è¯·æ±‚å¼‚å¸¸",{consoleLogContent:true}):t.type==="ontimeout"?g.error("è¯·æ±‚è¶…æ—¶",{consoleLogContent:true}):g.error("å…¶å®ƒé”™è¯¯",{consoleLogContent:true}),t));ne.Object.defineProperty,ne.Object.keys,ne.Object.values,ne.Function.prototype.apply,ne.Function.prototype.call,ne.Element.prototype.appendChild,ne.setTimeout.bind(ne),ne.clearTimeout.bind(ne),ne.setInterval.bind(ne),ne.clearInterval.bind(ne);const $t=h.addStyle.bind(h),ce=U.selector.bind(U),ha=U.selectorAll.bind(U),fa=new f.GM_Cookie,$e=ot||"ç½‘ç›˜é“¾æ¥è¯†åˆ«",zt=aa,He=Vt??window.CryptoJS??ne.CryptoJS,Ct=function(t,e,a,n,i,s,r,l,o,c){const u={text:t,type:"button",attributes:{},props:{},description:e,buttonIcon:n,buttonIsRightIcon:i,buttonIconIsLoading:s,buttonType:r,buttonText:a,callback(d){typeof l=="function"&&l(d);},afterAddToUListCallBack:o};return Reflect.set(u.attributes,xt,()=>{u.disable=false;}),u},Te=function(t,e,a,n,i,s="default",r,l){const o=i,c=()=>r.getShowText(a,o),u=Ct(t,e,c,"keyboard",false,false,s,async d=>{if(d instanceof PointerEvent&&d.x===0&&d.y===0)return;const w=d.target.closest(".pops-panel-button")?.querySelector("span");if(r.isWaitKeyboardPress()){g.warning("è¯·å…ˆæ‰§è¡Œå½“å‰çš„å½•å…¥æ“ä½œ");return}if(r.hasOptionValue(a))r.emptyOption(a),g.success("æ¸…ç©ºå¿«æ·é”®");else {const b=g.loading("è¯·æŒ‰ä¸‹å¿«æ·é”®...",{showClose:true,onClose(){r.cancelEnterShortcutKeys();}}),{status:x,option:C,key:R}=await r.enterShortcutKeys(a);b.close(),x?(m.success("å½•å…¥å¿«æ·é”®",C),g.success("å½•å…¥æˆåŠŸ")):g.error(`å¿«æ·é”® ${r.translateKeyboardValueToButtonText(C)} å·²è¢« ${R} å ç”¨`);}h.html(w,c());});return u.attributes={},Reflect.set(u.attributes,xt,()=>false),u},re=function(t,e,a,n,i,s="",r="text",l,o){const c={text:t,type:"input",inputType:r,attributes:{},props:{},description:n,placeholder:s,afterAddToUListCallBack:l,getValue(){return this.props[j].get(e,a)},callback(u,d){u.target.validity.valid,this.props[j].set(e,d);}};return Reflect.set(c.attributes,be,e),Reflect.set(c.attributes,Re,a),Fe.initComponentsStorageApi("input",c,{get(u,d){return F.getValue(u,d)},set(u,d){F.setValue(u,d);}}),c},bt=function(t,e,a,n,i,s="",r,l){const o={text:t,type:"input",inputType:"number",attributes:{},props:{},description:n,placeholder:s,afterAddToUListCallBack:r,getValue(){return this.props[j].get(e,a)},callback(c,u,d){if(typeof i=="function"&&i(c,u,d))return;this.props[j].set(e,u);}};return Reflect.set(o.attributes,be,e),Reflect.set(o.attributes,Re,a),Fe.initComponentsStorageApi("input",o,{get(c,u){return F.getValue(c,u)},set(c,u){F.setValue(c,u);}}),o},Me=function(t,e,a,n,i,s,r){const l={text:t,type:"select",description:s,attributes:{},props:{},getValue(){return this.props[j].get(e,a)},callback(o){if(o==null)return;const c=o.value;m.info(`é€‰æ‹©ï¼š${o.text}`),this.props[j].set(e,c);},data:n};return Reflect.set(l.attributes,be,e),Reflect.set(l.attributes,Re,a),Fe.initComponentsStorageApi("select",l,{get(o,c){return F.getValue(o,c)},set(o,c){F.setValue(o,c);}}),l},Ft=function(t,e,a,n,i,s,r="è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªé€‰é¡¹",l,o){let c=[];typeof n=="function"?c=n():c=n;const u={text:t,type:"select-multiple",description:s,placeholder:r,attributes:{},props:{},getValue(){return this.props[j].get(e,a)},selectConfirmDialogConfig:l,callback(d){const p=this.props[j],w=[];d.forEach(b=>{w.push(b.value);}),m.info("å¤šé€‰-é€‰æ‹©ï¼š",w),p.set(e,w);},data:c};return Reflect.set(u.attributes,be,e),Reflect.set(u.attributes,Re,a),Fe.initComponentsStorageApi("select-multiple",u,{get(d,p){return F.getValue(d,p)},set(d,p){F.setValue(d,p);}}),u},ye=function(t,e,a,n,i,s,r,l,o,c){const u={text:t,type:"slider",description:l,attributes:{},props:{},getValue(){return this.props[j].get(e,a)},getToolTipContent(d){return typeof r=="function"?r(d):`${d}`},callback(d,p){if(typeof s=="function"&&s(d,p))return;this.props[j].set(e,p);},min:n,max:i,step:o};return Reflect.set(u.attributes,be,e),Reflect.set(u.attributes,Re,a),Fe.initComponentsStorageApi("slider",u,{get(d,p){return F.getValue(d,p)},set(d,p){F.setValue(d,p);}}),u},Fe={$data:{__storeApiFn:null,get storeApiValue(){return this.__storeApiFn||(this.__storeApiFn=new Ce.Dictionary),this.__storeApiFn}},getStorageApi(t){if(this.hasStorageApi(t))return this.$data.storeApiValue.get(t)},hasStorageApi(t){return this.$data.storeApiValue.has(t)},setStorageApi(t,e){this.$data.storeApiValue.set(t,e);},initComponentsStorageApi(t,e,a){let n;this.hasStorageApi(t)?n=this.getStorageApi(t):n=a,this.setComponentsStorageApiProperty(e,n);},setComponentsStorageApiProperty(t,e){Reflect.set(t.props,j,e);}},Z=function(t,e,a,n,i,s,r,l,o){const c={text:t,type:"switch",description:i,disabled:r,attributes:{},props:{},getValue(){return this.props[j].get(e,a)},callback(u,d){const p=!!d;if(m.success(`${p?"å¼€å¯":"å…³é—­"} ${t}`),typeof n=="function"&&n(u,p))return;this.props[j].set(e,p),typeof l=="function"&&l(u,p);},afterAddToUListCallBack:(...u)=>{}};return Reflect.set(c.attributes,be,e),Reflect.set(c.attributes,Re,a),Fe.initComponentsStorageApi("switch",c,{get(u,d){return F.getValue(u,d)},set(u,d){F.setValue(u,d);}}),c},ga={tianYiYunLoginTip:{PC:{width:"30vw",height:"280px"},Mobile:{width:"80vw",height:"250px"}},jianGuoYunLoginTip:{PC:{width:"350px",height:"200px"},Mobile:{width:"350px",height:"200px"}},settingView:{PC:{width:"800px",height:"600px"},Mobile:{width:"92vw",height:"80vh"}},setDefaultValueView:{PC:{width:"350px",height:"200px"},Mobile:{width:"350px",height:"200px"}},mainView:{PC:{width:"500px",height:"100%"},Mobile:{width:"88vw",height:"50vh"}},mainViewSmallWindow:{PC:{get width(){return k.smallWindow["netdisk-ui-small-window-width"].value+"px"},height:"auto"},Mobile:{get width(){return k.smallWindow["netdisk-ui-small-window-width"].value+"px"},height:"auto"}},oneFileStaticView:{PC:{width:"550px",height:"350px"},Mobile:{width:"88vw",height:"300px"}},moreFileStaticView:{PC:{width:"700px",height:"600px"},Mobile:{width:"88vw",height:"500px"}},inputNewAccessCodeView:{PC:{width:"400px",height:"200px"},Mobile:{width:"88vw",height:"160px"}},historyMatchView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},customRulesView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},customRuleDebugView:{PC:{width:"55vw",height:"70vh"},Mobile:{width:"88vw",height:"70vh"}},matchPasteTextView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},accessCodeRuleView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},accessCodeRuleEditView:{PC:{width:"44vw",height:"50vh"},Mobile:{width:"70vw",height:"45vh"}},websiteRuleView:{PC:{width:"45vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},websiteEditRuleView:{PC:{width:"45vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}}},Ne=function(t,e){return {KEY:t,default:e,get value(){return ie(t,e)},set value(a){he(t,a);}}};class ma{option;constructor(e){this.option=e;}async showView(){const e=z.confirm({title:{text:this.option.title,position:"center"},content:{text:`
        <form class="rule-form-container" onsubmit="return false">
            <ul class="rule-form-ulist"></ul>
            <input type="submit" style="display: none;" />
        </form>
        `,html:true},btn:f.assign({ok:{callback:async()=>{await s();}}},this.option.btn||{},true),drag:true,mask:{enable:true},style:`
      ${z.config.cssText.panelCSS}
      
      .rule-form-container {
          
      }
      .rule-form-container li{
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 5px 20px;
          gap: 10px;
      }
      .rule-form-ulist-dynamic{
        --button-margin-top: 0px;
        --button-margin-right: 0px;
        --button-margin-bottom: 0px;
        --button-margin-left: 0px;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        padding: 5px 0px 5px 20px;
      }
      .rule-form-ulist-dynamic__inner{
        width: 100%;
      }
      .rule-form-ulist-dynamic__inner-container{
        display: flex;
        align-items: center;
      }
      .dynamic-forms{
        width: 100%;
      }
      .pops-panel-item-left-main-text{
          max-width: 150px;
      }
      .pops-panel-item-right-text{
          padding-left: 30px;
      }
      .pops-panel-item-right-text,
      .pops-panel-item-right-main-text{
          text-overflow: ellipsis;
          overflow: hidden;
          white-space: nowrap;
      }
      .pops-panel-item-left-desc-text{
        line-height: normal;
        margin-top: 6px;
        font-size: 0.8em;
        color: rgb(108, 108, 108);
      }

      ${this.option?.style??""}
      `,width:typeof this.option.width=="function"?this.option.width():window.innerWidth>500?"500px":"88vw",height:typeof this.option.height=="function"?this.option.height():window.innerHeight>500?"500px":"80vh"}),a=e.$shadowRoot.querySelector(".rule-form-container");e.$shadowRoot.querySelector("input[type=submit]");const n=e.$shadowRoot.querySelector(".rule-form-ulist"),i=await this.option.getView(await this.option.data());h.append(n,i);const s=async()=>{(await this.option.onsubmit(a,await this.option.data())).success&&(e.close(),typeof this.option.dialogCloseCallBack=="function"&&await this.option.dialogCloseCallBack(true));};return e}}class Pt{option;constructor(e){this.option=e;}async showView(e){const a=this,n=this.option.contentConfig;n.forEach(i=>{i.views=[],i.headerTitle=i.headerTitle||i.title,i.subscribe?.enable&&(i.headerTitle=i.headerTitle+`
					<div class="subscribe-container">
						<button class="subscribe-btn" type="button" data-type="subscribe" data-has-icon="false" data-righticon="false">
							<span>${i.subscribe?.title||"è®¢é˜…"}</span>
						</button>
					</div>`);let s=i.clickCallback;i.clickCallback=async(r,l,o)=>{if(typeof s=="function"&&s(r,o,o),i.subscribe&&i.subscribe.enable){let u=l.querySelector(".subscribe-btn");const d=i.subscribe;h.on(u,"click",async p=>{h.preventEvent(p),await d?.callback?.();const w=await this.enterDeepMenu(o,d?.headerTitle||d?.title||"è®¢é˜…",()=>{this.updateRuleContaienrElement(i.ruleOption,d,o);}),b=w.$rightRuleContainer;(await this.createButtonControls(b,b,d,async()=>{let C=z.prompt({title:{text:"æ·»åŠ è®¢é˜…",position:"center"},content:{text:"",focus:true,placeholder:"è¾“å…¥URL"},btn:{cancel:{enable:false},ok:{enable:true,text:"ä¸‹ä¸€æ­¥",async callback(T,_){let y=h.val(R).trim();if(y==="")return;m.info("è®¢é˜…ï¼š"+y);let v=g.loading("æ­£åœ¨è·å–è®¢é˜…ä¿¡æ¯...");try{let $=await d?.getSubscribeInfo(y);if($.data){T.close();let D=$.data,E=D.data.title||D.subscribeData.title||D.data.url,I=z.alert({title:{text:"æ·»åŠ è®¢é˜…",position:"center"},content:{text:`
																	<div class="subscribe-network-title">
																		<span>è®¢é˜…é“¾æ¥åç§°ï¼š</span>
																		<input type="text" placeholder="è¾“å…¥è®¢é˜…é“¾æ¥çš„åç§°">
																	</div>
																	<div class="subscribe-network-data-count"></div>
																	<div class="subscribe-network-home-url"></div>
																	<div class="subscribe-network-url"></div>
																	<div class="subscribe-network-version"></div>
																	<div class="subscribe-network-last-modified"></div>
																`,html:!0},btn:{ok:{text:"æ·»åŠ ",type:"subscribe",callback:async(Q,ge)=>{await d.addData(D)||g.error("è¯¥è®¢é˜…å·²å­˜åœ¨",{consoleLogContent:!0}),a.updateRuleContaienrElement(d,d,w.$section),Q.close();}}},drag:!0,mask:{enable:!0},width:P.setting.width,height:"auto",style:`
																.pops button[data-type="subscribe"]{
																	--button-color: #ffffff;
																	--button-bd-color: #67b279;
																	--button-bg-color: #67b279;
																}
																.pops button[data-type="subscribe"]:hover{
																	--button-color: #ffffff;
																	--button-bd-color:rgb(91, 159, 107);;
																	--button-bg-color:rgb(91, 159, 107);;
																}

																.pops-alert-content{
																	display: flex;
																	flex-direction: column;
																	gap: 4px;
																	padding: 20px;
																}
																.pops-alert-content a {
																	color: #3d3d3d;
																}
																.pops-alert-content > div{
																	display: flex;
																}
																.pops-alert-content > div > span:first-child{
																	white-space: nowrap;
																}
																.subscribe-network-title input{
																	width: 100%;
																	flex: 1 1 auto;
																	line-height: 1.3;
																	outline: none;
																	text-overflow: ellipsis;
																	border-radius: 8px;
																	border: 1px solid #e4e4e4;
																	background-color: #f6f6f6;
																	padding: 16px 16px 16px 16px;
																	font-size: 16px;
																}
																.subscribe-network-title input:focus{

																}
															`}),N=I.$shadowRoot.querySelector(".subscribe-network-title input"),H=I.$shadowRoot.querySelector(".subscribe-network-data-count"),W=I.$shadowRoot.querySelector(".subscribe-network-home-url"),X=I.$shadowRoot.querySelector(".subscribe-network-url"),oe=I.$shadowRoot.querySelector(".subscribe-network-version"),_e=I.$shadowRoot.querySelector(".subscribe-network-last-modified");h.val(N,E),h.on(N,["input","propertychange"],Q=>{let ge=h.val(N);D.data.title=ge===""?void 0:ge;}),h.html(H,`
																<span>è§„åˆ™æ•°é‡ï¼š</span>
																<span>${D.subscribeData.ruleData.length}</span>
															`),typeof D.subscribeData.homePage=="string"?h.html(W,`
																<span>ä¸»é¡µï¼š</span>
																<a href="${D.subscribeData.homePage}" target="_blank">${D.subscribeData.homePage}</a>
															`):W.remove(),h.html(X,`
																<span>URLï¼š</span>
																<a href="${D.data.url}" target="_blank">${D.data.url}</a>
															`),D.subscribeData.version!=null?h.html(oe,`
																	<span>ç‰ˆæœ¬ï¼š</span>
																	<span>${D.subscribeData.version}</span>
																`):oe.remove(),D.subscribeData.lastModified!=null?h.html(_e,`
																	<span>æ›´æ–°æ—¶é—´ï¼š</span>
																	<span>${f.formatTime(D.subscribeData.lastModified)}</span>
																`):_e.remove();}else g.error($.msg,{consoleLogContent:!0});}catch($){g.error($.toString(),{consoleLogContent:true});}finally{v.close();}}}},drag:true,mask:{enable:true},width:P.info.width,height:"auto"}),R=C.$shadowRoot.querySelector("input"),M=C.$shadowRoot.querySelector(".pops-prompt-btn-ok ");h.on(R,["input","propertychange"],T=>{h.val(R)===""?h.attr(M,"disabled","true"):h.removeAttr(M,"disabled");}),h.onKeyboard(R,"keydown",(T,_,y,v)=>{T==="Enter"&&y.length===0&&(h.preventEvent(v),h.emit(M,"click"));}),h.emit(R,"input");})).execFilter(true);});}await(await this.createButtonControls(o,o,i.ruleOption,async()=>{this.showEditView(i.ruleOption,void 0,false,await i.ruleOption.getAddData(),o);})).execFilter(true);};}),z.panel({title:{text:typeof this.option.title=="function"?this.option.title():this.option.title,position:"center"},content:n,btn:{close:{enable:true,callback(i,s){i.close();}}},drag:true,mask:{enable:true,clickEvent:{toClose:false}},class:this.option.className||"rule-panel-view",width:P.settingBig.width,height:P.settingBig.height,style:`
      ${this.option.style||""}

      .pops button[data-type="subscribe"]{
          --button-color: #ffffff;
          --button-bd-color: #67b279;
          --button-bg-color: #67b279;
      }
      .pops button[data-type="subscribe"]:hover{
          --button-color: #ffffff;
          --button-bd-color:rgb(91, 159, 107);;
          --button-bg-color:rgb(91, 159, 107);;
      }
      section.pops-panel-container .pops-panel-container-header-ul li:has(.subscribe-btn){
          justify-content: space-between !important;
      }
      section.pops-panel-container ul li.rule-controls{
        justify-content: flex-start;
        overflow-x: auto;
      }

      section.pops-panel-container ul:has(>.rule-view-container){
        overflow: hidden;
        display: flex;
        flex-direction: column;
        margin: var(--pops-panel-forms-container-item-margin-top-bottom) var(--pops-panel-forms-margin-left-right);
        gap: var(--pops-panel-forms-container-item-margin-top-bottom);
      }

      .rule-view-container{
        margin: 0;
        margin-top: 0;
        overflow: auto;
        background: #ffffff;
        border-radius: var(--pops-panel-forms-container-item-border-radius);
        padding: 5px 10px;
        position: relative;
        flex: 1;
      }
      .rule-view-container:empty{
        display: none;
      }
      .rule-item{
        display: flex;
        align-items: center;
        line-height: normal;
        font-size: 16px;
        padding: 4px 8px;
        gap: 8px;
      }
      .rule-name{
        flex: 1;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
      }
      .rule-controls{
        display: flex;
        align-items: center;
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
        gap: 8px;
        padding: 0px;
      }
      .rule-controls button{
        margin: 0;
      }
      .rule-controls-enable{
        
      }
      .rule-controls-edit{
        
      }
      .rule-controls-delete{
        
      }
      .rule-controls-edit,
      .rule-controls-delete{
        width: 16px;
        height: 16px;
        cursor: pointer;
      }

      section.pops-panel-container > ul li:not(.pops-panel-forms-container-item){
        margin: 0;
      }
        
        
        
      .rule-view-search-container{
        display: flex;
        align-items: center;
        gap: 4px;
        padding: 4px 8px;
      }
      .rule-view-search-container .pops-panel-select{
        min-width: fit-content;
        max-width: 60px;
      }
      .rule-view-search-container .pops-panel-select{
        flex: 0;
      }
      .rule-view-search-container  .pops-panel-input{
        flex: 1;
      }
      .rule-view-search-container .pops-panel-select select{
        width: 100%;
        min-width: auto;
      }
      .rule-view-search-container .pops-panel-input{
        width: 100%;
      }

      @media screen and (max-width: 600px) {
        .pops[type-value="panel"] section.pops-panel-container .rule-view-search-container .pops-panel-select select{
          min-width: auto !important;
          max-width: 50px !important;
        }
      }
      `});}async enterDeepMenu(e,a,n){const i={duration:220,easing:"ease-in-out"},s=e.matches("section")?e:e.closest("section"),r=h.createElement("section",{className:"pops-panel-container pops-panel-deepMenu-container",innerHTML:`
				<ul class="pops-panel-container-header-ul pops-panel-deepMenu-container-header-ul">
					<li class="pops-panel-container-header-title-text pops-panel-deepMenu-container-header">
						<i class="pops-panel-deepMenu-container-left-arrow-icon">${z.config.iconSVG.arrowLeft}</i>
						<p class="pops-panel-deepMenu-container-header-title-text">${a}</p>
					</li>
				</ul>
				<ul class="pops-panel-container-main-ul"></ul>
			`}),l=r.querySelector(".pops-panel-deepMenu-container-header-ul"),o=r.querySelector(".pops-panel-deepMenu-container-left-arrow-icon"),c=r.querySelector(".pops-panel-container-main-ul");h.on(o,"click",async d=>{h.preventEvent(d);const p=()=>{const w=s;h.removeClass(w,"pops-hide-important"),h.remove(r),n();};if(this.option.useDeepMenuSwtichAnimation&&document.startViewTransition){const w=document.startViewTransition(p);await w.ready,await Promise.all([r.animate([{transform:"translateX(0)"},{transform:"translateX(100%)"}],i).finished,s.animate([{transform:"translateX(-100%)"},{transform:"translateX(0)"}],i).finished]),await w.finished;}else p();});const u=()=>{h.addClass(s,"pops-hide-important"),h.after(s,r);};if(this.option.useDeepMenuSwtichAnimation&&document.startViewTransition){const d=document.startViewTransition(u);await d.ready,await r.animate([{transform:"translateX(100%)"},{transform:"translateX(0)"}],i).finished,await d.finished;}else u();return {$section:r,$headerContainer:l,$arrowLeft:o,$rightRuleContainer:c,quiteDeepMenu:()=>{o.click();}}}async createButtonControls(e,a,n,i){const s=n.btnControls,r=h.createElement("li",{className:"rule-controls"});h.append(e,r);let l=null;s?.add?.enable&&(l=h.createElement("button",{className:"rule-control-add",innerHTML:"<span>æ·»åŠ </span>"},{type:"button","data-type":"primary","data-has-icon":"false","data-righticon":"false"}),h.on(l,"click",async _=>{h.preventEvent(_);const y=await n.btnControls?.add?.callback?.call(this,{event:_,$section:a});typeof y=="boolean"&&!y||await i?.();}),h.append(r,l));let o=null;s?.clearAll?.enable&&(o=h.createElement("button",{className:"rule-control-clear-all",innerHTML:"<span>æ¸…ç©ºæ‰€æœ‰</span>"},{type:"button","data-type":"xiaomi-primary","data-has-icon":"false","data-righticon":"false"}),h.on(o,"click",_=>{h.preventEvent(_);let y=z.confirm({title:{text:"æç¤º",position:"center"},content:{text:"ç¡®å®šæ¸…ç©ºæ‰€æœ‰çš„æ•°æ®ï¼Ÿ",html:false},btn:{ok:{enable:true,callback:async v=>{m.success("æ¸…ç©ºæ‰€æœ‰");let $=await s?.clearAll?.callback?.();if(typeof $=="boolean"&&!$)return;let D=await n?.data();if(!D||D.length){g.error("æ¸…ç†å¤±è´¥");return}else g.success("æ¸…ç†æˆåŠŸ");await this.updateDeleteAllBtnText(n,r),this.clearContent(a),y.close();}},cancel:{text:"å–æ¶ˆ",enable:true}},drag:true,mask:{enable:true},width:"300px",height:"200px"});}),h.append(r,o));let c=null;s?.import?.enable&&(c=h.createElement("button",{className:"rule-control-import",innerHTML:"<span>å¯¼å…¥</span>"},{type:"button","data-type":"default","data-has-icon":"false","data-righticon":"false"}),h.on(c,"click",async _=>{h.preventEvent(_);await s?.import?.callback?.(()=>{this.updateRuleContaienrElement(n,void 0,a);});}),h.append(r,c));let u=null;s?.export?.enable&&(u=h.createElement("button",{className:"rule-control-export",innerHTML:"<span>å¯¼å‡º</span>"},{type:"button","data-type":"default","data-has-icon":"false","data-righticon":"false"}),h.on(u,"click",async _=>{h.preventEvent(_);await s?.export?.callback?.({event:_});}),h.append(r,u));const d=h.createElement("div",{className:"rule-view-container",innerHTML:""}),p=h.createElement("div",{className:"rule-view-search-container",innerHTML:`
      <div class="pops-panel-select pops-user-select-none" data-mode="native">
        <select class="select-rule-status">
        </select>
      </div>
      <div class="pops-panel-select pops-user-select-none" data-mode="native">
        <select class="select-rule-value">
        </select>
      </div>
      <div class="pops-panel-input pops-user-select-none">
        <div class="pops-panel-input_inner">
            <input type="text" placeholder="">
        </div>
      </div>`}),w=p.querySelector(".pops-panel-select .select-rule-status"),b=p.querySelector(".pops-panel-select .select-rule-value"),x=p.querySelector(".pops-panel-input input");let C=null,R=null;if(Array.isArray(n.btnControls?.filter?.option)){let _=0;h.append(w,n?.btnControls?.filter?.option.map((y,v)=>{const $=h.createElement("option",{innerText:y.name});return y.isDefaultSelected&&(_=v),Reflect.set($,"data-value",y),$})),w.selectedIndex=_;}if(Array.isArray(n.btnControls?.filter?.inputOption)){let _=0;h.append(b,n.btnControls?.filter?.inputOption.map((y,v)=>{const $=h.createElement("option",{innerText:y.name});return y.isDefaultSelected&&(_=v),Reflect.set($,"data-value",y),$})),b.selectedIndex=_;}h.on(w,"change",async _=>{const y=w[w.selectedIndex],v=Reflect.get(y,"data-value");typeof v?.selectedCallBack=="function"&&v.selectedCallBack(v),C=v,await T(true);}),h.on(b,"change",async _=>{const y=b[b.selectedIndex],v=Reflect.get(y,"data-value");typeof v?.selectedCallBack=="function"&&v.selectedCallBack(v),R=v,await T(true);}),h.onInput(x,f.debounce(async()=>{await T(false);}));const M=()=>{const _=w[w.selectedIndex];_&&(C=Reflect.get(_,"data-value"));const y=b[b.selectedIndex];y&&(R=Reflect.get(y,"data-value"));let v=[];typeof R?.name=="string"&&R.name.trim()!==""&&v.push(R.name),x.placeholder=`è¯·è¾“å…¥ ${v.join("/")} è¿›è¡Œæœç´¢`;},T=async _=>{this.clearContent(a),_&&M();const y=await n.data(),v=[],$=h.val(x);for(let D=0;D<y.length;D++){const E=y[D];if(C){const I=await C?.filterCallBack?.(E);if(typeof I=="boolean"&&!I)continue}if(R){let I=true;if($===""?I=true:I=false,I||(I=await R?.filterCallBack?.(E,$)),!I)continue}v.push(E);}await this.addRuleElement(n,void 0,a,v);};return h.append(a,p,d),M(),{$ruleContainer:d,$ruleControls:r,$ruleControlAdd:l,$ruleControlClearAll:o,$ruleControlImport:c,$ruleControlExport:u,execFilter:T,updateSelectData:M}}parseViewElement(e){let a=e.querySelector(".rule-view-container"),n=e.querySelector(".rule-control-clear-all");return {$container:a,$deleteBtn:n}}parseRuleElement(e){let a=e.querySelector(".rule-controls-enable"),n=a.querySelector(".pops-panel-switch"),i=a.querySelector(".pops-panel-switch__input"),s=a.querySelector(".pops-panel-switch__core"),r=e.querySelector(".rule-controls-edit"),l=e.querySelector(".rule-controls-delete");return {$enable:a,$enableSwitch:n,$enableSwitchInput:i,$enableSwitchCore:s,$edit:r,$delete:l,data:Reflect.get(e,"data-rule")}}async createRuleElement(e,a,n,i){let s=n,r=await e.getDataItemName(s),l=h.createElement("div",{className:"rule-item",innerHTML:`
			<div class="rule-name">${r}</div>
			<div class="rule-controls">
				<div class="rule-controls-enable">
					<div class="pops-panel-switch">
						<input class="pops-panel-switch__input" type="checkbox">
						<span class="pops-panel-switch__core">
							<div class="pops-panel-switch__action">
							</div>
						</span>
					</div>
				</div>
				<div class="rule-controls-edit">
					${z.config.iconSVG.edit}
				</div>
				<div class="rule-controls-delete">
					${z.config.iconSVG.delete}
				</div>
			</div>
			`});Reflect.set(l,"data-rule",s);let o="pops-panel-switch-is-checked";const{$enable:c,$enableSwitch:u,$enableSwitchCore:d,$enableSwitchInput:p,$delete:w,$edit:b}=this.parseRuleElement(l);return e.btnControls?.ruleEnable?.enable?(h.on(d,"click",async x=>{let C=false;if(u.classList.contains(o)?(u.classList.remove(o),C=false):(u.classList.add(o),C=true),p.checked=C,await e?.btnControls?.ruleEnable?.callback(s,C),C&&a){let R=n,M=await a.getSubscribeInfo(R.data.url);if(M.data){let T=M.data;T.uuid=R.uuid,T.data=R.data,T.data.latestUpdateTime=Date.now(),await a.updateData(T);}else R.data.updateFailedTime=Date.now(),await a.updateData(R),m.error(R),g.error(M.msg,{consoleLogContent:true});await this.updateRuleContaienrElement(e,a,i);}}),await e?.btnControls?.ruleEnable?.getEnable(s)&&u.classList.add(o)):c.remove(),e?.btnControls?.ruleEdit?.enable?h.on(b,"click",x=>{if(h.preventEvent(x),typeof e.btnControls?.ruleEdit?.callback=="function"){let C=e.btnControls?.ruleEdit?.callback({context:this,event:x,option:e,subscribeOption:a,ruleData:s,$section:i,$ruleItem:l,enterDeepMenu:async R=>{const M=await this.enterDeepMenu(i,R.headerTitle||"",()=>{this.updateRuleContaienrElement(e,a,i);}),T=M.$rightRuleContainer;await(await this.createButtonControls(T,M.$rightRuleContainer,R,void 0)).execFilter(true);}});if(typeof C=="boolean"&&!C)return}this.showEditView(e,a,true,s,i,l,C=>{s=null,s=C;});}):b.remove(),e?.btnControls?.ruleDelete?.enable?h.on(w,"click",x=>{h.preventEvent(x);let C=z.confirm({title:{text:"æç¤º",position:"center"},content:{text:"ç¡®å®šåˆ é™¤è¯¥æ¡æ•°æ®ï¼Ÿ",html:false},btn:{ok:{enable:true,callback:async R=>{m.success("åˆ é™¤æ•°æ®"),await e?.btnControls?.ruleDelete?.deleteCallBack(s)?(g.success("æˆåŠŸåˆ é™¤è¯¥æ•°æ®"),l.remove(),await this.updateDeleteAllBtnText(e,i),C.close()):g.error("åˆ é™¤è¯¥æ•°æ®å¤±è´¥");}},cancel:{text:"å–æ¶ˆ",enable:true}},drag:true,mask:{enable:true},width:"300px",height:"200px"});}):w.remove(),l}async addRuleElement(e,a,n,i,s){const{$container:r}=this.parseViewElement(n),l=[],o=Array.isArray(i)?i:[i];for(let c=0;c<o.length;c++){const u=o[c],d=await this.createRuleElement(e,a,u,n);s?.(u,d),l.push(d);}return h.append(r,l),await this.updateDeleteAllBtnText(e,n),l}async updateRuleContaienrElement(e,a,n){this.clearContent(n);const{$container:i}=this.parseViewElement(n),s=await e.data();await this.addRuleElement(e,a,n,s),await this.updateDeleteAllBtnText(e,n);}async updateRuleItemElement(e,a,n,i,s){const r=await this.createRuleElement(e,a,n,s);return i.after(r),i.remove(),r}clearContent(e){const{$container:a}=this.parseViewElement(e);h.html(a,"");}setDeleteBtnText(e,a,n=false){const{$deleteBtn:i}=this.parseViewElement(e);n?h.html(i,a):h.text(i,a);}async updateDeleteAllBtnText(e,a){let i=(await e.data()).length,s="æ¸…ç©ºæ‰€æœ‰";i!==0&&(s+=`(${i})`),this.setDeleteBtnText(a,s);}showEditView(e,a,n,i,s,r,l,o){let c=async d=>{if(d){if(typeof o=="function"){let p=await e.getData(i);o(p);}}else if(n||await e.deleteData(i),typeof l=="function"){let p=await e.getData(i);l(p);}};new ma({title:n?"ç¼–è¾‘":"æ·»åŠ ",data:()=>i,dialogCloseCallBack:c,getView:async d=>await e.btnControls?.ruleEdit?.getView?.(d,n),btn:{ok:{enable:true,text:n?"ä¿®æ”¹":"æ·»åŠ "},cancel:{callback:async(d,p)=>{d.close(),await c(false);}},close:{callback:async(d,p)=>{d.close(),await c(false);}}},onsubmit:async(d,p)=>{let w=await e?.btnControls?.ruleEdit?.onsubmit?.(d,n,p);return w.success?n?(g.success("ä¿®æ”¹æˆåŠŸ"),s&&await this.updateRuleItemElement(e,a,w.data,r,s)):s&&await this.addRuleElement(e,a,s,w.data):n&&m.error("ä¿®æ”¹å¤±è´¥"),w},style:e?.btnControls?.ruleEdit?.style,width:e?.btnControls?.ruleEdit?.viewWidth,height:e?.btnControls?.ruleEdit?.viewHeight}).showView();}}const K={alert(t,e){const a=this.handleDetails(t,e);return z.alert(a)},confirm(t,e){const a=this.handleDetails(t,e);return z.confirm(a)},loading(t){return typeof t.animation>"u"&&(t.animation=k.pops.popsAnimation.value),typeof t.forbiddenScroll>"u"&&(t.forbiddenScroll=S.$data.isForbiddenScrollByDefault),z.loading(t)},prompt(t,e){const a=this.handleDetails(t,e);return z.prompt(a)},folder(t,e){const a=this.handleDetails(t,e);return a.sort={name:k.popsFolder["pops-folder-sort-name"].value,isDesc:k.popsFolder["pops-folder-sort-is-desc"].value,callback(n,i,s,r){k.popsFolder["pops-folder-sort-name"].value=s,k.popsFolder["pops-folder-sort-is-desc"].value=r;}},z.folder(a)},panel(t,e){const a=this.handleDetails(t,e);return z.panel(a)},rightClickMenu(t){const e=this.handleDetails(t);return z.rightClickMenu(e)},handleDetails(t,e){if(t=Object.assign({animation:k.pops.popsAnimation.value,drag:k.pops.pcDrag.value,dragLimit:k.pops.pcDragLimit.value,forbiddenScroll:S.$data.isForbiddenScrollByDefault},t),e!=null)if(z.isPhone()){let a=typeof e.Mobile.width=="function"?e.Mobile.width():e.Mobile.width,n=typeof e.Mobile.height=="function"?e.Mobile.height():e.Mobile.height;t.width=a,t.height=n;}else {let a=typeof e.PC.width=="function"?e.PC.width():e.PC.width,n=typeof e.PC.height=="function"?e.PC.height():e.PC.height;t.width=a,t.height=n;}if(t.mask==null&&(t.mask={}),typeof t.mask.enable!="boolean"&&(t.mask.enable=true),t.mask.clickEvent==null&&(t.mask.clickEvent={}),typeof t.mask.clickEvent.toClose!="boolean"&&(t.mask.clickEvent.toClose=k.pops.clickMaskToCloseDialog.value),k.pops.popsAcrylic.value){let a=`
            .pops {
                --acrylic-opacity: 0.7;
                --acrylic-color: rgba(232, 232, 232, var(--acrylic-opacity));
                --acrylic-blur: 30px;
                --acrylic-saturate: 125%;
                --pops-bg-opacity: var(--acrylic-opacity);
            }
            .pops {
                backdrop-filter: blur(var(--acrylic-blur)) saturate(var(--acrylic-saturate)) !important;
                background-color: var(--acrylic-color) !important;
            }
            .pops[type-value=panel]{
                --aside-bg-color: rgba(221, 221, 221, var(--acrylic-opacity));
				--pops-bg-color: #f2f2f2;
				--title-bg-color: var(--acrylic-color);
				--aside-bg-color: var(--acrylic-color);
				--container-item-bg-color: var(--acrylic-color);
            }
            `;typeof t.style=="string"?t.style+=a:t.style=a;}return t.zIndex=()=>{let n=f.getMaxZIndex(10),i=z.config.InstanceUtils.getPopsMaxZIndex(10).zIndex;return f.getMaxValue(99999,n,i)+10},t}};let Ot=class{option;storageApi;constructor(e){this.option=e,this.storageApi=new ze(e.STORAGE_API_KEY);}getAllSubscribe(){return this.storageApi.get(this.option.STORAGE_KEY,[])}getAllSubscribeRule(e=false){let a=this.getAllSubscribe(),n=[];for(let i=0;i<a.length;i++){const s=a[i];if(!(e&&!s.data.enable))for(let r=0;r<s.subscribeData.ruleData.length;r++){const l=s.subscribeData.ruleData[r];e&&!l.enable||(l.subscribeUUID=s.uuid,n.push(l));}}return n}getSubscribe(e){return this.getAllSubscribe().find(n=>n.uuid==e)}getSubscribeRule(e,a){let n=this.getSubscribe(e);if(n)return n.subscribeData.ruleData.find(s=>s.uuid===a)}deleteAllSubscribe(){this.storageApi.delete(this.option.STORAGE_KEY);}deleteSubscribe(e){let a=typeof e=="string"?e:e.uuid,n=this.getAllSubscribe(),i=n.findIndex(s=>s.uuid===a);return i!==-1&&(n.splice(i,1),this.storageApi.set(this.option.STORAGE_KEY,n)),i!==-1}clearSubscribe(e){let a=typeof e=="string"?e:e.uuid,n=this.getAllSubscribe(),i=n.findIndex(s=>s.uuid===a);return i!==-1?(n[i].subscribeData.ruleData=[],this.storageApi.set(this.option.STORAGE_KEY,n),true):false}addSubscribe(e){let a=false,n=this.getAllSubscribe();return n.findIndex(s=>s.uuid===e.uuid)===-1&&(n.push(e),a=true),a&&this.storageApi.set(this.option.STORAGE_KEY,n),a}updateSubscribe(e){let a=false,n=this.getAllSubscribe(),i=n.findIndex(s=>s.uuid===e.uuid);return i!==-1&&(n[i]=e,a=true),a&&this.storageApi.set(this.option.STORAGE_KEY,n),a}updateSubscribeRule(e,a){let n=false,i=this.getAllSubscribe(),s=i.find(r=>r.uuid===e);if(s){let r=s.subscribeData.ruleData.findIndex(l=>l.uuid===a.uuid);r!==-1&&(s.subscribeData.ruleData[r]=a,n=true);}return n&&this.storageApi.set(this.option.STORAGE_KEY,i),true}deleteSubscribeRule(e,a){let n=false,i=this.getAllSubscribe(),s=i.findIndex(r=>r.uuid===e);if(s!==-1){let l=i[s].subscribeData.ruleData.findIndex(o=>o.uuid===a.uuid);l!==-1&&(i[s].subscribeData.ruleData.splice(l,1),this.storageApi.set(this.option.STORAGE_KEY,i),n=true);}return n}async getSubscribeInfo(e){let a=await L.get(e,{allowInterceptConfig:false,timeout:1e4,headers:{"User-Agent":f.getRandomPCUA()}});if(!a.status)return m.error(a),{data:null,msg:"è·å–è®¢é˜…ä¿¡æ¯å¤±è´¥"};let n=a.data.responseText,i=f.toJSON(n);return typeof i.title=="string"&&typeof i.version=="number"&&typeof i.lastModified=="number"&&Array.isArray(i.ruleData)?{data:{uuid:f.generateUUID(),subscribeData:i,data:{enable:true,url:e,latestUpdateTime:Date.now(),updateFailedTime:null}},msg:""}:(m.error(i),{data:null,msg:"è®¢é˜…é“¾æ¥çš„å†…å®¹æ ¼å¼ä¸æ­£ç¡®"})}async updateAllSubscribe(){let e=this.getAllSubscribe();for(let a=0;a<e.length;a++){const n=e[a];if(!n.data.enable||typeof n.data.updateFailedTime=="number"&&f.formatTime(n.data.updateFailedTime,"yyyyMMdd")===f.formatTime(Date.now(),"yyyyMMdd")||typeof n.data.latestUpdateTime=="number"&&f.formatTime(Date.now(),"yyyyMMdd")===f.formatTime(n.data.latestUpdateTime,"yyyyMMdd"))continue;let i=await this.getSubscribeInfo(n.data.url),s=false;if(i.data){let r=i.data;r.uuid=n.uuid,r.data=n.data,r.data.latestUpdateTime=Date.now();let l=r.data.title||r.subscribeData.title||r.data.url;n.data.updateFailedTime=null,s=this.updateSubscribe(r),s?m.success(`æ›´æ–°è®¢é˜…æˆåŠŸï¼š${l}`):m.error(`æ›´æ–°è®¢é˜…å¤±è´¥ï¼š${l}`,n);}else m.error("æ›´æ–°è®¢é˜…å¤±è´¥ï¼š"+i.msg,n);s||(n.data.updateFailedTime=Date.now(),this.updateSubscribe(n));}}importSubscribe(e){let a=z.alert({title:{text:"è¯·é€‰æ‹©å¯¼å…¥æ–¹å¼",position:"center"},content:{text:`
                    <div class="btn-control" data-mode="local">æœ¬åœ°å¯¼å…¥</div>
                    <div class="btn-control" data-mode="network">ç½‘ç»œå¯¼å…¥</div>
                    <div class="btn-control" data-mode="clipboard">å‰ªè´´æ¿å¯¼å…¥</div>
                `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(o,c){o.close();}}},drag:true,mask:{enable:true},width:P.info.width,height:P.info.height,style:`
                .btn-control{
                    display: inline-block;
                    margin: 10px;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    cursor: pointer;
                }
				.btn-control:hover{
					color: #409eff;
					border-color: #c6e2ff;
					background-color: #ecf5ff;
				}
            `}),n=a.$shadowRoot.querySelector(".btn-control[data-mode='local']"),i=a.$shadowRoot.querySelector(".btn-control[data-mode='network']"),s=a.$shadowRoot.querySelector(".btn-control[data-mode='clipboard']"),r=async o=>{let c=this.getAllSubscribe(),u=[],d=[];for(let p=0;p<o.length;p++){const w=o[p];let b=c.findIndex(x=>x.uuid===w.uuid);b!==-1?d.push({index:b,data:w}):u.push(w);}await new Promise(p=>{if(globalThis.confirm(`å­˜åœ¨ç›¸åŒçš„uuidçš„è§„åˆ™ ${d.length}æ¡ï¼Œæ˜¯å¦è¿›è¡Œè¦†ç›–ï¼Ÿ`))for(const b of d)c[b.index]=b.data;p(true);}),c=c.concat(u),this.storageApi.set(this.option.STORAGE_KEY,c),g.success(`å…± ${o.length} æ¡è®¢é˜…ï¼Œæ–°å¢ ${u.length} æ¡`),e?.();},l=o=>new Promise(async c=>{let u=f.toJSON(o);if(!Array.isArray(u)){m.error(u),g.error("å¯¼å…¥å¤±è´¥ï¼Œæ ¼å¼ä¸ç¬¦åˆï¼ˆä¸æ˜¯æ•°ç»„ï¼‰",{consoleLogContent:true}),c(false);return}if(!u.length){g.error("å¯¼å…¥å¤±è´¥ï¼Œè§£æå‡ºçš„æ•°æ®ä¸ºç©º",{consoleLogContent:true}),c(false);return}let d=u[0];if(!(typeof d.data=="object"&&d.data!=null&&typeof d.subscribeData=="object"&&d.subscribeData!=null&&typeof d.uuid=="string")){g.error("å¯¼å…¥å¤±è´¥ï¼Œè§£æçš„æ ¼å¼ä¸ç¬¦åˆ",{consoleLogContent:true}),c(false);return}await r(u),c(true);});h.on(n,"click",o=>{h.preventEvent(o),a.close();let c=h.createElement("input",{type:"file",accept:".json"});h.on(c,["propertychange","input"],u=>{if(!c.files?.length)return;let d=c.files[0],p=new FileReader;p.onload=()=>{l(p.result);},p.readAsText(d,"UTF-8");}),c.click();}),h.on(i,"click",o=>{h.preventEvent(o),a.close();let c=z.prompt({title:{text:"ç½‘ç»œå¯¼å…¥",position:"center"},content:{text:"",placeholder:"è¯·å¡«å†™URL",focus:true},btn:{close:{enable:true,callback(p,w){p.close();}},ok:{text:"å¯¼å…¥",callback:async(p,w)=>{let b=p.text;if(f.isNull(b)){g.error("è¯·å¡«å…¥å®Œæ•´çš„url");return}let x=g.loading("æ­£åœ¨è·å–é…ç½®..."),C=await L.get(b,{allowInterceptConfig:false});if(x.close(),!C.status){m.error(C),g.error("è·å–é…ç½®å¤±è´¥",{consoleLogContent:true});return}await l(C.data.responseText)&&p.close();}},cancel:{enable:false}},drag:true,mask:{enable:true},width:P.info.width,height:"auto"}),u=c.$shadowRoot.querySelector("input"),d=c.$shadowRoot.querySelector(".pops-prompt-btn-ok");h.on(u,["input","propertychange"],p=>{h.val(u)===""?h.attr(d,"disabled","true"):h.removeAttr(d,"disabled");}),h.onKeyboard(u,"keydown",(p,w,b)=>{p==="Enter"&&b.length===0&&h.val(u)!==""&&h.emit(d,"click");}),h.emit(u,"input");}),h.on(s,"click",async o=>{h.preventEvent(o),a.close();let c=await Ie.getClipboardText();if(c.trim()===""){g.warning("è·å–åˆ°çš„å‰ªè´´æ¿å†…å®¹ä¸ºç©º");return}await l(c);});}exportSubscribe(e="rule.json"){let a=z.alert({title:{text:"è¯·é€‰æ‹©å¯¼å‡ºæ–¹å¼",position:"center"},content:{text:`
                    <div class="btn-control" data-mode="only-export-rule-list">å¯¼å‡ºè®¢é˜…</div>
                `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(s,r){s.close();}}},drag:true,mask:{enable:true},width:P.info.width,height:P.info.height,style:`
                .btn-control{
                    display: inline-block;
                    margin: 10px;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    cursor: pointer;
                }
				.btn-control:hover{
					color: #409eff;
					border-color: #c6e2ff;
					background-color: #ecf5ff;
				}
            `}),n=a.$shadowRoot.querySelector(".btn-control[data-mode='only-export-rule-list']"),i=(s,r)=>{let l=new Blob([JSON.stringify(r,null,4)]),o=window.URL.createObjectURL(l),c=document.createElement("a");c.href=o,c.download=s,c.click(),setTimeout(()=>{window.URL.revokeObjectURL(o);},1500);};h.on(n,"click",s=>{h.preventEvent(s);try{let r=this.getAllSubscribe();if(r.length===0){g.warning("è®¢é˜…ä¸ºç©ºï¼Œæ— éœ€å¯¼å‡º");return}i(e,r),a.close();}catch(r){g.error(r.toString(),{consoleLogContent:true});}});}};const se=new Ot({STORAGE_API_KEY:"character-mapping-rule",STORAGE_KEY:"character-mapping-subscribe-rule"}),kt=new ze("character-mapping-rule"),dt={$data:{STORAGE_KEY:"character-mapping",EXPORT_CONFIG_KEY:"rule-export-config"},getTemplateData(){return {uuid:f.generateUUID(),subscribeUUID:null,enable:true,name:"",data:{url:"",isRegExp:true,regExpFlag:"gi",searchValue:"",replaceValue:""},dynamicData:[]}},getRulePanelViewOption(t){const e=this,a=z.config.PanelHandlerComponents(),n=()=>t??this.getTemplateData(),i=function(o){return {get(c,u){return o[c]??u},set(c,u){o[c]=u;}}},s=(o,c)=>{c||(o=n());const u=document.createDocumentFragment(),d=Z("å¯ç”¨","enable",true);Reflect.set(d.props,j,i(o));const p=a.createSectionContainerItem_switch(d).$el,w=re("è§„åˆ™åç§°","name","","",void 0,"å¿…å¡«");Reflect.set(w.props,j,i(o));const b=a.createSectionContainerItem_input(w).$el,x=re("åŒ¹é…ç½‘å€","url","","",void 0,"å¿…å¡«ï¼Œå¯æ­£åˆ™");Reflect.set(x.props,j,i(o.data));const C=a.createSectionContainerItem_input(x).$el,R=$=>{const D=this.getTemplateData(),E=re("å­—ç¬¦è§„åˆ™","searchValue",D.data.searchValue,"",void 0,"å¿…å¡«ï¼Œå¯æ­£åˆ™");Reflect.set(E.props,j,i($));const I=a.createSectionContainerItem_input(E).$el,N=Z("æ˜¯å¦å¯ç”¨æ­£åˆ™","isRegExp",D.data.isRegExp,void 0,"ä½¿ç”¨æ­£åˆ™è¿›è¡ŒåŒ¹é…å­—ç¬¦è§„åˆ™");Reflect.set(N.props,j,i(o.data));const H=a.createSectionContainerItem_switch(N).$el,W=Ft("æ­£åˆ™æ ‡è¯†ç¬¦","regExpFlag",D.data.regExpFlag.split(""),["g","i","m","u","y"].map(Q=>({text:Q.toLowerCase(),value:Q.toLowerCase()})),void 0,"","ç‚¹å‡»é€‰æ‹©æ ‡è¯†ç¬¦");Reflect.set(W.props,j,{get(Q,ge){return o.data[Q]??ge},set(Q,ge){Array.isArray(ge)&&(ge=ge.join("")),o.data[Q]=ge;}});const X=a.createSectionContainerItem_select_multiple(W).$el,oe=re("æ˜ å°„ä¸º","replaceValue",D.data.replaceValue,"",void 0,"");Reflect.set(oe.props,j,i(o.data));const _e=a.createSectionContainerItem_input(oe).$el;return {$data_searchValue:I,$data_isRegExp:H,$data_regExpFlag:X,$data_replaceValue:_e}},M=h.createElement("div",{className:"rule-form-ulist-dynamic",innerHTML:`
												<div class="rule-form-ulist-dynamic__inner">

												</div>
												<div class="pops-panel-button pops-panel-button-no-icon">
													<button class="pops-panel-button_inner" type="button" data-type="default">
														<i class="pops-bottom-icon" is-loading="false"></i>
														<span class="pops-panel-button-text">æ·»åŠ é¢å¤–å±æ€§</span>
													</button>
												</div>`}),T=M.querySelector(".rule-form-ulist-dynamic__inner"),_=M.querySelector(".pops-panel-button"),y=$=>{const D=this.getTemplateData();$=$??{searchValue:D.data.searchValue,isRegExp:D.data.isRegExp,regExpFlag:D.data.regExpFlag,replaceValue:D.data.replaceValue};const E=h.createElement("div",{className:"rule-form-ulist-dynamic__inner-container",innerHTML:`
										<div class="dynamic-control-delete">
											<div class="pops-panel-button pops-panel-button-no-icon">
												<button class="pops-panel-button_inner" type="button" data-type="danger">
													<i class="pops-bottom-icon" is-loading="false"></i>
													<span class="pops-panel-button-text">Ã—</span>
												</button>
											</div>
										</div>
										<ul class="dynamic-forms">

										</ul>`}),I=E.querySelector(".dynamic-control-delete");h.on(I,"click",_e=>{if(h.preventEvent(_e),E.remove(),Array.isArray(o.dynamicData)){const Q=o.dynamicData.findIndex(ge=>ge==$);Q!==-1&&o.dynamicData.splice(Q,1);}});const N=E.querySelector(".dynamic-forms"),{$data_searchValue:H,$data_isRegExp:W,$data_regExpFlag:X,$data_replaceValue:oe}=R($);N.appendChild(H),N.appendChild(W),N.appendChild(X),N.appendChild(oe),T.appendChild(E);};if(h.on(_,"click",$=>{h.preventEvent($),y();}),Array.isArray(o.dynamicData))for(let $=0;$<o.dynamicData.length;$++){const D=o.dynamicData[$];y(D);}const v=R(o.data);return u.appendChild(p),u.appendChild(b),u.appendChild(C),u.appendChild(v.$data_searchValue),u.appendChild(v.$data_isRegExp),u.appendChild(v.$data_regExpFlag),u.appendChild(v.$data_replaceValue),u.appendChild(M),u},r=(o,c,u)=>{const d=o.querySelectorAll(".rule-form-ulist > li"),p=this.getTemplateData();return c&&(p.uuid=u.uuid),d.forEach(w=>{const b=Reflect.get(w,a.$data.nodeStoreConfigKey).$el,x=Reflect.get(b,"attributes"),C=Reflect.get(w,j),R=Reflect.get(x,be),M=Reflect.get(x,Re),T=C.get(R,M);Reflect.has(p,R)?Reflect.set(p,R,T):Reflect.has(p.data,R)?Reflect.set(p.data,R,T):m.error(`${R}ä¸åœ¨æ•°æ®ä¸­`);}),o.querySelectorAll(".rule-form-ulist-dynamic__inner-container").forEach(w=>{const b={};w.querySelectorAll(".dynamic-forms > li").forEach(x=>{const C=Reflect.get(x,a.$data.nodeStoreConfigKey).$el;if(!C)return;const R=Reflect.get(C,"attributes");if(!R)return;const M=Reflect.get(x,j),T=Reflect.get(R,be),_=Reflect.get(R,Re),y=M.get(T,_);Reflect.set(b,T,y);}),p.dynamicData.push(b);}),p.name.trim()===""?(g.error("è§„åˆ™åç§°ä¸èƒ½ä¸ºç©º"),{success:false,data:p}):p.data.url.trim()===""?(g.error("åŒ¹é…ç½‘å€ä¸èƒ½ä¸ºç©º"),{success:false,data:p}):p.data.searchValue.trim()===""||Array.isArray(p.dynamicData)&&p.dynamicData.findIndex(w=>w.searchValue.trim()==="")!==-1?(g.error("å­—ç¬¦è§„åˆ™ä¸èƒ½ä¸ºç©º"),{success:false,data:p}):c?{success:this.updateData(p),data:p}:{success:this.addData(p),data:p}};return {id:"netdisk-rule",title:"å­—ç¬¦æ˜ å°„",headerTitle:"å­—ç¬¦æ˜ å°„è§„åˆ™",ruleOption:{btnControls:{add:{enable:true},filter:{enable:true,option:[{name:"æ— ",value:"",selectedCallBack(o){},filterCallBack(o){return  true}},{name:"å·²å¯ç”¨",value:"enable",selectedCallBack(o){},filterCallBack(o){return o.enable}},{name:"æœªå¯ç”¨",value:"notEnable",selectedCallBack(o){},filterCallBack(o){return !o.enable}},{name:"åœ¨å½“å‰ç½‘å€ç”Ÿæ•ˆ",value:"workInCurrentUrl",selectedCallBack(o){},filterCallBack(o){return e.checkRuleMatch(o)}}],inputOption:[{name:"è§„åˆ™å",value:"name",selectedCallBack(o){},filterCallBack(o,c){const u=o.name;return typeof u=="string"?!!u.match(c):false}},{name:"ç½‘å€",value:"url",selectedCallBack(o){},filterCallBack(o,c){return !!o.data.url.match(c)}}]},clearAll:{enable:true,callback:()=>{this.clearData();}},import:{enable:true,callback:o=>{this.importRule(()=>{o();});}},export:{enable:true,callback:()=>{this.exportRule($e+"-å­—ç¬¦æ˜ å°„.json",$e+"-å­—ç¬¦æ˜ å°„-è®¢é˜…æ¨¡å¼.json");}},ruleEnable:{enable:true,getEnable(o){return o.enable},callback:(o,c)=>{o.enable=c,this.updateData(o);}},ruleEdit:{enable:true,getView:s,onsubmit:r},ruleDelete:{enable:true,deleteCallBack:o=>e.deleteData(o)}},data:()=>this.getData(),getAddData:()=>n(),getData:o=>this.getData().find(d=>d.uuid===o.uuid)??o,getDataItemName:o=>o.name??o.data.url,updateData:o=>this.updateData(o),deleteData:o=>this.deleteData(o)},subscribe:{enable:true,data(){return se.getAllSubscribe()},getData:o=>se.getSubscribe(o.uuid)??o,getDataItemName(o){return `
						<style>
							.subscribe-rule-title-info-wrapper{
								display: flex;
								flex-direction: column;
								gap: 4px;
							}
							.subscribe-rule-title-info-wrapper .rule-name-text{
								white-space: nowrap;
								text-overflow: ellipsis;
								overflow: hidden;
								font-weight: 600;
								font-size: 16px;
								line-height: 24px;
							}
							.subscribe-rule-title-info-wrapper .subscribe-rule-small-span-text{
								font-size: 14px;
								line-height: 16px;
								white-space: pre-wrap;
							}
						</style>
						<div class="subscribe-rule-title-info-wrapper">
							<div class="rule-name-text" style="white-space: nowrap;text-overflow: ellipsis;overflow: hidden;font-size: 16px;font-weight: 600;line-height: 24px;">${o.data.title||o.subscribeData.title||o.data.url}</div>
								<div class="subscribe-rule-small-span-text">${o.subscribeData.ruleData.length} æ¡è§„åˆ™ï¼Œæ›´æ–°äºï¼š${f.formatTime(o.data.latestUpdateTime,"yyyyå¹´MMæœˆddæ—¥ HH:mm:ss")}${typeof o.data.updateFailedTime=="number"?`ï¼Œ<span style="color: red;">æ›´æ–°å¤±è´¥äºï¼š${f.formatTime(o.data.updateFailedTime,"yyyyå¹´MMæœˆddæ—¥ HH:mm:ss")}</span>`:""}</div>
								${o.subscribeData.homePage?`<a href="${o.subscribeData.homePage}" class="subscribe-rule-small-span-text" target="_blank" style="color:#67b279;">è½¬åˆ°ä¸»é¡µ</a>`:""}
								<a href="${o.data.url}" class="subscribe-rule-small-span-text" target="_blank" style="color:#67b279;">è®¢é˜…åœ°å€</a>
						</div>`},addData:o=>se.addSubscribe(o),updateData:o=>se.updateSubscribe(o),deleteData:o=>se.deleteSubscribe(o),btnControls:{add:{enable:true},filter:{enable:true,option:[{name:"æ— ",value:"",selectedCallBack(o){},filterCallBack(o){return  true}},{name:"å·²å¯ç”¨",value:"enable",selectedCallBack(o){},filterCallBack(o){return o.data.enable}},{name:"æœªå¯ç”¨",value:"notEnable",selectedCallBack(o){},filterCallBack(o){return !o.data.enable}}],inputOption:[{name:"æ ‡é¢˜",value:"name",selectedCallBack(o){},filterCallBack(o,c){let u=false;return typeof o.data.title=="string"&&(u=!!o.data.title.match(c)),!u&&typeof o.subscribeData.title=="string"&&(u=!!o.subscribeData.title.match(c)),u}},{name:"è®¢é˜…åœ°å€",value:"url",selectedCallBack(o){},filterCallBack(o,c){return !!o.data.url.match(c)}}]},clearAll:{enable:true,callback:()=>{se.deleteAllSubscribe();}},ruleEnable:{enable:true,getEnable(o){return o.data.enable},async callback(o,c){o.data.enable=c,se.updateSubscribe(o);}},ruleEdit:{enable:true,callback:o=>{let c=o.ruleData.uuid;return o.enterDeepMenu({headerTitle:o.ruleData.data.title||o.ruleData.subscribeData.title||o.ruleData.data.url,data(){return se.getSubscribe(c)?.subscribeData?.ruleData??o.ruleData.subscribeData.ruleData},getData(u){return se.getSubscribeRule(c,u.uuid)??u},getDataItemName(u){return u.name??u.data.url},addData(u){return  true},updateData(u){return se.updateSubscribeRule(c,u)},deleteData(u){return se.deleteSubscribeRule(c,u)},btnControls:{filter:{enable:true,option:[{name:"æ— ",value:"",selectedCallBack(u){},filterCallBack(u){return  true}},{name:"å·²å¯ç”¨",value:"enable",selectedCallBack(u){},filterCallBack(u){return u.enable}},{name:"æœªå¯ç”¨",value:"notEnable",selectedCallBack(u){},filterCallBack(u){return !u.enable}},{name:"åœ¨å½“å‰ç½‘å€ç”Ÿæ•ˆ",value:"workInCurrentUrl",selectedCallBack(u){},filterCallBack(u){return e.checkRuleMatch(u)}}],inputOption:[{name:"è§„åˆ™å",value:"name",selectedCallBack(u){},filterCallBack(u,d){const p=u.name;return typeof p=="string"?!!p.match(d):false}},{name:"ç½‘å€",value:"url",selectedCallBack(u){},filterCallBack(u,d){return !!u.data.url.match(d)}}]},clearAll:{enable:true,callback:()=>{se.clearSubscribe(c);}},ruleEnable:{enable:true,getEnable(u){return u.enable},callback(u,d){u.enable=d,se.updateSubscribeRule(c,u);}},ruleEdit:{enable:true,getView:s,onsubmit:r},ruleDelete:{enable:true,deleteCallBack(u){return se.deleteSubscribeRule(c,u)}}}}),false}},ruleDelete:{enable:true,deleteCallBack:o=>se.deleteSubscribe(o)},import:{enable:true,callback(o){se.importSubscribe(()=>{o();});}},export:{enable:true,callback(){se.exportSubscribe($e+"-å­—å…¸æ˜ å°„-è®¢é˜….json");}}},getSubscribeInfo:se.getSubscribeInfo.bind(se)}}},checkRuleMatch(t,e=window.location.href){const a=t.data.isRegExp?new RegExp(t.data.url,t.data.regExpFlag):t.data.url;return !!e.match(a)},getUrlMatchedRule(t=true,e=window.location.href){let a=this.getData();const n=se.getAllSubscribeRule(t);return a=a.concat(n),a.filter(i=>{if(!(t&&!i.enable))return this.checkRuleMatch(i,e)})},getMappingData(t=window.location.href){const e=this.getUrlMatchedRule(true,t),a=[];return e.forEach(n=>{try{let i=Array.isArray(n.dynamicData)?[...n.dynamicData].concat(n.data):[n.data];for(let s=0;s<i.length;s++){const r=i[s];r.isRegExp?a.push({searchValue:new RegExp(r.searchValue,r.regExpFlag),replaceValue:r.replaceValue}):a.push({searchValue:r.searchValue,replaceValue:r.replaceValue});}}catch(i){m.error("å­—ç¬¦æ˜ å°„è§„åˆ™è½¬æ¢å‘ç”Ÿé”™è¯¯ï¼š",i);}}),a},getData(){return ie(this.$data.STORAGE_KEY,[])},setData(t){he(this.$data.STORAGE_KEY,t);},addData(t){let e=this.getData();return e.findIndex(n=>n.uuid==t.uuid)===-1?(e.push(t),he(this.$data.STORAGE_KEY,e),true):false},updateData(t){let e=this.getData(),a=e.findIndex(i=>i.uuid==t.uuid),n=false;return a!==-1&&(n=true,e[a]=t),this.setData(e),n},deleteData(t){let e=this.getData(),a=e.findIndex(i=>i.uuid==t.uuid),n=false;return a!==-1&&(n=true,e.splice(a,1)),this.setData(e),n},clearData(){Ye(this.$data.STORAGE_KEY);},exportRule(t="rule.json",e="rule-subscribe.json"){let a=K.alert({title:{text:"è¯·é€‰æ‹©å¯¼å‡ºæ–¹å¼",position:"center"},content:{text:`
                    <div class="btn-control" data-mode="only-export-rule-list">å¯¼å‡ºè§„åˆ™</div>
                    <div class="btn-control" data-mode="export-to-subscribe">å¯¼å‡ºè®¢é˜…è§„åˆ™</div>
                `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(r,l){r.close();}}},mask:{enable:true},drag:true,width:P.info.width,height:P.info.height,style:`
                .btn-control{
                    display: inline-block;
                    margin: 10px;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    cursor: pointer;
                }
				.btn-control:hover{
					color: #409eff;
					border-color: #c6e2ff;
					background-color: #ecf5ff;
				}
            `}),n=a.$shadowRoot.querySelector(".btn-control[data-mode='only-export-rule-list']"),i=a.$shadowRoot.querySelector(".btn-control[data-mode='export-to-subscribe']"),s=(r,l)=>{let o=new Blob([JSON.stringify(l,null,4)]),c=window.URL.createObjectURL(o),u=document.createElement("a");u.href=c,u.download=r,u.click(),setTimeout(()=>{window.URL.revokeObjectURL(c);},1500);};h.on(n,"click",r=>{h.preventEvent(r);try{let l=this.getData();if(l.length===0){g.warning("è§„åˆ™ä¸ºç©ºï¼Œæ— éœ€å¯¼å‡º");return}s(t,l),a.close();}catch(l){g.error(l.toString(),{consoleLogContent:true});}}),h.on(i,"click",r=>{h.preventEvent(r);const l=this;a.close();try{if(this.getData().length===0){g.warning("è§„åˆ™ä¸ºç©ºï¼Œæ— éœ€å¯¼å‡º");return}let c=z.config.PanelHandlerComponents();const u=function(y){return {get(v,$){return y[v]??$},set(v,$){y[v]=$,kt.set(l.$data.EXPORT_CONFIG_KEY,y);}}},d=()=>{let y=kt.get(this.$data.EXPORT_CONFIG_KEY,{});if(y?.title===""||y.title==null){g.error("è®¢é˜…æ ‡é¢˜ä¸èƒ½ä¸ºç©º");return}if(y.version==null){g.error("ç‰ˆæœ¬å·ä¸èƒ½ä¸ºç©º");return}else y.version=Number(y.version);y.homePage==null&&(y.homePage=void 0),y.lastModified=Date.now(),y.ruleData=this.getData(),s(e,y),p.close();},p=K.alert({title:{text:"è¯·å¡«å†™å¯¼å‡ºé…ç½®",position:"center"},content:{text:`
							
						`,html:!0},btn:{ok:{enable:!0,text:"å¯¼å‡º",callback(y,v){d();}},close:{enable:!0,callback(y,v){y.close();}}},mask:{enable:!0},drag:!0,width:P.info.width,height:P.info.height,style:`
						${z.config.cssText.panelCSS}

						.pops-alert-content li{
							list-style-type: none;
							display: flex;
							align-items: center;
							justify-content: space-between;
							margin: 10px;
						}
					`}),w=p.$shadowRoot.querySelector(".pops-alert-content"),b=kt.get(this.$data.EXPORT_CONFIG_KEY,{}),x=re("è®¢é˜…æ ‡é¢˜","title","");Reflect.set(x.props,j,u(b));const C=c.createSectionContainerItem_input(x).$el,R=re("ç‰ˆæœ¬å·","version","");Reflect.set(R.props,j,u(b));const M=c.createSectionContainerItem_input(R).$el,T=re("ä¸»é¡µåœ°å€","homePage","","",void 0,"é€‰å¡«");Reflect.set(T.props,j,u(b));const _=c.createSectionContainerItem_input(T).$el;h.append(w,C),h.append(w,M),h.append(w,_);}catch(o){g.error(o.toString(),{consoleLogContent:true});}});},importRule(t){const e=K.alert({title:{text:"è¯·é€‰æ‹©å¯¼å…¥æ–¹å¼",position:"center"},content:{text:`
                    <div class="btn-control" data-mode="local">æœ¬åœ°å¯¼å…¥</div>
                    <div class="btn-control" data-mode="network">ç½‘ç»œå¯¼å…¥</div>
                    <div class="btn-control" data-mode="clipboard">å‰ªè´´æ¿å¯¼å…¥</div>
                `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(l,o){l.close();}}},mask:{enable:true},drag:true,width:P.info.width,height:P.info.height,style:`
      .btn-control{
          display: inline-block;
          margin: 10px;
          padding: 10px;
          border: 1px solid #ccc;
          border-radius: 5px;
          cursor: pointer;
      }
      `}),a=e.$shadowRoot.querySelector(".btn-control[data-mode='local']"),n=e.$shadowRoot.querySelector(".btn-control[data-mode='network']"),i=e.$shadowRoot.querySelector(".btn-control[data-mode='clipboard']"),s=l=>{let o=this.getData();const c=[];for(let u=0;u<l.length;u++){const d=l[u];o.findIndex(w=>w.uuid===d.uuid)!==-1||c.push(d);}o=o.concat(c),this.setData(o),g.success(`å…± ${l.length} æ¡è§„åˆ™ï¼Œæ–°å¢ ${c.length} æ¡`),t?.();},r=l=>new Promise(o=>{const c=f.toJSON(l);if(!Array.isArray(c)){m.error(c),g.error("å¯¼å…¥å¤±è´¥ï¼Œæ ¼å¼ä¸ç¬¦åˆï¼ˆä¸æ˜¯æ•°ç»„ï¼‰",{consoleLogContent:true}),o(false);return}if(!c.length){g.error("å¯¼å…¥å¤±è´¥ï¼Œè§£æå‡ºçš„æ•°æ®ä¸ºç©º",{consoleLogContent:true}),o(false);return}s(c),o(true);});h.on(a,"click",l=>{h.preventEvent(l),e.close();const o=h.createElement("input",{type:"file",accept:".json"});h.on(o,["propertychange","input"],c=>{if(!o.files?.length)return;const u=o.files[0],d=new FileReader;d.onload=()=>{r(d.result);},d.readAsText(u,"UTF-8");}),o.click();}),h.on(n,"click",l=>{h.preventEvent(l),e.close();const o=K.prompt({title:{text:"ç½‘ç»œå¯¼å…¥",position:"center"},content:{text:"",placeholder:"è¯·å¡«å†™URL",focus:true},btn:{close:{enable:true,callback(d,p){d.close();}},ok:{text:"å¯¼å…¥",callback:async(d,p)=>{const w=d.text;if(f.isNull(w)){g.error("è¯·å¡«å…¥å®Œæ•´çš„url");return}const b=g.loading("æ­£åœ¨è·å–é…ç½®..."),x=await L.get(w,{allowInterceptConfig:false});if(b.close(),!x.status){m.error(x),g.error("è·å–é…ç½®å¤±è´¥",{consoleLogContent:true});return}await r(x.data.responseText)&&d.close();}},cancel:{enable:false}},mask:{enable:true},drag:true,width:P.info.width,height:"auto"}),c=o.$shadowRoot.querySelector("input"),u=o.$shadowRoot.querySelector(".pops-prompt-btn-ok");h.on(c,["input","propertychange"],d=>{h.val(c)===""?h.attr(u,"disabled","true"):h.removeAttr(u,"disabled");}),h.onKeyboard(c,"keydown",(d,p,w)=>{d==="Enter"&&w.length===0&&h.val(c)!==""&&h.emit(u,"click");}),h.emit(c,"input");}),h.on(i,"click",async l=>{h.preventEvent(l),e.close();const o=await f.getClipboardInfo();if(o.error!=null){g.error(o.error.toString());return}if(o.content.trim()===""){g.warning("è·å–åˆ°çš„å‰ªè´´æ¿å†…å®¹ä¸ºç©º");return}await r(o.content);});}},Y=new Ot({STORAGE_API_KEY:"websiteRule",STORAGE_KEY:"rule-subscribe"});class ke{ruleIndex=0;shareCode="";accessCode="";init(e){this.ruleIndex=e.ruleIndex,this.shareCode=e.shareCode,this.accessCode=e.accessCode;}}const O={matchRange_text:{before:t=>`${t}-text-match-range-before`,after:t=>`${t}-text-match-range-after`},matchRange_html:{before:t=>`${t}-html-match-range-before`,after:t=>`${t}-html-match-range-after`},function:{enable:t=>`${t}-enable`,checkLinkValidity:t=>`${t}-check-link-valid`,checkLinkValidityHoverTip:t=>`${t}-check-link-valid-hover-tip`,linkClickMode:t=>`${t}-click-mode`},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:t=>`${t}-open-blank-auto-fill-accesscode`,openBlankWithCopyAccessCode:t=>`${t}-open-blank-with-copy-accesscode`},schemeUri:{enable:t=>`${t}-scheme-uri-enable`,isForwardLinearChain:t=>`${t}-scheme-uri-forward-linear-chain`,isForwardBlankLink:t=>`${t}-scheme-uri-forward-blank-link`,uri:t=>`${t}-scheme-uri-uri`}},rt={features:{customAccessCodeEnable:t=>`${t}-custom-accesscode-enable`,customAccessCode:t=>`${t}-custom-accesscode`}},J={matchRange_text:{before(t,e){t=O.matchRange_text.before(t),e=F.getDefaultValue(t)??20;const a=B(t,e);return parseInt(a.value.toString())},after(t,e){t=O.matchRange_text.after(t),e=F.getDefaultValue(t)??10;const a=B(t,e);return parseInt(a.value.toString())}},matchRange_html:{before(t,e){t=O.matchRange_html.before(t),e=F.getDefaultValue(t)??100;const a=B(t,e);return parseInt(a.value.toString())},after(t,e){t=O.matchRange_html.after(t),e=F.getDefaultValue(t)??15;const a=B(t,e);return parseInt(a.value.toString())}},function:{enable(t,e){return t=O.function.enable(t),e=F.getDefaultValue(t)??true,!!B(t,e).value},linkClickMode(t,e){return t=O.function.linkClickMode(t),e=F.getDefaultValue(t)??"copy",B(t,e).value},checkLinkValidity(t,e){return t=O.function.checkLinkValidity(t),e=F.getDefaultValue(t)??false,!!B(t,e).value},checkLinlValidityHoverTip(t,e){return t=O.function.checkLinkValidityHoverTip(t),e=F.getDefaultValue(t)??true,!!B(t,e).value}},linkClickMode_openBlank:{openBlankAutoFilleAccessCode(t,e){return t=O.linkClickMode_openBlank.openBlankAutoFilleAccessCode(t),e=F.getDefaultValue(t)??true,!!B(t,e).value},openBlankWithCopyAccessCode(t,e){return t=O.linkClickMode_openBlank.openBlankWithCopyAccessCode(t),e=F.getDefaultValue(t)??false,!!B(t,e).value}},schemeUri:{enable(t,e){return t=O.schemeUri.enable(t),e=F.getDefaultValue(t)??false,!!B(t,e).value},isForwardLinearChain(t,e){return t=O.schemeUri.isForwardLinearChain(t),e=F.getDefaultValue(t)??false,!!B(t,e).value},isForwardBlankLink(t,e){return t=O.schemeUri.isForwardBlankLink(t),e=F.getDefaultValue(t)??false,!!B(t,e).value},uri(t,e){return t=O.schemeUri.uri(t),e=F.getDefaultValue(t)??"",B(t,e).value}}},le={getDefaultLinkClickMode(){return {copy:{default:false,enable:true,text:"å¤åˆ¶åˆ°å‰ªè´´æ¿"},"copy-closePopup":{default:false,enable:true,text:"å¤åˆ¶åˆ°å‰ªè´´æ¿ & å…³é—­å¼¹çª—"},openBlank:{default:false,enable:true,text:"æ–°æ ‡ç­¾é¡µæ‰“å¼€"},"openBlank-closePopup":{default:false,enable:true,text:"æ–°æ ‡ç­¾é¡µæ‰“å¼€ & å…³é—­å¼¹çª—"},parseFile:{default:false,enable:false,text:"æ–‡ä»¶è§£æ"},"parseFile-closePopup":{default:false,enable:false,text:"æ–‡ä»¶è§£æ & å…³é—­å¼¹çª—"},own:{default:false,enable:false,text:"è‡ªå®šä¹‰åŠ¨ä½œ"}}},replaceParam(t,e={}){return typeof t!="string"||Object.keys(e).forEach(a=>{let n=e[a];if(f.isNotNull(n)){try{t=t.replaceAll(`{#encodeURI-${a}#}`,encodeURI(n));}catch{m.error("encodeURI-æ›¿æ¢çš„æ–‡æœ¬å¤±è´¥",[n]);}try{t=t.replaceAll(`{#encodeURIComponent-${a}#}`,encodeURIComponent(n));}catch{m.error("encodeURIComponent-æ›¿æ¢çš„æ–‡æœ¬å¤±è´¥",[n]);}try{t=t.replaceAll(`{#decodeURI-${a}#}`,decodeURI(n));}catch{m.error("decodeURI-æ›¿æ¢çš„æ–‡æœ¬å¤±è´¥",[n]);}try{t=t.replaceAll(`{#decodeURIComponent-${a}#}`,decodeURIComponent(n));}catch{m.error("encodeURIComponent-æ›¿æ¢çš„æ–‡æœ¬å¤±è´¥",[n]);}t=t.replaceAll(`{#${a}#}`,n);}}),t},replaceChinese(t){return t.replace(/[\u4e00-\u9fa5]/g,"")},getDecodeComponentUrl(t=window.location.href){try{t=decodeURIComponent(t);}catch{}return t}},G={protocol:"jumpwsv",pathname:"go",parseDataToSchemeUri(t,e){if(!this.isEnableForward(t))return e;let n=J.schemeUri.uri(t);return f.isNull(n)&&(n=this.getSchemeUri(this.get1DMSchemeUriOption(e))),n.startsWith(this.protocol)&&(e=e.replace(/&/g,"{-and-}"),e=e.replace(/#/g,"{-number-}")),n=le.replaceParam(n,{intentData:e}),n},isEnableForward(t){return J.schemeUri.enable(t)},isForwardDownloadLink(t){return this.isEnableForward(t)&&J.schemeUri.isForwardLinearChain(t)},isForwardBlankLink(t){return this.isEnableForward(t)&&J.schemeUri.isForwardBlankLink(t)},getSchemeUri(t){return `${this.protocol}://${this.pathname}?${f.toSearchParamsStr(t)}`},get1DMSchemeUriOption(t=""){return {package:"idm.internet.download.manager.plus",activity:"idm.internet.download.manager.UrlHandlerDownloader",intentAction:"android.intent.action.VIEW",intentData:t,intentExtra:""}}},tt="(123pan|123865|123684|123652|123912).(com|cn)",Ht={rule:[{link_innerText:`${tt}/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`${tt}/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)`,shareCode:new RegExp(`${tt}/s/([a-zA-Z0-9_-]{8,14})`,"gi"),shareCodeNeedRemoveStr:new RegExp(`${tt}/s/`,"gi"),checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"123pan.com/s/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://123pan.com/s/{#shareCode#}",copyUrl:`https://123pan.com/s/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"123ç›˜",key:"_123pan",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:true,isForwardBlankLink:true,uri:""}}}},jt={KEY:"_123pan_User_Authorization",set(t){he(this.KEY,t);},get(){return ie(this.KEY)}},wa=function(){if(window.location.hostname!=="www.123pan.com"||J.function.linkClickMode(Ht.setting.key)!=="parseFile")return;let t=ne.localStorage.getItem("authorToken");f.isNull(t)||(t=t.replace(/^\"/,"").replace(/\"$/,""),m.success("è·å–123ç½‘ç›˜å·²ç™»å½•ç”¨æˆ·çš„authorTokenå€¼ğŸ‘‡"),m.success(t),jt.set(t));},Kt={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=await L.get("https://www.123pan.com/api/share/info?shareKey="+a,{headers:{"User-Agent":f.getRandomPCUA(),Host:"www.123pan.com",Origin:"https://www.123pan.com",Referer:"https://www.123pan.com/"},responseType:"json",...pe});if(!i.status&&f.isNull(i.data.responseText))return {...A.networkError,data:i};const s=f.toJSON(i.data.responseText);return i.data.responseText.includes("åˆ†äº«é¡µé¢ä¸å­˜åœ¨")?{...A.failed,msg:"åˆ†äº«é¡µé¢ä¸å­˜åœ¨",data:s}:s.code!==0?{...A.failed,msg:typeof s.message=="string"?s.message:A.failed.msg,data:s}:s.data.HasPwd?{...A.needAccessCode,data:s}:{...A.success,data:s}}};class ba extends ke{panelList=[];Authorization="";code={5113:"æ‚¨ä»Šæ—¥ä¸‹è½½æµé‡å·²è¶…å‡º10GBé™åˆ¶ï¼Œè´­ä¹°VIPä¼šå‘˜å³å¯ä½“éªŒæ— é™æµé‡ä¸‹è½½",5103:"åˆ†äº«ç é”™è¯¯æˆ–è€…åˆ†äº«åœ°å€é”™è¯¯",5104:"åˆ†äº«å·²è¿‡æœŸ","-1000":"è·å–å‡ºé”™","-2000":"è¯·æ±‚å¼‚å¸¸","-3000":"è¯·æ±‚æ„å¤–ä¸­æ­¢","-4000":"è¯·æ±‚è¶…æ—¶",104:"æ–‡ä»¶å·²å¤±æ•ˆ"};Headers={"user-agent":"123pan/v2.4.0(Android_7.1.2;Xiaomi)",platform:"android","app-version":"61","x-app-version":"2.4.0"};async init(e){super.init(e),this.panelList.length=0,this.Authorization=jt.get();const a=g.loading("æ­£åœ¨è§£æï¼Œè¯·ç¨å..."),n=await Kt.init(e);if(n.code!==A.success.code&&n.code!==A.needAccessCode.code){a.close(),g.error(n.msg);return}const i=await this.getFiles();if(!i){a.close();return}if(i.length===1&&i[0].Type==0){const s=i[0];if(s.Status==104){a.close(),g.error("æ–‡ä»¶å·²å¤±æ•ˆ");return}let r=s.DownloadUrl,l="";if(r===""){a.setText("æ­£åœ¨è·å–ä¸‹è½½é“¾æ¥...");let u=await this.getFileDownloadInfo(s.Etag,s.FileId,s.S3KeyFlag,this.shareCode,s.Size);u&&u.code===0?(r=u.data.DownloadURL,G.isForwardDownloadLink("_123pan")&&(r=G.parseDataToSchemeUri("_123pan",r)),l=String(f.formatByteToSize(s.Size))):u&&u.code===401?(r="javascript:;",l="è¯·ç™»å½•åä¸‹è½½"):(r="javascript:;",l="è·å–ä¸‹è½½é“¾æ¥å¤±è´¥");}else G.isForwardDownloadLink("_123pan")&&(r=G.parseDataToSchemeUri("_123pan",r)),l=f.formatByteToSize(s.Size).toString();let o=new Date(s.CreateAt).getTime(),c=new Date(s.UpdateAt).getTime();o=f.formatTime(o),c=f.formatTime(c),S.$inst.linearChainDialogView.oneFile({title:"123ç›˜å•æ–‡ä»¶ç›´é“¾",fileName:s.FileName,fileSize:l,downloadUrl:r,fileUploadTime:o,fileLatestTime:c});}else {a.setText("æ­£åœ¨è§£æå¤šæ–‡ä»¶...");const s=this.getFolderInfo(i,0);m.info("è§£æå®Œæ¯•"),S.$inst.linearChainDialogView.moreFile("123ç›˜æ–‡ä»¶è§£æ",s);}a.close();}async getFiles(e=0){const a=this,n={limit:100,next:1,orderBy:"share_id",orderDirection:"desc",shareKey:a.shareCode,SharePwd:a.accessCode,ParentFileId:e,Page:1};let i=`https://www.123pan.com/b/api/share/get?${f.toSearchParamsStr(n)}`,s=await L.get({url:i,headers:{Accept:"*/*",Referer:`https://www.123pan.com/s/${a.shareCode}`,...a.Headers}});if(m.info(s),!s.status)return;let r=s.data,l=f.toJSON(r.responseText);if(l.code===0)return l.data.InfoList;l.code===5103?S.$inst.newAccessCodeView(void 0,"_123pan",a.ruleIndex,a.shareCode,a.accessCode,o=>{a.init({ruleIndex:a.ruleIndex,shareCode:a.shareCode,accessCode:o.accessCode});}):a.code[l.code]?g.error(a.code[l.code]):"message"in l?g.error(l.message):g.error("123ç›˜ï¼šæœªçŸ¥çš„JSONæ ¼å¼");}async getFilesByRec(e){const a=this;let n=await L.get({url:`https://www.123pan.com/b/api/share/get?limit=100&next=1&orderBy=share_id&orderDirection=desc&shareKey=${a.shareCode}&SharePwd=${a.accessCode}&ParentFileId=${e}&Page=1`,headers:{Accept:"*/*",Referer:`https://www.123pan.com/s/${a.shareCode}`,...a.Headers}});if(!n.status)return;let i=n.data;m.info(i);let s=f.toJSON(i.responseText);if(s.code==0)return s.data.InfoList}getFolderInfo(e,a){const n=[];return e.forEach(i=>{i.Type?n.push({fileName:i.FileName,fileSize:0,fileType:"",createTime:new Date(i.CreateAt).getTime(),latestTime:new Date(i.UpdateAt).getTime(),isFolder:true,index:a,clickEvent:async()=>{const s=await this.getFilesByRec(i.FileId.toString());return s?this.getFolderInfo(s,a+1):[]}}):n.push({fileName:i.FileName,fileSize:i.Size,fileType:"",createTime:new Date(i.CreateAt).getTime(),latestTime:new Date(i.UpdateAt).getTime(),isFolder:false,index:a,clickEvent:async()=>{if(i.Status==104)g.error("æ–‡ä»¶å·²å¤±æ•ˆ");else if(f.isNotNull(i.DownloadUrl)){const s=await this.getFileDownloadInfo(i.Etag,i.FileId,i.S3KeyFlag,this.shareCode,i.Size);if(s&&s.code===0)return {url:s.data.DownloadURL,autoDownload:true,mode:"aBlank"};s&&s.code===401?g.error("è¯·ç™»å½•åä¸‹è½½"):g.error(s?.message||"è·å–ä¸‹è½½é“¾æ¥å¤±è´¥");}else {let s=i.DownloadUrl;return G.isForwardDownloadLink("_123pan")&&(s=G.parseDataToSchemeUri("_123pan",s)),{url:s,autoDownload:true,mode:"aBlank"}}}});}),n}async getFileDownloadInfo(e,a,n,i,s){const r=this;let l=r.getFileDownloadAuth(),o={"Content-Type":"application/json;charset=UTF-8",Host:"www.123pan.com",Accept:"*/*",Referer:"https://www.123pan.com/s/"+i,Origin:"https://www.123pan.com",...r.Headers};r.Authorization&&Reflect.set(o,"Authorization","Bearer "+r.Authorization),m.success("è·å–ä¸‹è½½é“¾æ¥åŠ å¯†å‚æ•°ï¼š"+l);let c=await L.post(`https://www.123pan.com/a/api/share/download/info?${l[0]}=${l[1]}`,{data:JSON.stringify({Etag:e,FileID:a,S3keyFlag:n,ShareKey:i,Size:s}),responseType:"json",headers:o});if(!c.status)return;let u=c.data,d=f.toJSON(u.responseText);return m.info(d),d.code==0?(d.data.DownloadURL=r.decodeDownloadUrl(d.data.DownloadURL),d):{code:d.code,message:d.message}}getFileDownloadAuth(){function e(i){var s,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8;if(arguments.length!==0){typeof i=="object"?s=i:((""+i).length===10&&(i=1e3*parseInt(i)),s=new Date(i));var l=i+6e4*new Date(i).getTimezoneOffset(),o=l+36e5*r;return s=new Date(o),{y:s.getFullYear(),m:s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1,d:s.getDate()<10?"0"+s.getDate():s.getDate(),h:s.getHours()<10?"0"+s.getHours():s.getHours(),f:s.getMinutes()<10?"0"+s.getMinutes():s.getMinutes()}}}function a(i){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,r=function(){for(var d,p=[],w=0;w<256;w++){d=w;for(var b=0;b<8;b++)d=1&d?3988292384^d>>>1:d>>>1;p[w]=d;}return p},l=r(),o=i,c=-1,u=0;u<o.length;u++)c=c>>>8^l[255&(c^o.charCodeAt(u))];return c=(-1^c)>>>0,c.toString(s)}function n(i){var s="web",r=3,l=Math.round((new Date().getTime()+60*new Date().getTimezoneOffset()*1e3+288e5)/1e3).toString(),o="a,d,e,f,g,h,l,m,y,i,j,n,o,p,k,q,r,s,t,u,b,c,v,w,s,z",c=Math.round(1e7*Math.random()),u,d={},p,w,b,x,C,R,M;for(var T in u=o.split(","),d=e(l),p=d.y,w=d.m,b=d.d,x=d.h,C=d.f,R=[p,w,b,x,C].join(""),M=[],R)M.push(u[Number(R[T])]);var _,y;return _=a(M.join("")),y=a("".concat(l,"|").concat(String(c),"|").concat(i,"|").concat(s,"|").concat(String(r),"|").concat(_)),[_,"".concat(l,"-").concat(String(c),"-").concat(y)]}return n("/a/api/share/download/info")}decodeDownloadUrl(e){return e===""?"":e}}class ka extends ke{X_Share_Token_Data={expire_time:"2000-01-01T00:00:00.000Z",expires_in:7200,share_token:""};X_Device_Id=null;X_Canary="client=web,app=share,version=v2.3.1";async init(e){super.init(e);const a=this;let{ruleIndex:n,shareCode:i,accessCode:s}=e;if(a.X_Device_Id=a.get_X_Device_Id(),m.info("ç”ŸæˆX_Device_Idï¼š"+a.X_Device_Id),globalThis.location.hostname!=="www.aliyundrive.com"&&globalThis.location.hostname!=="www.alipan.com"){let c=ee.getBlankUrl({ruleKeyName:"aliyun",ruleIndex:n,shareCode:i,accessCode:s}),u=g.error(`è¯·åœ¨é˜¿é‡Œäº‘ç›˜é¡µé¢è§£æï¼Œ<a href="${c}">ç‚¹æˆ‘å‰å¾€</a>`,{timeout:1e4,isHTML:true});h.on(u.$el.$item.querySelector("a[href]"),"click",d=>{h.preventEvent(d),Se.openBlankUrl(c,"aliyun",a.ruleIndex,a.shareCode,a.accessCode);});return}const r=g.loading("æ­£åœ¨è§£æï¼Œè¯·ç¨å..."),l=await this.list_by_share(i,"root");if(!l){r.close();return}r.setText("æ­£åœ¨è§£æå¤šæ–‡ä»¶...");const o=a.getFolderInfo(l,0);m.info("è§£æå®Œæ¯•"),r.close(),S.$inst.linearChainDialogView.moreFile("é˜¿é‡Œäº‘ç›˜æ–‡ä»¶è§£æ",o);}getFolderInfo(e,a=0){const n=[];return e.forEach(i=>{i.type!=="folder"?n.push({fileName:i.name,fileSize:i.size,fileType:i.file_extension,createTime:new Date(i.created_at).getTime(),latestTime:new Date(i.updated_at).getTime(),isFolder:false,index:a,clickEvent:async()=>{const s=g.loading("æ­£åœ¨è·å–ä¸‹è½½é“¾æ¥..."),r=await this.get_share_link_download_url(i.share_id,i.file_id);if(s.close(),!r)return;let l=r;return G.isForwardDownloadLink("aliyun")&&(l=G.parseDataToSchemeUri("aliyun",l)),{autoDownload:true,mode:"aBlank",url:l}}}):n.push({fileName:i.name,fileSize:0,fileType:"",createTime:i.created_at,latestTime:i.updated_at,isFolder:true,index:a,clickEvent:async()=>{const s=await this.list_by_share(i.share_id,i.file_id);return s?this.getFolderInfo(s,a+1):[]}});}),n}async list_by_share(e,a,n="name",i="DESC"){const s=this;let r=await L.post("https://api.aliyundrive.com/adrive/v2/file/list_by_share",{data:JSON.stringify({share_id:e,parent_file_id:a,limit:20,image_thumbnail_process:"image/resize,w_256/format,jpeg",image_url_process:"image/resize,w_1920/format,jpeg/interlace,1",video_thumbnail_process:"video/snapshot,t_1000,f_jpg,ar_auto,w_256",order_by:n,order_direction:i}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Origin:"https://www.aliyundrive.com",Referer:"https://www.aliyundrive.com/","X-Canary":s.X_Canary,"X-Device-Id":s.X_Device_Id,"X-Share-Token":await s.get_X_Share_Token(s.shareCode,s.accessCode),"User-Agent":f.getRandomPCUA()},allowInterceptConfig:false});if(!r.status){s.handle_request_error(r);return}let l=f.toJSON(r.data.responseText);return m.info("åˆ—å‡ºæ–‡ä»¶åˆ—è¡¨ï¼š",l),l.items}async get_share_link_download_url(e,a){const n=this;let i=await L.post("https://api.aliyundrive.com/v2/file/get_share_link_download_url",{data:JSON.stringify({expire_sec:600,file_id:a,share_id:e}),headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.aliyundrive.com",Referer:"https://www.aliyundrive.com/","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer "+n.getAuthorization(),"X-Share-Token":await n.get_X_Share_Token(n.shareCode,n.accessCode),"User-Agent":f.getRandomPCUA()},responseType:"arraybuffer",allowInterceptConfig:false});if(!i.status){n.handle_request_error(i);return}let s=f.toJSON(i.data.responseText);return m.info("è·å–æ–‡ä»¶çš„ä¸‹è½½é“¾æ¥ï¼š",s),s.download_url}handle_request_error(e){m.error(e);const a=f.toJSON(e.data.responseText),n=a.message;if(typeof n=="string"&&n.trim()!=="")return g.error(n),true;if(typeof a.code=="string"&&a.code.trim()!=="")g.error(a.code);else return typeof e.msg=="string"&&e.msg.trim()!==""?(g.error(e.msg),true):false}getAuthorization(){let e=ne.localStorage.getItem("token");if(f.isNotNull(e)&&e!=null){let n=f.toJSON(e).access_token;return m.success("è·å–é˜¿é‡Œäº‘ç›˜çš„access_tokenï¼š",n),n}else g.error("è·å–access_tokenå¤±è´¥ï¼Œè¯·å…ˆç™»å½•è´¦å·ï¼");}async get_X_Share_Token(e,a){const n=this;if(new Date<new Date(n.X_Share_Token_Data.expire_time))return n.X_Share_Token_Data.share_token;let i=await L.post("https://api.aliyundrive.com/v2/share_link/get_share_token",{data:JSON.stringify({share_id:e,share_pwd:a}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Origin:"https://www.aliyundrive.com",Referer:"https://www.aliyundrive.com/","X-Canary":n.X_Canary,"X-Device-Id":n.X_Device_Id,"User-Agent":f.getRandomPCUA()},allowInterceptConfig:false});if(!i.status){n.handle_request_error(i);return}let s=f.toJSON(i.data.responseText);return n.X_Share_Token_Data=s,m.info("è·å–share_tokenï¼š",n.X_Share_Token_Data),n.X_Share_Token_Data.share_token}get_X_Device_Id(){for(var e=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,a=[],n=0;n<256;++n)a.push((n+256).toString(16).substr(1));function i(){return crypto.getRandomValues(new Uint8Array(16))}var s=function(l){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,c=(a[l[o+0]]+a[l[o+1]]+a[l[o+2]]+a[l[o+3]]+"-"+a[l[o+4]]+a[l[o+5]]+"-"+a[l[o+6]]+a[l[o+7]]+"-"+a[l[o+8]]+a[l[o+9]]+"-"+a[l[o+10]]+a[l[o+11]]+a[l[o+12]]+a[l[o+13]]+a[l[o+14]]+a[l[o+15]]).toLowerCase();if(!(function(u){return typeof u=="string"&&e.test(u)})(c))throw TypeError("Stringified UUID is invalid");return c},r=function(l,o,c){var u=(l=l||{}).random||(l.rng||i)();return u[6]=15&u[6]|64,u[8]=63&u[8]|128,s(u)};return r()}}class ya extends ke{async init(e){super.init(e);const{ruleIndex:a,shareCode:n,accessCode:i}=e,s=ie("baidu-baiduwp-php-url");let r=ie("baidu-baiduwp-php-post-form");const l=ie("baidu-baiduwp-php-copy-url");if(!s){g.error("è¯·å…ˆåœ¨è®¾ç½®ä¸­é…ç½®ç™¾åº¦ç½‘ç›˜-ç½‘å€");return}if(!r){g.error("è¯·å…ˆåœ¨è®¾ç½®ä¸­é…ç½®ç™¾åº¦ç½‘ç›˜-è¡¨å•å‚æ•°");return}r=le.replaceParam(r,{shareCode:n,accessCode:i});const o=h.createElement("form",{action:s,method:"post",target:"_blank"}),c={},u=new URLSearchParams(r);h.css(o,"display","none"),u.forEach((d,p)=>{const w=document.createElement("textarea");w.name=p,w.value=d,o.appendChild(w),c[p]=d;}),m.info("è¡¨å•æ•°æ®ï¼š",c),m.info("è®¿é—®ç½‘å€ï¼š",s),(document.body||document.documentElement).appendChild(o),l?(Se.copy("baidu",a,n,i,"1.5ç§’åè·³è½¬è‡³è§£æç«™"),setTimeout(()=>{o.submit();},1500)):o.submit();}}const _t=`.pops[type-value="alert"] .pops-alert-title:has(+ .pops-alert-content .netdisk-url-box-all:empty) {
  border-bottom: none;
}
.netdisk-url-box {
  border-bottom: 1px solid #e4e6eb;
}
.netdisk-url-div {
  display: flex;
  align-items: center;
  width: 100%;
  padding: 5px 0px 5px 0px;
}
.netdisk-icon {
  display: contents;
}
.netdisk-icon .netdisk-icon-img {
  cursor: pointer;
  width: 28px;
  height: 28px;
  min-width: 28px;
  min-height: 28px;
  font-size: 0.8em;
  margin: 0px 10px;
}
.netdisk-url-div .netdisk-icon,
.netdisk-url-div .netdisk-status {
  flex: 0 0 auto;
}
.netdisk-url-div .netdisk-url {
  flex: 1;
}
.netdisk-icon .netdisk-icon-img {
  border-radius: 10px;
  box-shadow:
    0 0.3px 0.6px rgb(0 0 0 / 6%),
    0 0.7px 1.3px rgb(0 0 0 / 8%),
    0 1.3px 2.5px rgb(0 0 0 / 10%),
    0 2.2px 4.5px rgb(0 0 0 / 12%),
    0 4.2px 8.4px rgb(0 0 0 / 14%),
    0 10px 20px rgb(0 0 0 / 20%);
}
.netdisk-status[data-check-failed] {
  padding: 5px 5px;
}
.netdisk-url {
  padding: 5px 5px;
}
.netdisk-url a {
  color: #ff4848 !important;
  min-height: 28px;
  overflow-x: hidden;
  overflow-y: auto;
  font-size: 0.8em;
  border: none;
  display: flex;
  align-items: center;
  width: fit-content;
  height: 100%;
  padding: 0px;
  word-break: break-word;
  text-align: left;
}
.netdisk-status {
  display: none;
}
.netdisk-status[data-check-valid] {
  display: flex;
  align-items: center;
  width: 15px;
  height: 15px;
  color: #000000;
}

.netdisk-status[data-check-valid="failed"] {
  color: red;
}

.netdisk-status[data-check-valid="partial-violation"] {
  color: orange;
}

.netdisk-status[data-check-valid="error"] {
  cursor: pointer;
}

.netdisk-status[data-check-valid="success"] {
  color: green;
}

.netdisk-status[data-check-valid="verify"] {
  color: #faad14;
}

.netdisk-status[data-check-valid="loading"] svg {
  animation: rotating 2s linear infinite;
}

.netdisk-url-box:has(.netdisk-status[data-check-valid="failed"]) {
  text-decoration: line-through;
}

.whitesevPop-whitesevPopSetting :focus-visible {
  outline-offset: 0;
  outline: 0;
}
.netdisk-url a[isvisited="true"] {
  color: #8b8888 !important;
}
.netdisk-url a:active {
  box-shadow: 0 0 0 1px #616161 inset;
}
.netdisk-url a:focus-visible {
  outline: 0;
}
.whitesevPop-content p[pop] {
  text-indent: 0;
}
.whitesevPop-button[data-type="primary"] {
  border-color: #2d8cf0;
  background-color: #2d8cf0;
}
`,Tt={generateViewData(){let t=[];return S.$data.isMatchedNetDiskIconMap.forEach(e=>{V.$match.matchedInfo.get(e).forEach((n,i)=>{t.push({ruleKeyName:e,shareCode:i,netDiskDictData:n});});}),t=Ce.sortListByProperty(t,e=>e.netDiskDictData.matchTime,false),t}},fe={$el:{get $urlBoxAll(){return S.$el.$linkView.$shadowRoot.querySelector(".netdisk-url-box-all")}},$inst:{dataPaging:null},$data:{dataPagingEnable:false},show(){const t=k.smallWindow["netdisk-ui-link-view-data-paging-enable"].value;S.$el.$linkView==null?(this.$data.dataPagingEnable=t,this.createLinkView(),Je.init()):(S.$el.$linkView.show(),this.$data.dataPagingEnable!==t&&(t?this.$inst.dataPaging.show():this.$inst.dataPaging.hide(),this.refreshLinkView(),this.$data.dataPagingEnable=t));},createLinkView(){const t={view:{"netdisl-small-window-shrink-status":Ne("netdisl-small-window-shrink-status",false),"netdisk-ui-small-window-position":Ne("netdisk-ui-small-window-position",null)}},e='<div class="netdisk-url-search-wrapper"></div><div class="netdisk-url-box-all"></div><div class="netdisk-url-pagination-wrapper"></div>',a=()=>k.features["netdisk-behavior-mode"].value.toLowerCase().includes("suspension"),n=()=>{a()?(ue.mode.current_suspension_smallwindow_mode.value="suspension",S.$el.$linkView.hide(),S.$inst.suspension.init()):(S.$el.$linkView.close(),S.$el.$linkView=void 0);},i=k.features["netdisk-behavior-mode"].value.toLowerCase().includes("smallwindow");if(i){S.$el.$linkView=K.alert({title:{text:"ç½‘ç›˜",position:"center"},content:{text:e,html:true},btn:{ok:{enable:false},close:{callback(){n();}}},mask:{enable:false},animation:"",beforeAppendToPageCallBack(p,w){let b=p.querySelector(".pops-header-control"),x=p.querySelector(".pops-alert-title"),C=p.querySelector(".pops-alert-content"),R=h.createElement("button",{className:"pops-header-control",innerHTML:`
                                <i class="pops-icon">
									<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
										<path fill="currentColor" d="M290.816 774.144h167.936c12.288 0 20.48 8.192 20.48 20.48s-8.192 20.48-20.48 20.48h-219.136c-12.288 0-20.48-8.192-20.48-20.48v-2.048-206.848c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v163.84l210.944-198.656c8.192-8.192 20.48-8.192 28.672 0s8.192 20.48 0 28.672l-208.896 194.56z m462.848-524.288h-167.936c-12.288 0-20.48-8.192-20.48-20.48s8.192-20.48 20.48-20.48h219.136c12.288 0 20.48 8.192 20.48 20.48v208.896c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-163.84l-210.944 198.656c-8.192 8.192-20.48 8.192-28.672 0s-8.192-20.48 0-28.672l208.896-194.56z m188.416 323.584c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-389.12c0-34.816-26.624-61.44-61.44-61.44h-655.36c-34.816 0-61.44 26.624-61.44 61.44v655.36c0 34.816 26.624 61.44 61.44 61.44h655.36c34.816 0 61.44-26.624 61.44-61.44v-94.208c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v94.208c0 57.344-45.056 102.4-102.4 102.4h-655.36c-57.344 0-102.4-45.056-102.4-102.4v-655.36c0-57.344 45.056-102.4 102.4-102.4h655.36c57.344 0 102.4 45.056 102.4 102.4v389.12z">
										</path>
									</svg>
                                </i>
                                `},{type:"button","data-type":"launch","data-header":true}),M=h.createElement("button",{className:"pops-header-control",innerHTML:`
                                <i class="pops-icon">
									<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
										<path fill="currentColor" d="M618.496 425.984h167.936c12.288 0 20.48 8.192 20.48 20.48s-8.192 20.48-20.48 20.48h-219.136c-12.288 0-20.48-8.192-20.48-20.48v-2.048-206.848c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v163.84l210.944-198.656c8.192-8.192 20.48-8.192 28.672 0s8.192 20.48 0 28.672l-208.896 194.56z m-192.512 172.032h-167.936c-12.288 0-20.48-8.192-20.48-20.48s8.192-20.48 20.48-20.48h219.136c12.288 0 20.48 8.192 20.48 20.48v208.896c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-163.84l-210.944 198.656c-8.192 8.192-20.48 8.192-28.672 0s-8.192-20.48 0-28.672l208.896-194.56z m516.096-24.576c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-389.12c0-34.816-26.624-61.44-61.44-61.44h-655.36c-34.816 0-61.44 26.624-61.44 61.44v655.36c0 34.816 26.624 61.44 61.44 61.44h655.36c34.816 0 61.44-26.624 61.44-61.44v-94.208c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v94.208c0 57.344-45.056 102.4-102.4 102.4h-655.36c-57.344 0-102.4-45.056-102.4-102.4v-655.36c0-57.344 45.056-102.4 102.4-102.4h655.36c57.344 0 102.4 45.056 102.4 102.4v389.12z">
										</path>
									</svg>
                                </i>
                                `},{type:"button","data-type":"shrink","data-header":true});h.before(b,R),h.before(b,M),h.on(R,"click",function(){h.addClass(R,"pops-hide-important"),h.removeClass(M,"pops-hide-important"),h.removeClass(x,"pops-no-border-important"),h.removeClass(C,"pops-hide-important"),t.view["netdisl-small-window-shrink-status"].value=false;},{capture:true}),h.on(M,"click",function(){h.removeClass(R,"pops-hide-important"),h.addClass(M,"pops-hide-important"),h.addClass(x,"pops-no-border-important"),h.addClass(C,"pops-hide-important"),t.view["netdisl-small-window-shrink-status"].value=true;},{capture:true}),t.view["netdisl-small-window-shrink-status"].value?M.click():R.click();},dragMoveCallBack(p,w,b){t.view["netdisk-ui-small-window-position"].value={left:w,top:b};},class:"whitesevPop netdisk-link-view-small-window",style:`
                    ${_t}

                    .pops {
                        --container-title-height: 35px;
                        --content-max-height: ${k.smallWindow["netdisk-ui-small-window-max-height"].value}px;
                        --netdisk-line-space: 8px;
                        --netdisk-icon-size: 24px;
                    }
                    .pops[type-value="alert"]{
                        transform: none;
                    }
                    .pops {
                        max-height: var(--content-max-height);
                    }
                    .pops[type-value=alert] .pops-alert-content{
                        max-height: calc(var(--content-max-height) - var(--container-title-height) - var(--container-bottom-btn-height));
                    }
                    .pops-header-controls button.pops-header-control[type][data-header]{
                        padding: 0px 5px;
                    }
                    .netdisk-url-div{
                        padding: 0px;
                    }
                    .netdisk-icon .netdisk-icon-img{
                        width: var(--netdisk-icon-size);
                        height: var(--netdisk-icon-size);
                        min-width: var(--netdisk-icon-size);
                        min-height: var(--netdisk-icon-size);
                        margin: 0px var(--netdisk-line-space);
                    }
                    .netdisk-status{
                        margin-right: var(--netdisk-line-space);
                    }
                    .netdisk-url{
                        padding: 2px 0px;
                    }
                    `},S.$config.viewSizeConfig.mainViewSmallWindow);const u=t.view["netdisk-ui-small-window-position"].value,d=S.$el.$linkView.$pops;if(u){let p=h.width(d,true),w=h.height(d,true),b=h.width(window),x=h.height(window);const{transformLeft:C,transformTop:R}=h.getTransform(d);let M=b-p+C,T=x-w+R,_=0+C,y=0+R;u.top>T?u.top=T:u.top<y&&(u.top=y),u.left>M?u.left=M:u.left<_&&(u.left=_),d.style.transitionDuration="0s",d.style.left=u.left+"px",d.style.top=u.top+"px",setTimeout(()=>{d.style.transitionDuration="0s";},300);}}else S.$el.$linkView=K.alert({title:{text:"ç½‘ç›˜",position:"center"},content:{text:e,html:true},btn:{ok:{enable:false},close:{callback(){n();}}},mask:{clickCallBack(){n();}},class:"whitesevPop netdisk-link-view-window",style:`
                    ${_t}

          .pops {
              max-height: 60vh;
          }
					@media screen and (max-width: 600px) {
						.pops {
                max-height: 50vh;
            }
					}
                    `},S.$config.viewSizeConfig.mainView);const s=S.$el.$linkView.$shadowRoot.querySelector(".netdisk-url-pagination-wrapper"),r=Tt.generateViewData(),l=k.smallWindow["netdisk-ui-link-view-data-paging-show-data-count"].value;this.$inst.dataPaging=new zt({data:r,pageShowDataMaxCount:l,pageMaxStep:i?2:4,currentPage:1,pageChangeCallBack:async u=>{te.clearAllDelayCheckLinkValidity();const d=k.smallWindow["netdisk-ui-link-view-data-paging-enable"].value;await this.dataPagingChangeCallback({data:this.$inst.dataPaging.CONFIG.data,refreshView:true,page:d?u:void 0});}}),this.$inst.dataPaging.addCSS(S.$el.$linkView.$shadowRoot),this.$inst.dataPaging.append(s);const o=h.createElement("style",{type:"text/css",textContent:`
          .pops-content:has(.netdisk-url-pagination-wrapper){
            display: flex;
            flex-direction: column;
            overflow: hidden;
          }
          .pops-content:has(.netdisk-url-pagination-wrapper) .netdisk-url-box-all{
            flex: 1;
            overflow: auto;
          }
          .pops-content .netdisk-url-pagination-wrapper{
            flex: 0;
            display: flex;
            justify-content: center;
            padding: 4px 0px;
          }
          .pops-content #data-paging-wrapper{

          }
          .pops-content #data-paging-wrapper a{

          }

          /* å°çª— */
          .netdisk-link-view-small-window #data-paging-wrapper{
            display: flex;
            flex-wrap: nowrap;
            align-items: center;
          }
          .netdisk-link-view-small-window .pops-content .netdisk-url-pagination-wrapper{
            scale: 0.7;
            padding: 0px;
          }
        `});S.$el.$linkView.$shadowRoot.appendChild(o),k.smallWindow["netdisk-ui-link-view-data-paging-enable"].value||this.$inst.dataPaging.hide(),this.refreshLinkView();const c=k.smallWindow["netdisk-link-view-z-index"].value;c>0&&h.css(S.$el.$linkView.$pops,{"z-index":c});},refreshLinkView(){const t=this.$inst.dataPaging.PAGE_CONFIG.currentPage();this.$inst.dataPaging.CONFIG.pageChangeCallBack(t);},clearLinkView(){h.empty(this.$el.$urlBoxAll),this.$el.$urlBoxAll.scrollTo(0,0);},async dataPagingChangeCallback(t){const{refreshView:e,page:a,isCheckValid:n}=t;let{data:i}=t;if(!i.length){m.warn("data is empty");return}e&&this.clearLinkView();let s=document.createDocumentFragment();const r=[];let l=0,o=i.length,c=0;if(typeof a=="number"){const u=k.smallWindow["netdisk-ui-link-view-data-paging-show-data-count"].value;o=u,l=(a-1)*u;}for(;!(l>i.length-1||c>=o);){const u=i[l],{ruleKeyName:d,netDiskDictData:p,shareCode:w}=u;let b=V.handleLinkShow({ruleKeyName:d,ruleIndex:p.ruleIndex,shareCode:w,accessCode:p.accessCode,matchText:p.matchText,showToast:false});if(!b)continue;let x=this.createBoxItemInfo(S.$inst.icon.getIcon(d),d,p.ruleIndex,w,p.accessCode,b);r.push({$urlBox:x.$urlBox,ruleKeyName:d,ruleIndex:p.ruleIndex,shareCode:w,accessCode:p.accessCode}),s.appendChild(x.$urlBox),l++,c++;}this.$el.$urlBoxAll.appendChild(s),(n??true)&&te.check(r);},addBoxItemView(t,e,a,n,i){if(S.$inst.historyMatch.changeMatchedData(t,e,a,n,i),!S.$el.$linkView)return;m.info(t,e,a,n);let s=S.$inst.icon.getIcon(t),r=V.handleLinkShow({ruleKeyName:t,ruleIndex:e,shareCode:a,accessCode:n,matchText:i});if(r&&(this.$inst.dataPaging.changeConfig({data:Tt.generateViewData()}),this.$inst.dataPaging.refresh(this.$inst.dataPaging.CONFIG.data),this.$inst.dataPaging.PAGE_CONFIG.currentPage()===this.$inst.dataPaging.PAGE_CONFIG.maxPage||!this.$data.dataPagingEnable)){let l=this.createBoxItemInfo(s,t,e,a,n,r);this.$el.$urlBoxAll.appendChild(l.$urlBox),te.check({$urlBox:l.$urlBox,ruleKeyName:t,ruleIndex:e,shareCode:a,accessCode:n});}},changeBoxItemView(t,e,a,n,i){if(S.$inst.historyMatch.changeMatchedData(t,e,a,n,i),!S.$el.$linkView)return;const s=V.handleLinkShow({ruleKeyName:t,ruleIndex:e,shareCode:a,accessCode:n,matchText:i});if(!s)return;const r=S.$el.$linkView.$pops.querySelector(`.netdisk-url a[data-sharecode='${a}'][data-rule-index='${e}']`);r&&(m.info("ä¿®æ”¹ç½‘ç›˜é“¾æ¥è§†å›¾"),m.info(r),r.setAttribute("data-accesscode",n),h.html(r,s));},createBoxAttrRuleInfo(t){return {"data-rule-key":t.ruleKeyName,"data-rule-index":t.ruleIndex,"data-sharecode":t.shareCode,"data-accesscode":t.accessCode}},parseBoxAttrRuleInfo(t){let e={ruleKeyName:t.getAttribute("data-rule-key"),ruleIndex:parseInt(t.getAttribute("data-rule-index")),shareCode:t.getAttribute("data-sharecode"),accessCode:t.getAttribute("data-accesscode")};return isNaN(e.ruleIndex)&&(m.warn("å…ƒç´ ä¸Šçš„ ruleIndex çš„å€¼æ˜¯NaNï¼Œè°ƒæ•´ä¸ºé»˜è®¤å€¼0",t),e.ruleIndex=0),e},handleBoxAttrRuleInfo(t,e){let a=this.createBoxAttrRuleInfo(t);for(const n in a){const i=a[n];Array.isArray(e)?e.forEach(s=>{s.setAttribute(n,i.toString());}):e.setAttribute(n,i.toString());}},createBoxItemInfo(t,e,a,n,i,s){let r=h.createElement("div",{className:"netdisk-url-box",innerHTML:`
			<div class="netdisk-url-div">
          <div class="netdisk-icon">
              <div class="netdisk-icon-img"></div>
          </div>
          <div class="netdisk-status"></div>
          <div class="netdisk-url">
              <a  class="netdisk-link" href="javascript:;" isvisited="false"></a>
          </div>
      </div>
			`});const{$urlDiv:l,$icon:o,$iconImg:c,$checkValidStatus:u,$url:d,$link:p}=this.parseBoxItemInfo(r);return c.style.cssText=`background: url(${t}) no-repeat;background-size: 100%;`,h.html(p,s),this.handleBoxAttrRuleInfo({ruleKeyName:e,ruleIndex:a,shareCode:n,accessCode:i},[c,p]),V.$rule.rule.forEach(w=>{w.setting.key===e&&typeof w.afterRenderUrlBox=="function"&&w.afterRenderUrlBox({$viewBox:r,$urlDiv:l,$url:d,$link:p,ruleKeyName:e,ruleIndex:a,shareCode:n,accessCode:i});}),{$urlBox:r,$urlDiv:l,$icon:o,$iconImg:c,$checkValidStatus:u,$url:d,$link:p}},parseBoxItemInfo(t){let e=t.matches(".netdisk-url-box")?t:t.closest(".netdisk-url-box"),a=e.querySelector(".netdisk-url-div"),n=e.querySelector(".netdisk-icon"),i=e.querySelector(".netdisk-icon-img"),s=e.querySelector(".netdisk-status"),r=e.querySelector(".netdisk-url"),l=e.querySelector(".netdisk-link");return {$urlBox:e,$urlDiv:a,$icon:n,$iconImg:i,$checkValidStatus:s,$url:r,$link:l}}},Je={init(){lt.setRightClickMenu(S.$el.$linkView.$shadowRoot,".whitesevPop .netdisk-url a"),this.registerIconGotoPagePosition(S.$el.$linkView.$shadowRoot),this.setNetDiskUrlClickEvent(S.$el.$linkView.$shadowRoot,".netdisk-url a"),lt.setGlobalRightClickMenu(S.$el.$linkView.$shadowRoot.querySelector(".pops .pops-alert-title > p"));},setNetDiskUrlClickEvent(t,e){U.on(t,"click",e,a=>{let n=a.target;n.setAttribute("isvisited","true");const i=fe.parseBoxAttrRuleInfo(n);a.ctrlKey?this.netDiskUrlClickEvent({data:i,clickMode:"openBlank",$click:n}):this.netDiskUrlClickEvent({data:i,$click:n});}),U.on(t,"auxclick",e,(a,n)=>{if(a.button!==1)return;U.preventEvent(a),n.setAttribute("isvisited","true");const i=fe.parseBoxAttrRuleInfo(n);let s=ee.getBlankUrl({ruleKeyName:i.ruleKeyName,ruleIndex:i.ruleIndex,shareCode:i.shareCode,accessCode:i.accessCode});Se.openBlankUrl(s,i.ruleKeyName,i.ruleIndex,i.shareCode,i.accessCode,true);});},netDiskUrlClickEvent(t){const{ruleKeyName:e,ruleIndex:a,shareCode:n,accessCode:i}=t.data,s=t.clickMode??J.function.linkClickMode(t.data.ruleKeyName),r=()=>{if(t.$click){const l=t.$click.closest(".pops");if(l){const o=l.querySelector('.pops-header-control[type="close"]');o&&o.click();}}};if(s==="copy"||s==="copy-closePopup")Se.copy(e,a,n,i),s==="copy-closePopup"&&r();else if(s==="openBlank"||s==="openBlank-closePopup"){const l=ee.getBlankUrl({ruleKeyName:e,ruleIndex:a,shareCode:n,accessCode:i});G.isForwardBlankLink(e)?Se.openBlankWithScheme(e,a,n,i):Se.openBlankUrl(l,e,a,n,i),s==="openBlank-closePopup"&&r();}else s==="parseFile"||s==="parseFile-closePopup"?Se.parseFile(e,a,n,i).then(()=>{s==="parseFile-closePopup"&&r();}):g.error("æœªçŸ¥ç‚¹å‡»åŠ¨ä½œï¼š"+s);},registerContextMenu(t,e,a=[],n="whitesevSuspensionContextMenu"){const i=[];a.forEach(r=>{i.push({text:r.text,callback:r.callback,icon:r?.icon??"",iconIsLoading:r?.iconIsLoading??false,item:r?.item??null});});const s={$target:t,targetSelector:e,data:i,isAnimation:false,className:n,only:true,chileMenuLeftOrRightDistance:-3,childMenuTopOrBottomDistance:-5};K.rightClickMenu(s);},registerIconGotoPagePosition(t){let e,a,n;U.on(t,"click",".whitesevPop .netdisk-icon .netdisk-icon-img",(i,s)=>{let l=s.getAttribute("data-sharecode");if(k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode"].value){if(typeof l!="string"){g.error("è·å–data-sharecodeå±æ€§å¤±è´¥");return}if(n==null?n=l:n!==l&&(m.info(`ä¸Šä¸€ä¸ªæœç´¢ï¼š${n}ï¼Œåˆ‡æ¢è‡³ï¼š${l}`),e=void 0,a=void 0,n=l),e==null&&(e=U.findElementsWithText(document.documentElement,l),a=e.next()),a?.value)if(m.success("å®šä½å…ƒç´ ",a),a.value.nodeType===Node.ELEMENT_NODE&&a.value.getClientRects().length){if(a.value.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].value){let o=a.value.innerText||a.value.textContent,c,u,d;if(o.includes(l)){let p=Array.from(a.value.childNodes).filter(w=>w.nodeType===Node.TEXT_NODE);for(const w of p)if(w.textContent.includes(l)){c=w,u=w.textContent.indexOf(l),d=u+l.length;break}}try{U.setElementSelection(a.value,c,u,d);}catch(p){m.error(p),U.setElementSelection(a.value);}}}else if(a.value.nodeType===Node.TEXT_NODE&&a.value.parentElement.getClientRects().length)if(k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].value){let o=a.value.textContent||a.value.nodeValue,c=a.value,u=o.indexOf(l),d=u+l.length;try{U.setElementSelection(a.value,c,u,d);}catch(w){m.error(w),U.setElementSelection(a.value.parentElement);}let p=globalThis.getSelection();if(p.rangeCount>0){let b=p.getRangeAt(0).getBoundingClientRect(),x=globalThis.scrollY,C=b.top+x-globalThis.innerHeight/2;globalThis.scrollTo({behavior:"smooth",top:C});}else a.value.parentElement.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"});}else try{let o=new Range;o.selectNodeContents(a.value);let c=o.getBoundingClientRect(),u=globalThis.scrollY,d=c.top+u-globalThis.innerHeight/2;globalThis.scrollTo({behavior:"smooth",top:d});}catch(o){m.error(o),a.value.parentElement.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"});}else {m.error("æ— æ³•å®šä½è¯¥å…ƒç´ ä½ç½®",a.value);const o=(a.value.nodeName||a.value.localName||a.value.tagName).toLowerCase();g.error(`æ— æ³•å®šä½è¯¥å…ƒç´ ä½ç½®ï¼Œç±»å‹ï¼š${Ie.escapeHtml("<")}${o}${Ie.escapeHtml(">")}`,{isHTML:true});}if(a=e.next(),a.done){if(!k.smallIconNavgiator["pops-netdisk-icon-click-event-loop-find-sharecode"].value){g.info("å·²ç»å®šä½è‡³æœ€åä¸€ä¸ªå…ƒç´ äº†");return}e=void 0,a=void 0;}}});}};class xa extends ke{async init(e){super.init(e);const{ruleIndex:a,shareCode:n,accessCode:i}=e,s="chengtong";if(a!==3){m.warn("è§£æç«™æš‚æ—¶åªæ”¯æŒå•æ–‡ä»¶è§£æï¼Œéå•æ–‡ä»¶é“¾æ¥çš„ç‚¹å‡»åŠ¨ä½œä¸ºæ–°æ ‡ç­¾é¡µæ‰“å¼€"),Je.netDiskUrlClickEvent({data:{ruleKeyName:s,ruleIndex:a,shareCode:n,accessCode:i},clickMode:"openBlank"});return}let r=ie("chengtong-parse-file-api-host");if(f.isNull(r)){g.error("è¯·å…ˆé…ç½®æ–‡ä»¶è§£ææ¥å£åœ°å€");return}r.endsWith("/")||(r+="/");let l=r+"?file="+n;f.isNotNull(i)&&(l+="&pass="+i),window.open(l,"_blank");}}const Ze={$flag:{isInjectViewerCSS:false},async parseFileMetaInfo(t){const e=await L.get("https://whatslink.info/api/v1/link?url="+t,{headers:{Referer:"https://whatslink.info/"},allowInterceptConfig:false});let a=f.toJSON(e.data.responseText);if(!e.status){if(typeof a.error=="string"&&a.error.trim()!==""){g.error(a.error);return}g.error("è¯·æ±‚å¤±è´¥");return}return a},showFileMetaInfoDialog(t){Ze.$flag.isInjectViewerCSS||(Ze.$flag.isInjectViewerCSS=true,Ie.setGMResourceCSS(ca.Viewer));const e=K.alert({title:{text:"å…ƒæ•°æ®ä¿¡æ¯",position:"center"},content:{text:`
        <div class="wrapper">
          <div class="title">Summary</div>
          <div class="content">
            <div>Resource Name: ${t.name}</div>
            <div>Number of Files: ${t.count}</div>
            <div>Total File Size: ${f.formatByteToSize(t.size)}</div>
            <div>File Type: ${t.type.toLowerCase()}</div>
          </div>
        </div>
        `,html:true},btn:{ok:{enable:false}},width:P.setting.width,height:"auto",style:`
      .pops-alert-content{
          padding: 0 15px;
      }
      .wrapper{
          border: 1px solid #2c3e50;
          margin: 24px 0;
          max-width: 100%;
      }
      .wrapper .title{
          font-size: 18px;
          font-weight: 700;
          padding: 8px 24px;
          border-bottom: 1px solid #2c3e50;
      }
      .wrapper .content{
          padding: 24px;
      }
      .wrapper .image-list{
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
          max-width: 100%;
          overflow-x: hidden;
          overflow-y: auto;
          gap: 12px;
          max-height: 300px;
      }
      .wrapper .image-list .img{
          flex-shrink: 0;
          max-width: 180px;
          max-height: 135px;
          border-radius: 8px;
      }
      .wrapper .image-list .img img{
          width: 100%;
          height: auto;
          cursor: pointer;
      }`}),a=e.$shadowRoot.querySelector(".pops-content"),n=function(i=[],s=0){m.info("å½“å‰æŸ¥çœ‹å›¾ç‰‡çš„ç´¢å¼•ä¸‹æ ‡ï¼š"+s),m.info("å½“å‰æŸ¥çœ‹å›¾ç‰‡çš„åˆ—è¡¨ä¿¡æ¯ï¼š",i);let r="";i.forEach(c=>{r+=`<li><img data-src="${c}" loading="lazy"></li>`;});const l=h.createElement("ul",{innerHTML:r}),o=new na(l,{inline:false,url:"data-src",zIndex:f.getMaxZIndex(1,e.$shadowRoot)+100,hidden:()=>{o.destroy();}});s<0?(s=0,m.warn("imgIndexå°äº0ï¼Œé‡ç½®ä¸º0")):s>i.length-1&&(s=i.length-1,m.warn("imgIndexå¤§äºimgListæœ€å¤§ä¸‹æ ‡ï¼Œé‡ç½®ä¸ºimgListæœ€å¤§ä¸‹æ ‡")),o.view(s),o.zoomTo(1),o.show(),m.success("é¢„è§ˆå›¾ç‰‡");};if(Array.isArray(t.screenshots)){const i=h.createElement("div",{className:"wrapper",innerHTML:`
        <div class="title">Screenshots</div>
        <div class="content">
          <div class="image-list"></div>
        </div>
        `}),s=i.querySelector(".image-list"),r=[];t.screenshots.forEach(l=>{r.push(l.screenshot);const o=h.createElement("div",{className:"img",innerHTML:`
          <img src="${l.screenshot}" alt="img" data-time="${l.time}">
          `});h.append(s,o);}),Reflect.set(s,"data-screenshots",t.screenshots),h.on(i,"click",".image-list .img",(l,o)=>{const c=Array.from(s.children).indexOf(o);n(r,c);}),a.appendChild(i);}}};class Ca extends ke{async init(e){super.init(e);let{ruleIndex:a,shareCode:n,accessCode:i}=e,s=ee.getBlankUrl({ruleKeyName:"ed2k",ruleIndex:a,shareCode:n,accessCode:i}),r=g.loading("æ­£åœ¨è¯·æ±‚Apiä¸­..."),l=await Ze.parseFileMetaInfo(s);r.close(),l&&Ze.showFileMetaInfoDialog(l);}}const Zt={rule:[{link_innerText:"share.feijipan.com/s/([a-zA-Z0-9_-]{7,14})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"share.feijipan.com/s/([a-zA-Z0-9_-]{7,14})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:new RegExp("share.feijipan.com/s/([a-zA-Z0-9_-]{7,14})","gi"),shareCodeNeedRemoveStr:new RegExp("share.feijipan.com/s/","gi"),checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"share.feijipan.com/s/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://share.feijipan.com/s/{#shareCode#}",copyUrl:`https://share.feijipan.com/s/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"å°é£æœºç½‘ç›˜",key:"feijipan",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:true,isForwardBlankLink:true,uri:""}}}},qt={KEY:"feijipan_appToken",set(t){he(this.KEY,t);},get(){return ie(this.KEY)}},va=function(){if(!window.location.hostname.endsWith(".feijipan.com")&&window.location.hostname!=="feijipan.com"||J.function.linkClickMode(Zt.setting.key)!=="parseFile")return;const t=fa.get("appToken");if(t){const e=t.value;m.success("è·å–å°é£æœºç½‘ç›˜çš„appToken: "+e),qt.set(e);}};function me(){return Vt}const Sa="ZGluZ0hhby1kaXNrLWFwcA==",Dt=["T","U","A","B","C","D","E","F","G","H","0","M","N","O","P","X","Y","Z","V","W","Q","1","2","3","4","a","b","c","d","e","5","6","7","8","9","v","w","x","y","z","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","L","R","S","I","J","K"];function Mt(){const t=new Uint8Array(atob(Sa).split("").map(a=>a.charCodeAt(0)));return new TextDecoder("utf-8").decode(t)}const yt={encrypt(t){const e=me().enc.Utf8.parse(Mt()),a=me().enc.Utf8.parse(t);return me().AES.encrypt(a,e,{mode:me().mode.ECB,padding:me().pad.Pkcs7})},decryptBase64(t){var e=me().enc.Utf8.parse(Mt()),a=me().AES.decrypt(t,e,{mode:me().mode.ECB,padding:me().pad.Pkcs7});return me().enc.Utf8.stringify(a).toString()},encryptHex(t){return this.encrypt(t).ciphertext.toString().toUpperCase()},encryptBase64(t){const e=this.encrypt(t);return me().enc.Base64.stringify(e.ciphertext)},decryptHex(t){const e=me().enc.Hex.parse(t),a=me().enc.Base64.stringify(e);return this.decryptBase64(a)},idEncrypt(t){return 111},decodeChar(t){for(let e=0;e<Dt.length;e++)if(t==Dt[e])return e;return  -1}};class Wt extends ke{isVip=false;get uuid(){return ((a=21)=>crypto.getRandomValues(new Uint8Array(a)).reduce((n,i)=>(i&=63,n+=i<36?i.toString(36):i<62?(i-26).toString(36).toUpperCase():i>62?"-":"_",n),""))()}get timestamp(){return yt.encryptHex(new Date().getTime())}get appToken(){return qt.get()}async init(e){if(super.init(e),f.isNull(this.uuid)){g.error("è¯·å…ˆæ‰“å¼€æ­¤é“¾æ¥æ¥è·å–uuid");return}const a=g.loading("æ­£åœ¨è§£æï¼Œè¯·ç¨å..."),n=await this.recommend();if(!n){g.error("è·å–folderIdså¤±è´¥"),a.close();return}if(n&&n.length===0){g.error("æ²¡æœ‰åˆ†äº«æ–‡ä»¶"),a.close();return}m.info("è§£ærecommend: ",n);const i=n[0];i?.map?.isVip&&(this.isVip=true);const s=await this.list(i.folderIds);if(!s){a.close();return}if(!s.length){g.error("æ²¡æœ‰åˆ†äº«æ–‡ä»¶"),a.close();return}if(m.success("è§£ælist: ",s),s.length===1&&s[0].fileType!==2){const r=s[0],l=this.getDownloadUrl(this.shareCode,r.fileId,r.userId);S.$inst.linearChainDialogView.oneFile({title:"å°é£æœºç½‘ç›˜å•æ–‡ä»¶ç›´é“¾",fileName:r.fileName||r.name,fileSize:typeof r.fileSize=="number"?r.fileSize*1024:0,downloadUrl:l,fileUploadTime:r.updTime,fileLatestTime:r.updTime,clickCallBack:()=>{const o=this.checkCanDownloadFile(r.fileSize);if(!o)return o}});}else {a.setText("æ­£åœ¨è§£æå¤šæ–‡ä»¶...");const r=this.getFolderInfo(s,0);m.info("è§£æå®Œæ¯•"),S.$inst.linearChainDialogView.moreFile("å°é£æœºç½‘ç›˜æ–‡ä»¶è§£æ",r);}a.close();}checkCanDownloadFile(e){return typeof e=="number"&&e>512e3&&!this.isVip?(g.error(`éä¼šå‘˜æ— æ³•ä¸‹è½½è¶…è¿‡${f.formatByteToSize(512e3*1024)}çš„æ–‡ä»¶`,{timeout:5e3}),false):true}getRequestParams(e){return {devType:6,devModel:"Chrome",uuid:this.uuid,extra:2,timestamp:this.timestamp,shareId:e,offset:1,limit:110,referer:"https://share.feijipan.com/s/"+e}}getRequestHeaders(){return {Accept:"application/json, text/plain, */*",Origin:"https://share.feijipan.com",Referer:"https://share.feijipan.com/","User-Agent":f.getRandomPCUA(),appToken:this.appToken}}getFolderInfo(e,a){const n=[];return e.forEach(i=>{i.fileType===2?n.push({fileName:i.folderName||i.name,fileSize:0,fileType:"",createTime:new Date(i.updTime).getTime(),latestTime:new Date(i.updTime).getTime(),isFolder:true,index:a,clickEvent:async()=>{const s=await this.list(i.folderId);return s?this.getFolderInfo(s,a+1):[]}}):n.push({fileName:i.fileName||i.name,fileSize:typeof i.fileSize=="number"?i.fileSize*1024:0,fileType:"",createTime:new Date(i.updTime).getTime(),latestTime:new Date(i.updTime).getTime(),isFolder:false,index:a,clickEvent:async()=>{let s=this.getDownloadUrl(this.shareCode,i.fileId,i.userId);return G.isForwardDownloadLink("feijipan")&&(s=G.parseDataToSchemeUri("feijipan",s)),this.checkCanDownloadFile(i.fileSize)?{url:s,autoDownload:true,mode:"aBlank"}:{url:s,autoDownload:false}}});}),n}async recommend(){const e=await L.post("https://api.feijipan.com/ws/recommend/list?"+f.toSearchParamsStr({...this.getRequestParams(this.shareCode),type:0}),{headers:{...this.getRequestHeaders()}});if(!e.status)return;const a=f.toJSON(e.data.responseText);if(a.code!==200){m.error(a);return}if(!Array.isArray(a.list)){m.error(a);return}return a.list}async list(e=""){const a=await L.post("https://api.feijipan.com/ws/share/list?"+f.toSearchParamsStr({...this.getRequestParams(this.shareCode),folderId:e}),{headers:{...this.getRequestHeaders()}});if(!a.status)return;const n=f.toJSON(a.data.responseText);if(n.code!==200){m.error(n);return}if(!Array.isArray(n.list)){m.error("NetDiskParse_Jianguoyun.getFileList: data.list is not array",n);return}return n.list}getDownloadUrl(e,a,n=""){const i=yt.encryptHex(a+"|"+n),s=new Date().getTime(),r=yt.encryptHex(a+"|"+s),l={downloadId:i,enable:1,devType:6,uuid:this.uuid,timestamp:this.timestamp,auth:r,shareId:e},o=f.toSearchParamsStr(l);return m.info("download searchParam: ",{...l,fileId:a,userId:n}),"https://api.feijipan.com/ws/file/redirect?"+o}}class Ra extends ke{errorCode={UnAuthorized:"è¯·å…ˆç™»å½•åšæœäº‘è´¦å·"};async init(e){super.init(e);const{ruleIndex:a,shareCode:n,accessCode:i}=e,s=this,r=g.loading("æ­£åœ¨è§£æï¼Œè¯·ç¨å..."),l=await s.getRequestDownloadParams();if(!l){r.close();return}if(l.isdir){r.setText("æ­£åœ¨è§£æå¤šæ–‡ä»¶...");const o=await s.getFolderInfo(l.hash);if(!o){r.close();return}const c=s.parseMoreFile(o,l.hash,l.name);S.$inst.linearChainDialogView.moreFile("åšæœäº‘æ–‡ä»¶è§£æ",c);}else {r.setText("æ­£åœ¨è·å–ä¸‹è½½é“¾æ¥...");const o=f.formatByteToSize(l.size);let c=await s.getFileLink(l.hash,l.name);if(!c){r.close();return}G.isForwardDownloadLink("jianguoyun")&&(c=G.parseDataToSchemeUri("jianguoyun",c)),m.info(c),S.$inst.linearChainDialogView.oneFile({title:"åšæœäº‘ç›˜å•æ–‡ä»¶ç›´é“¾",fileName:l.name,fileSize:o,downloadUrl:c});}r.close();}parseMoreFile(e,a="",n=""){m.info("è§£æå¤šæ–‡ä»¶ä¿¡æ¯",e);const i=[];return e.forEach(s=>{let r=s.relPath;r.startsWith("/")&&(r=r.replace(/^\//,"")),i.push({fileName:r,fileSize:s.size,fileType:"",createTime:s.mtime,latestTime:s.mtime,isFolder:false,index:0,clickEvent:async()=>{const l=g.loading("æ­£åœ¨è·å–ä¸‹è½½é“¾æ¥...");let o=await this.getDirLink(a,r,s.relPath);if(l.close(),!!o)return g.success("è·å–æˆåŠŸï¼"),G.isForwardDownloadLink("jianguoyun")&&(o=G.parseDataToSchemeUri("jianguoyun",o)),m.info(o),{autoDownload:true,mode:"aBlank",url:o}}});}),i}async getRequestDownloadParams(){const e=this;m.info("è·å–hashå€¼"),g.info("æ­£åœ¨è·å–è¯·æ±‚ä¿¡æ¯");let a=/var[\s]*PageInfo[\s]*=[\s]*{([\s\S]+)};/i;new FormData().append("pd",e.accessCode);let i={url:`https://www.jianguoyun.com/p/${e.shareCode}`,data:e.accessCode===""?void 0:`pd=${e.accessCode}`,responseType:"html",headers:{"Content-Type":"application/x-www-form-urlencoded","User-Agent":f.getRandomPCUA(),Referer:`https://www.jianguoyun.com/p/${e.shareCode}`}},s;if(e.accessCode===""?s=await L.get(i):s=await L.post(i),!s.status)return;let r=s.data;m.info("è¯·æ±‚ä¿¡æ¯"),m.info(r);let l=r.responseText.match(a);if(l){let o=l[l.length-1];o=`({${o}})`,o=window.eval(o),m.info(o);let c=o.name,u=o.size,d=o.hash,p=o.needsPassword,w=o.owner,b=o.isdir,x=o.errorCode;if(c=decodeURIComponent(c),m.success("æ˜¯å¦æ˜¯æ–‡ä»¶å¤¹ ===> "+b),m.success("hash ===> "+d),m.success("name ===> "+c),m.success("size ===> "+u),p&&(e.accessCode==null||e.accessCode==="")){g.error("å¯†ç ä¸æ­£ç¡®!"),S.$inst.newAccessCodeView("å¯†ç ç¼ºå¤±","jianguoyun",e.ruleIndex,e.shareCode,e.accessCode,C=>{e.init({ruleIndex:e.ruleIndex,shareCode:e.shareCode,accessCode:C.accessCode});});return}if(x==="AuthenticationFailed"){g.error("å¯†ç é”™è¯¯"),S.$inst.newAccessCodeView(void 0,"jianguoyun",e.ruleIndex,e.shareCode,e.accessCode,C=>{e.init({ruleIndex:e.ruleIndex,shareCode:e.shareCode,accessCode:C.accessCode});});return}if(d===""||d==null){m.error("hashä¸ºç©ºï¼Œå¯èƒ½æ–‡ä»¶è¢«æ’¤é”€åˆ†äº«äº†"),g.error("æ–‡ä»¶åˆ†äº«å·²è¢«æ’¤é”€");return}if(u==null&&b==false){m.error("æ— sizeï¼Œå¯èƒ½æ–‡ä»¶è¢«åˆ é™¤äº†"),g.error(`â€œ${c}â€æ–‡ä»¶å·²è¢«æ‹¥æœ‰è€…ï¼ˆâ€œ${w}â€ï¼‰åˆ é™¤`);return}else return {name:c,hash:d,size:u,needsPassword:p,owner:w,isdir:b}}else r.responseText.match("å¯¹ä¸èµ·ï¼Œæ‰¾ä¸åˆ°æ‚¨æŒ‡å®šçš„æ–‡ä»¶ã€‚")?(m.error("å•Šå™¢ï¼ (404) å¯¹ä¸èµ·ï¼Œæ‰¾ä¸åˆ°æ‚¨æŒ‡å®šçš„æ–‡ä»¶ã€‚"),g.error("åšæœäº‘: å¯¹ä¸èµ·ï¼Œæ‰¾ä¸åˆ°æ‚¨æŒ‡å®šçš„æ–‡ä»¶ã€‚")):r.responseText.match("å¯¹ä¸èµ·ï¼Œæ‚¨çš„æŸäº›è¾“å…¥ä¸æ­£ç¡®ã€‚")?(m.error("å¯èƒ½è¯¥é“¾æ¥ä¸éœ€è¦è®¿é—®ç æˆ–è€…è®¿é—®ç æœ‰é—®é¢˜"),S.$inst.newAccessCodeView(void 0,"jianguoyun",e.ruleIndex,e.shareCode,e.accessCode,o=>{e.init({ruleIndex:e.ruleIndex,shareCode:e.shareCode,accessCode:o.accessCode});})):(m.error("è·å–PageInfoå¤±è´¥"),g.error("åšæœäº‘: è·å–PageInfoå¤±è´¥"));}async getFileLink(e="",a=""){const n=this;a=encodeURIComponent(a);let i=await L.get({url:`https://www.jianguoyun.com/d/ajax/fileops/pubFileLink?k=${e}&name=${a}&wm=false${n.accessCode===""?"":"&pd="+n.accessCode}&forwin=1&_=${new Date().getTime()}`,responseType:"json",headers:{"User-Agent":f.getRandomPCUA()},allowInterceptConfig:false});if(!i.status){if(f.isNotNull(i.data?.responseText)){let l=f.toJSON(i.data.responseText);m.error("åšæœäº‘",l),l.errorCode==="UnAuthorized"?n.gotoLogin():g.error(l.detailMsg);}else g.error("è¯·æ±‚å¼‚å¸¸");return}let s=i.data;m.info("è¯·æ±‚ä¿¡æ¯",s);let r=f.toJSON(s.responseText);if(m.info("è§£æJSON",r),r.hasOwnProperty("errorCode")){g.error("åšæœäº‘: "+r.detailMsg);return}else {if(r.hasOwnProperty("url"))return r.url;g.error("åšæœäº‘: å¤„ç†ä¸‹è½½é“¾æ¥å¼‚å¸¸");}}async getDirLink(e="",a="",n="/"){const i=this;a=encodeURIComponent(a);let s=await L.get({url:`https://www.jianguoyun.com/d/ajax/dirops/pubDIRLink?k=${e}&dn=${a}&p=${n}&forwin=1&_=${new Date().getTime()}`,responseType:"json",headers:{"User-Agent":f.getRandomPCUA()},allowInterceptConfig:false});if(!s.status){if(f.isNotNull(s.data?.responseText)){let o=f.toJSON(s.data.responseText);m.error("åšæœäº‘",o),o.errorCode==="UnAuthorized"?i.gotoLogin():g.error(o.detailMsg);}else g.error("è¯·æ±‚å¼‚å¸¸");return}let r=s.data;m.info("è¯·æ±‚ä¿¡æ¯",r);let l=f.toJSON(r.responseText);if(m.info(l),l.hasOwnProperty("errorCode")){g.error("åšæœäº‘: "+l.detailMsg);return}else {if(l.hasOwnProperty("url"))return l.url;g.error("åšæœäº‘: å¤„ç†ä¸‹è½½é“¾æ¥å¼‚å¸¸");}}async getFolderInfo(e=""){let a=await L.get({url:`https://www.jianguoyun.com/d/ajax/dirops/pubDIRBrowse?hash=${e}&relPath=%2F&_=${Date.now()}`,responseType:"json",headers:{"User-Agent":f.getRandomPCUA()}});if(!a.status)return;let n=a.data;m.info("è¯·æ±‚ä¿¡æ¯",n);let i=f.toJSON(n.responseText);if(m.info(i),"objects"in i)return i.objects;g.error("åšæœäº‘: å¤„ç†å¤šæ–‡ä»¶ä¿¡æ¯å¼‚å¸¸");}gotoLogin(){K.confirm({title:{text:"æç¤º",position:"center"},content:{text:"è§£æå¤±è´¥ï¼ŒåŸå› ï¼šå½“å‰å°šæœªç™»å½•åšæœäº‘ï¼Œæ˜¯å¦å‰å¾€ç™»å½•ï¼Ÿ"},btn:{reverse:true,position:"end",ok:{text:"å‰å¾€",callback:function(e){window.open("https://www.jianguoyun.com/d/login#from=https%3A%2F%2Fwww.jianguoyun.com%2F","_blank");}}}},S.$config.viewSizeConfig.jianGuoYunLoginTip);}}const we={DEFAULT_HOST_NAME:"www.lanzout.com",MENU_KEY:"lanzou-host-name",get hostname(){return B(this.MENU_KEY,this.DEFAULT_HOST_NAME).value}},Aa=t=>(t=t.replace(/\/\/.+/gi,""),t=t.replace(/\/\*[\s\S\n]+\*\//gi,""),t);class $a extends ke{router={root(e=""){return e.startsWith("/")&&(e=e.replace(/^\//,"")),`https://${we.hostname}/${e}`},root_tp(e=""){return e.startsWith("/")&&(e=e.replace(/^\//,"")),`https://${we.hostname}/tp/${e}`},root_s(e=""){return e.startsWith("/")&&(e=e.replace(/^\//,"")),`https://${we.hostname}/s/${e}`}};regexp={unicode:{match:/[%\u4e00-\u9fa5]+/g,tip:"ä¸­æ–‡é“¾æ¥",isUnicode:false},noFile:{match:/div>æ¥æ™šå•¦...æ–‡ä»¶å–æ¶ˆåˆ†äº«äº†<\/div>/g,tip:"æ¥æ™šå•¦...æ–‡ä»¶å–æ¶ˆåˆ†äº«äº†"},noExists:{match:/div>(æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–å·²åˆ é™¤|æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–è€…å·²è¢«åˆ é™¤)<\/div>/g,tip:"æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–è€…å·²è¢«åˆ é™¤"},linkInValid:{match:/div>æ–‡ä»¶é“¾æ¥å¤±æ•ˆï¼Œè¯·è·å–æ–°é“¾æ¥<\/div>/g,tip:"æ–‡ä»¶é“¾æ¥å¤±æ•ˆï¼Œè¯·è·å–æ–°é“¾æ¥"},needVipToShare:{match:/class="fbox">éä¼šå‘˜.+è¯·å…ˆå¼€é€šä¼šå‘˜/gi,tip:"è¯¥é“¾æ¥ä¸ºéä¼šå‘˜ç”¨æˆ·åˆ†äº«çš„æ–‡ä»¶ï¼Œç›®å‰æ— æ³•ä¸‹è½½"},moreFile:{match:/<span id=\"filemore\" onclick=\"more\(\);\">/g},sign:{match:/var[\s]*(posign|postsign|vidksek|skdklds)[\s]*=[\s]*'(.+?)';/},need_sign:{match:"acw_sc__v2=",tip:"è¯·å…ˆæ‰‹åŠ¨æ‰“å¼€é“¾æ¥ï¼Œç”Ÿæˆacw_sc__v2å‚æ•°"},fileName:{match:/<title>(.*)<\/title>/},fileSize:{match:/<span class=\"mtt\">\((.*)\)<\/span>/},loadDownHost:{match:/var[\s]*(vkjxld)[\s]*=[\s]*'(.+?)'/i},loadDown:{match:/var[\s]*(loaddown|oreferr|spototo|domianload|hyggid)[\s]*=[\s]*'(.+?)'/i},appleDown:{match:/var[\s]*appitem[\s]*=[\s]*'(.+?)'/i},uploadTime:{match:/mt2\"\>æ—¶é—´:<\/span>(.+?)[\s]*<span/i}};async init(e){super.init(e);const{ruleIndex:a,shareCode:n,accessCode:i}=e;this.regexp.unicode.isUnicode=!!n.match(this.regexp.unicode.match);let s=a===1?this.router.root_s(n):this.router.root(n);if(window.location.pathname==="/"+n){const c=new URLSearchParams(window.location.search).get("webpage");c&&(s=s+"?webpage="+c);}const r=g.loading("æ­£åœ¨è§£æï¼Œè¯·ç¨å..."),l=await this.getPageInfo(s);if(!l){r.close();return}if(this.isMoreFile(l)){m.info("å¤šæ–‡ä»¶"),r.setText("æ­£åœ¨è§£æå¤šæ–‡ä»¶...");const o=await this.parseFiles(n,i);if(!o){r.close();return}const c=this.getFolderInfo(this.transformFileInfoToInfoList(n,i,o),0);m.info("é€’å½’å®Œæ¯•"),S.$inst.linearChainDialogView.moreFile("è“å¥äº‘æ–‡ä»¶è§£æ",c);}else {m.info("å•æ–‡ä»¶"),r.setText("æ­£åœ¨è·å–ä¸‹è½½é“¾æ¥...");const o=await this.getFileDownloadInfo(n,i,l);o&&S.$inst.linearChainDialogView.oneFile({title:"è“å¥äº‘å•æ–‡ä»¶ç›´é“¾",fileName:o.fileName,fileSize:o.fileSize,downloadUrl:o.downloadUrl,fileUploadTime:o.fileUploadTime});}r.close();}transformFileInfoToInfoList(e,a,n){return [...n.folders.map(i=>({isFolder:true,fileName:i.folderName,fileSize:0,createTime:"",latestTime:"",shareCode:i.shareCode,accessCode:i.accessCode})),...(n.infos||[]).map(i=>({isFolder:false,fileName:i.name_all,fileSize:i.size,createTime:i.time,latestTime:i.time,shareCode:i.id,accessCode:a}))].filter(i=>i!=null)}getFolderInfo(e,a){let n=[];return e.forEach(i=>{i.isFolder?n.push({fileName:i.fileName,fileSize:0,fileType:"",createTime:i.createTime,latestTime:i.latestTime,isFolder:true,index:a,clickEvent:async()=>{let s=await this.parseFiles(i.shareCode,i.accessCode);return s?this.getFolderInfo(this.transformFileInfoToInfoList(this.shareCode,this.accessCode,s),a+1):[]}}):n.push({fileName:i.fileName,fileSize:i.fileSize,fileType:"",createTime:i.createTime,latestTime:i.latestTime,isFolder:false,index:a,clickEvent:async()=>{const s=this.ruleIndex===1?this.router.root_s(i.shareCode):this.router.root(i.shareCode),r=g.loading("æ­£åœ¨è§£æé“¾æ¥é¡µé¢ä¿¡æ¯..."),l=await this.getPageInfo(s);if(!l){r.close();return}r.setText("æ­£åœ¨è·å–ä¸‹è½½é“¾æ¥...");const o=await this.getFileDownloadInfo(i.shareCode,i.accessCode,l);if(!o){r.close();return}return r.close(),{url:o.downloadUrl,autoDownload:true,mode:"aBlank"}}});}),n}async getFileDownloadInfo(e,a,n){let i;const s=h.toElement(n.responseText,true,true),r=Aa(n.responseText),l=s.querySelector('iframe[class^="ifr"]')||s.querySelector('iframe[class^="n_downlink"]');if(l){const o=l.getAttribute("src");m.error("è¯¥é“¾æ¥éœ€è¦é‡æ–°é€šè¿‡iframeåœ°å€è®¿é—®è·å–ä¿¡æ¯",o);const c=s.querySelector("body div.d > div")?.innerText||s.querySelector("#filenajax")?.innerText||s.querySelector("title")?.textContent?.replace(/ - è“å¥äº‘$/i,"");let u=r.match(/æ–‡ä»¶å¤§å°ï¼š<\/span>(.+?)<br>/i)||s.querySelector("div.n_box div.n_file div.n_filesize")?.innerText||s.querySelector(".d2 table tr td .fileinfo:nth-child(1) .fileinforight")?.innerText,d=r.match(/ä¸Šä¼ æ—¶é—´ï¼š<\/span>(.+?)<br>/i)||s.querySelector("#file[class=''] .n_file_info span.n_file_infos")?.innerText||s.querySelector(".d2 table tr td .fileinfo:nth-child(3) .fileinforight")?.innerText||s.querySelector("#file[class='filter'] .n_file_info span.n_file_infos")?.innerText;u?(Array.isArray(u)&&(u=u[u.length-1]),typeof u=="string"&&(u=u.replaceAll("å¤§å°ï¼š",""))):m.error("è§£ææ–‡ä»¶å¤§å°ä¿¡æ¯å¤±è´¥"),d?(Array.isArray(d)&&(d=d[d.length-1]),d.toString().toLowerCase().startsWith("android")&&(m.error("è§£æå‡ºçš„æ–‡ä»¶ä¸Šä¼ æ—¶é—´ä¿¡æ¯æ˜¯Android/xxxxå¼€å¤´"),d=void 0)):m.error("è§£ææ–‡ä»¶ä¸Šä¼ æ—¶é—´ä¿¡æ¯å¤±è´¥");const p=await this.getLinkByIframe(e,a,o,{fileName:c,fileSize:u,fileUploadTime:d});if(!p)return;i={fileName:c,fileSize:u,downloadUrl:p,fileUploadTime:d};}else {m.warn("è¯¥é¡µé¢ä¸æ˜¯ä½¿ç”¨iframeè·å–é“¾æ¥ï¼Œä½¿ç”¨å…¶å®ƒæ–¹å¼è§£æ");const o=r.match(/'sign':'(.+?)',/i)||r.match(this.regexp.sign.match);let c="",u="";const d=r.match(this.regexp.fileName.match);let p=d?d[d.length-1].trim():"";const w=r.match(this.regexp.fileSize.match)||r.match(/<div class="n_filesize">å¤§å°ï¼š(.+?)<\/div>/i),b=w?w[w.length-1].trim():"",x=r.match(this.regexp.uploadTime.match)||r.match(/<span class="n_file_infos">(.+?)<\/span>/i),C=x?x[x.length-1].trim():"",R=r.match(/[\s]+url[\s]+:[\s]+'\/ajaxm.php\?file=([0-9]+)',/i)||r.match(/\/\/url[\s]+:[\s]+'\/ajaxm.php\?file=([0-9]+)',/i),M=R?R[R.length-1]:"1";if(o){u=o[o.length-1],m.info(`è·å–Sign: ${u}`),f.isNotNull(a)?(m.info("ä¼ å…¥å‚æ•°=>æœ‰å¯†ç "),c=a):m.info("ä¼ å…¥å‚æ•°=>æ— å¯†ç ");const T=await this.getKNDS(),_=await L.post({url:this.router.root("ajaxm.php?file="+M),responseType:"json",headers:{accept:"application/json, text/javascript, */*","Content-Type":"application/x-www-form-urlencoded","User-Agent":f.getRandomAndroidUA(),Origin:"https://"+we.hostname,Referer:this.router.root(e)},data:`action=downprocess&sign=${u}&p=${c}&kd=${T}`});if(!_.status)return;const y=_.data;m.info(y);const v=f.toJSON(y.responseText);let $=`${v.dom}/file/${v.url}`;if(typeof v.url=="string"&&(v.url.startsWith("http")||v.url.startsWith(v.dom))&&($=v.url),v.zt,"å¯†ç ä¸æ­£ç¡®".indexOf(v.inf)!=-1){g.error("å¯†ç ä¸æ­£ç¡®!");const D=await new Promise(N=>{S.$inst.newAccessCodeView(void 0,"lanzou",this.ruleIndex,e,a,H=>{N({accessCode:H.accessCode});},()=>{N(void 0);});});if(!D)return;a=D.accessCode;const E=this.ruleIndex===1?this.router.root_s(e):this.router.root(e),I=await this.getPageInfo(E);return I?await this.getFileDownloadInfo(e,a,I):void 0}else p=v.inf?v.inf:p;i={fileName:p,fileSize:b,fileUploadTime:C,downloadUrl:$};}else {let T=r.match(this.regexp.loadDownHost.match),_=r.match(this.regexp.loadDown.match);const y=r.match(this.regexp.appleDown.match);let v=y[y.length-1];if(f.isNull(_)&&(_=r.match(/var[\s]*(cppat)[\s]*=[\s]*'(.+?)'/i)),f.isNull(T)&&v&&(v=v[v.length-1],T=[v],_=[""],m.success("å¤šæ–‡ä»¶-å½“å‰é“¾æ¥çŒœæµ‹ä¸ºè‹¹æœçš„æ–‡ä»¶",v)),f.isNull(T)){g.error("è“å¥äº‘ç›´é“¾ï¼šè·å–signçš„åŸŸåå¤±è´¥ï¼Œè¯·åé¦ˆå¼€å‘è€…",{timeout:3500});return}if(f.isNull(_)){g.error("è“å¥äº‘ç›´é“¾ï¼šè·å–signå¤±è´¥ï¼Œè¯·åé¦ˆå¼€å‘è€…",{timeout:3500});return}const $=`${T[T.length-1]}${_[_.length-1]}`;i={fileName:p,fileSize:b,fileUploadTime:C,downloadUrl:$};}}return i&&G.isForwardDownloadLink("lanzou")&&(i.downloadUrl=G.parseDataToSchemeUri("lanzou",i.downloadUrl)),i}async getPageInfo(e){const a=await L.get({url:e,headers:{Accept:"*/*","User-Agent":f.getRandomPCUA(),Referer:e},allowInterceptConfig:false});if(!a.status){if(m.error(a),a.type==="ontimeout"){g.error("è¯·æ±‚è¶…æ—¶");return}if(f.isNull(a.data.responseText)){g.error("è¯·æ±‚å¼‚å¸¸");return}this.checkPageCode(a.data)&&g.error("è¯·æ±‚å¤±è´¥ï¼ŒæœªçŸ¥æƒ…å†µ");return}const n=a.data.responseText;if(f.isNull(n)){m.error(a),g.error("è·å–ç½‘é¡µå†…å®¹ä¸ºç©º");return}if(!this.checkPageCode(a.data)){m.error(a);return}return a.data}checkPageCode(e){const a=e.responseText;return a.match(this.regexp.noFile.match)?(g.error(this.regexp.noFile.tip),false):a.match(this.regexp.noExists.match)?(g.error(this.regexp.noExists.tip),false):a.match(this.regexp.needVipToShare.match)?(g.error(this.regexp.needVipToShare.tip),false):a.match(this.regexp.linkInValid.match)?(g.error(this.regexp.linkInValid.tip),false):a.match(this.regexp.need_sign.match)?(g.error(this.regexp.need_sign.tip),false):true}isMoreFile(e){return e.responseText.match(this.regexp.moreFile.match)?(m.info("è¯¥é“¾æ¥ä¸ºå¤šæ–‡ä»¶"),true):(m.info("è¯¥é“¾æ¥ä¸ºå•æ–‡ä»¶"),false)}async parseFiles(e,a){const n=this.ruleIndex===1?this.router.root_s(e):this.router.root(e),i=await this.getPageInfo(n);if(!i)return;const s=i.responseText,r=h.toElement(s,true,true),l=Array.from(r.querySelectorAll("#folder a.mlink[href]")).map(v=>{const $=v.href,E=new URL($).pathname.match(/^\/([0-9a-zA-Z]{5,})/);if(E==null)return;const I=E[E.length-1],H=v.querySelector(".filename")?.firstChild?.textContent||"";return {url:$,shareCode:I,accessCode:a,folderName:H}}).filter(v=>v!=null);let o;const c=s.match(/\'fid\':(.+?),/)[1].replaceAll("'",""),u=s.match(/\'uid\':(.+?),/)[1].replaceAll("'",""),d=1,p=s.match(/\'t\':(.+?),/)[1],w=new RegExp(p+`[\\s]*=[\\s]*('|")(.+?)('|");`),b=s.match(w)[2],x=s.match(/\'k\':(.+?),/)[1],C=new RegExp(x+`[\\s]*=[\\s]*('|")(.+?)('|");`),R=s.match(C)[2],M=e.match(this.regexp.unicode.match)?1:2,T=await this.fileMoreAjax(e,a,{lx:M,fid:c,uid:u,pg:d,t:b,k:R,pwd:a});let _;if(T){m.info("json_dataï¼š",T);const{zt:v,info:$,text:D}=T;if(v!==1)if(v===4)_=D;else if($?.includes("å¯†ç ä¸æ­£ç¡®")){g.error("å¯†ç ä¸æ­£ç¡®!");const E=await new Promise(I=>{S.$inst.newAccessCodeView(void 0,"lanzou",this.ruleIndex,e,a,N=>{I({accssCode:N.accessCode});},()=>{I(void 0);});});return E?await this.parseFiles(e,E.accssCode):void 0}else $?.includes("æ²¡æœ‰äº†")?_="æ²¡æœ‰æ–‡ä»¶äº†":_="æœªçŸ¥é”™è¯¯";Array.isArray(D)&&(o=D);}typeof _=="string"&&m.error(_);const y={folders:l,infos:o};return m.info(y),y}async getLinkByIframe(e,a,n,i){m.info(n,i);let s=this.router.root(n),r=await L.get({url:s,headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","User-Agent":f.getRandomPCUA(),Referer:this.router.root(e)}});if(!r.status)return;let l=r.data;m.info(l);let o=l.responseText,c=o.match(/'websignkey'[\s]*:[\s]*'(.+?)'/i)||o.match(/var[\s]*aihidcms[\s]*=[\s]*'(.*)';/i),u=o.match(/'websign':'(.+?)'/i)||o.match(/var[\s]*ciucjdsdc[\s]*=[\s]*'(.*)';/i),d=o.match(/var[\s]*ajaxdata[\s]*=[\s]*'(.+)';/i),p=o.match(/'sign':[\s]*'(.+)',/i)||o.match(/var[\s]*wp_sign[\s]*=[\s]*'(.*)';/i),w=o.match(/[^//]url[\s]*:[\s]*'(.+?)'[\s]*,/i)||o.match(/url[\s]*:[\s]*'(.+?)'[\s]*,/),b="ajaxm.php",x="",C="",R="",M="",T=await this.getKNDS();if(w?b=w[w.length-1]:g.error("æå–ajaxm.phpçš„å…·ä½“å‚æ•°å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤çš„"+b),c)x=c[c.length-1];else {g.error("ajaxm.phpè¯·æ±‚å‚æ•° websignkey è·å–å¤±è´¥");return}if(u)C=u[u.length-1];else {g.error("ajaxm.phpè¯·æ±‚å‚æ•° websign è·å–å¤±è´¥");return}if(d)R=d[d.length-1];else {g.error("ajaxm.phpè¯·æ±‚å‚æ•° signs è·å–å¤±è´¥");return}if(p)M=p[p.length-1];else {g.error("ajaxm.phpè¯·æ±‚å‚æ•° sign è·å–å¤±è´¥");return}let _={action:"downprocess",websignkey:x||R,signs:R,sign:M,websign:C,kd:T,ves:1};m.success("è¯·æ±‚çš„è·¯å¾„å‚æ•°: "+b),m.success("ajaxm.phpçš„è¯·æ±‚å‚æ•°-> ",_);let y=await L.post(this.router.root(b),{data:f.toSearchParamsStr(_),headers:{Accept:"application/json, text/javascript, */*","Content-Type":"application/x-www-form-urlencoded",Referer:this.router.root(e),"User-Agent":f.getRandomPCUA()}});if(!y.status)return;let v=y.data;m.info(v);let $=f.toJSON(v.responseText),D=`${$.dom}/file/${$.url}`;if($.zt,(await L.get("https://boce.lanosso.com/file/kdns2.js",{allowInterceptConfig:false})).status?m.info("æµ‹è¯•killdns2æˆåŠŸï¼Œä¸æ”¹å˜åŸdownloadUrl"):(D+="&lanosso",m.info("æµ‹è¯•killdns2å¤±è´¥ä½¿ç”¨å‚æ•° lanosso")),m.success("ç›´é“¾",D),"å¯†ç ä¸æ­£ç¡®".indexOf($.inf)!=-1)g.error("å¯†ç ä¸æ­£ç¡®!"),S.$inst.newAccessCodeView(void 0,"lanzou",this.ruleIndex,e,a,I=>{this.init({ruleIndex:this.ruleIndex,shareCode:e,accessCode:I.accessCode});});else return i.fileName=f.isNotNull($.inf)?$.inf:i.fileName,m.info(D),D}async getKNDS(){let e=await L.get("https://down-load.lanrar.com/file/kdns.js",{allowInterceptConfig:false});return e.status&&f.isNotNull(e.data.responseText)?1:0}async fileMoreAjax(e,a,n){const i=f.toFormData({rep:0,up:1,ls:1,...n}),s=this.router.root("filemoreajax.php"),r=await L.post({url:this.router.root("filemoreajax.php"),responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","User-Agent":f.getRandomAndroidUA(),Referer:s},data:i});if(!r.status)return;const l=r.data;return m.info(l),f.toJSON(l.responseText)}}const at={LanZouDiskApp:"lanZouY-disk-app",EncryptList:["Y","y","0","Z","z","N","n","M","I","6","m","W","w","1","X","x","L","l","K","7","k","i","U","u","2","V","v","J","j","8","G","g","F","S","s","3","T","t","H","h","f","E","e","D","Q","q","4","R","r","9","d","a","C","c","B","O","o","5","P","p","b","A"],decodeChar(t){for(let e=0;e<this.EncryptList.length;e++)if(t==this.EncryptList[e])return e;return  -1},idEncrypt(t){let e=1,a=0;if(t!=""&&t.length>4){let n;t=t.substring(3,t.length-1);for(let i=0;i<t.length;i++)n=t.charAt(t.length-i-1),a+=this.decodeChar(n)*e,e*=62;}return a},encrypt(t){const e=He.enc.Utf8.parse(this.LanZouDiskApp),a=He.enc.Utf8.parse(t);return He.AES.encrypt(a,e,{mode:He.mode.ECB,padding:He.pad.Pkcs7})},encryptHex(t){return this.encrypt(t).ciphertext.toString().toUpperCase()}};class _a extends ke{$data={devType:6,devModel:"Chrome",extra:2,type:0,offset:1,limit:60};uuid=void 0;userId=void 0;shareCodeId=void 0;async init(e){super.init(e);const{ruleIndex:a,shareCode:n,accessCode:i}=e;this.shareCodeId=this.getDecodeShareCodeId(n),this.uuid=this.getEncodeUUID();const s=g.loading("æ­£åœ¨è§£æï¼Œè¯·ç¨å..."),r=await this.recommendList(this.$data.devType,this.$data.devModel,this.uuid,this.$data.extra,this.getEncodeTimeStamp(),this.shareCode,this.$data.type,this.$data.offset,this.$data.limit);if(!r||!r.list.length){s.close();return}if(r.list[0]?.map?.userId)this.userId=r.list[0]?.map?.userId;else {s.close(),g.error("è§£æè·å–ã€userIdã€‘ä¸ºç©º");return}if(r.list[0].folderIds==null){m.success("è¯¥é“¾æ¥æ˜¯ å•æ–‡ä»¶");let l=r.list[0].fileList[0],o=this.parseFolderInfo(r.list[0].fileList,0);s.setText("æ­£åœ¨è·å–ä¸‹è½½é“¾æ¥...");let c=await o[0].clickEvent();if(c&&!Array.isArray(c)){let u=c.url;G.isForwardDownloadLink("lanzouyx")&&(u=G.parseDataToSchemeUri("lanzouyx",u)),S.$inst.linearChainDialogView.oneFile({title:"è“å¥äº‘ä¼˜äº«å•æ–‡ä»¶ç›´é“¾",fileName:l.fileName,fileSize:l.fileSize*1024,downloadUrl:u,fileUploadTime:f.formatToTimeStamp(l.updTime),fileLatestTime:f.formatToTimeStamp(l.updTime)});}}else {m.success("è¯¥é“¾æ¥æ˜¯ å¤šæ–‡ä»¶"),s.setText("æ­£åœ¨è§£æå¤šæ–‡ä»¶...");const l=this.parseFolderInfo(r.list[0].fileList,0);m.info("é€’å½’å®Œæ¯•"),S.$inst.linearChainDialogView.moreFile("è“å¥äº‘ä¼˜äº«è§£æ",l);}s.close();}parseFolderInfo(e,a){let n=[];return e.forEach(i=>{i.fileType===2?n.push({fileName:i.folderName,fileSize:0,fileType:"",createTime:new Date(i.updTime).getTime(),latestTime:new Date(i.updTime).getTime(),isFolder:true,index:a,clickEvent:async()=>{const s=this.getEncodeTimeStamp(),r=i.folderId,l=await this.getFolderInfo(this.$data.devType,this.$data.devModel,this.uuid,this.$data.extra,s,this.shareCode,r,this.$data.offset,this.$data.limit);return l&&l.list?this.parseFolderInfo(l.list,a+1):[]}}):n.push({fileName:i.fileName,fileSize:i.fileSize*1024,fileType:"",createTime:new Date(i.updTime).getTime(),latestTime:new Date(i.updTime).getTime(),isFolder:false,index:a,clickEvent:async()=>{const s=i.fileId,r=i.userId||this.userId,l=this.uuid;if(f.isNull(r)){g.error("è·å–ã€userIdã€‘ä¸ºç©º");return}if(f.isNull(l)){g.error("è·å–ã€uuidã€‘ä¸ºç©º");return}const o=g.loading("æ­£åœ¨è·å–ä¸‹è½½é“¾æ¥...");let c=await this.getDownloadFileUrl(...this.getDownloadFileParams(s,r,l));if(o.close(),c)return G.isForwardDownloadLink("lanzouyx")&&(c=G.parseDataToSchemeUri("lanzouyx",c)),{url:c,autoDownload:true,mode:"aBlank"}}});}),n}async recommendList(e=this.$data.devType,a=this.$data.devModel,n="",i=this.$data.extra,s="",r="",l=this.$data.type,o=this.$data.offset,c=this.$data.limit){let u=await L.post(`https://api.ilanzou.com/unproved/recommend/list?${f.toSearchParamsStr({devType:e,devModel:a,uuid:n,extra:i,timestamp:s,shareId:r,code:this.accessCode,type:l,offset:o,limit:c})}`,{headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.ilanzou.com",Referer:"https://www.ilanzou.com/","Sec-Fetch-Site":"same-site",Host:"api.ilanzou.com","User-Agent":f.getRandomPCUA()},responseType:"json"});if(!u.status)return;let d=f.toJSON(u.data.responseText);if(m.success("è·å–é“¾æ¥ä¿¡æ¯ï¼š",d),d.code!==200){g.error("è¯·æ±‚é“¾æ¥ä¿¡æ¯å¤±è´¥");return}if(!d.list.length){g.error("è·å–é“¾æ¥ä¿¡æ¯ä¸ºç©º");return}return d}async getFolderInfo(e=this.$data.devType,a=this.$data.devModel,n="",i=this.$data.extra,s="",r="",l="",o=this.$data.offset,c=this.$data.limit){let u=await L.post(`https://api.ilanzou.com/unproved/share/list?${f.toSearchParamsStr({devType:e,devModel:a,uuid:n,extra:i,timestamp:s,shareId:r,code:this.accessCode,folderId:l,offset:o,limit:c})}`,{headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.ilanzou.com",Referer:"https://www.ilanzou.com/","Sec-Fetch-Site":"same-site",Host:"api.ilanzou.com","User-Agent":f.getRandomPCUA()}});if(!u.status)return;let d=f.toJSON(u.data.responseText);if(m.success("è·å–æ–‡ä»¶åˆ—è¡¨ä¿¡æ¯ï¼š",d),d.code===200)return d;g.error(d.msg);}async getDownloadFileUrl(e="",a=1,n=this.$data.devType,i="",s="",r="",l=this.shareCode){return `https://api.ilanzou.com/unproved/file/redirect?${f.toSearchParamsStr({downloadId:e,enable:a,devType:n,uuid:i,timestamp:s,auth:r,shareId:l})}`}getEncodeUUID(e=21){return ((n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce((i,s)=>(s&=63,i+=s<36?s.toString(36):s<62?(s-26).toString(36).toUpperCase():s>62?"-":"_",i),""))(e)}getDecodeShareCodeId(e){return at.idEncrypt(e)}getEncodeTimeStamp(e=Date.now()){return at.encryptHex(e)}getDownloadFileParams(e,a="",n){let i=Date.now(),s=at.encryptHex(e+"|"+a),r=1,l=this.getEncodeTimeStamp(i),o=at.encryptHex(e+"|"+i);return [s,r,this.$data.devType,n,l,o,this.shareCode]}gotoLogin(){K.confirm({title:{position:"center",text:"è“å¥äº‘ä¼˜äº«"},content:{text:"å¿…é¡»å…ˆåœ¨ã€è“å¥äº‘ä¼˜äº«ã€‘è¿›è¡Œç™»å½•ï¼Œç„¶åç™»å½•æˆåŠŸååˆ·æ–°è·å–å¿…å¤‡çš„ä¸‹è½½å‚æ•°ã€uuidã€‘å’Œã€userIdã€‘ã€‚",html:false},btn:{reverse:true,position:"end",ok:{text:"å‰å¾€",enable:true,callback(){window.open("https://www.ilanzou.com","_blank");}}}},S.$config.viewSizeConfig.tianYiYunLoginTip);}}class Ta extends ke{async init(e){super.init(e);const{ruleIndex:a,shareCode:n,accessCode:i}=e,s=ee.getBlankUrl({ruleKeyName:"magnet",ruleIndex:a,shareCode:n,accessCode:i}),r=g.loading("æ­£åœ¨è¯·æ±‚Apiä¸­..."),l=await Ze.parseFileMetaInfo(s);r.close(),l&&Ze.showFileMetaInfoDialog(l);}}class Da extends ke{shareId=void 0;shareMode=1;code={ShareNotFoundFlatDir:"æŠ±æ­‰ï¼Œè¯¥æ–‡ä»¶çš„åˆ†äº«å¹³é“ºç›®å½•æœªæ‰¾åˆ°",ShareNotFound:"æŠ±æ­‰ï¼Œæ‚¨è®¿é—®çš„é¡µé¢åœ°å€æœ‰è¯¯ï¼Œæˆ–è€…è¯¥é¡µé¢ä¸å­˜åœ¨ã€‚",ShareAuditNotPass:"æŠ±æ­‰ï¼Œè¯¥å†…å®¹å®¡æ ¸ä¸é€šè¿‡",FileNotFound:"æŠ±æ­‰ï¼Œæ–‡ä»¶ä¸å­˜åœ¨",ShareExpiredError:"æŠ±æ­‰ï¼Œæ‚¨è®¿é—®çš„é¡µé¢åœ°å€æœ‰è¯¯ï¼Œæˆ–è€…è¯¥é¡µé¢ä¸å­˜åœ¨",ShareAuditWaiting:"æŠ±æ­‰ï¼Œè¯¥é“¾æ¥å¤„äºå®¡æ ¸ä¸­",ShareInfoNotFound:"æŠ±æ­‰ï¼Œæ‚¨è®¿é—®çš„é¡µé¢åœ°å€æœ‰è¯¯ï¼Œæˆ–è€…è¯¥é¡µé¢ä¸å­˜åœ¨",FileTooLarge:"æŠ±æ­‰ï¼Œæ–‡ä»¶å¤ªå¤§ï¼Œä¸æ”¯æŒä¸‹è½½",InvalidSessionKey:"å¤©ç¿¼äº‘PCç«¯Cookieæœªç”Ÿæˆï¼Œæ˜¯å¦å‰å»ç™»å½•ï¼Ÿ<br />&nbsp;&nbsp;&nbsp;&nbsp;(æ³¨æ„,éœ€è¦å½“å‰æµè§ˆå™¨çš„UAåˆ‡æ¢æˆPCä¸”åœ¨ç™»å½•åè¦ç­‰å¾…è¿›å…¥ä¸ªäººäº‘ç©ºé—´åç”ŸæˆCookieï¼Œä¸æ˜¯æ‰‹æœºç«¯æµè§ˆçš„ä¸ªäººäº‘ç©ºé—´ï¼Œé‚£æ ·ç”Ÿæˆçš„Cookieæ— æ³•ä½¿ç”¨)"};async init(e){super.init(e);let{ruleIndex:a,shareCode:n,accessCode:i}=e,s=await this.getShareInfoByCodeV2(n);if(s){if(m.info("è§£æçš„JSONä¿¡æ¯",s),s.needAccessCode&&f.isNull(this.accessCode)){g.error("å¯†ç ä¸æ­£ç¡®!"),S.$inst.newAccessCodeView(void 0,"tianyiyun",this.ruleIndex,this.shareCode,this.accessCode,r=>{this.init({ruleIndex:this.ruleIndex,shareCode:this.shareCode,accessCode:r.accessCode});});return}if("shareId"in s)this.shareId=s.shareId;else {let r=await this.getShareId(n,i);r&&(this.shareId=r);}if("shareMode"in s&&(this.shareMode=s.shareMode),this.shareId!=null)if(s.isFolder){g.info("æ­£åœ¨é€’å½’æ–‡ä»¶");let r=g.loading("æ­£åœ¨è§£æå¤šæ–‡ä»¶ä¸­ï¼Œè¯·ç¨å..."),l=s.fileId,o=await this.listShareDir(n,i,void 0,void 0,l,l,void 0,this.shareId,void 0,void 0,void 0);if(!o){r.close();return}let c=this.getFolderInfo(n,i,o,0);r.close(),m.info("é€’å½’å®Œæ¯•"),S.$inst.linearChainDialogView.moreFile("å¤©ç¿¼äº‘æ–‡ä»¶è§£æ",c);return}else {let r=await this.getDownloadUrl(this.shareCode,this.accessCode,s.fileId,this.shareId);r&&(G.isForwardDownloadLink("tianyiyun")&&(r=G.parseDataToSchemeUri("tianyiyun",r)),S.$inst.linearChainDialogView.oneFile({title:"å¤©ç¿¼äº‘å•æ–‡ä»¶ç›´é“¾",fileName:s.fileName,fileSize:f.formatByteToSize(s.fileSize),downloadUrl:r,fileUploadTime:s.fileCreateDate,fileLatestTime:s.fileLastOpTime}));}}}async getUserBriefInfo(e){const a=this;let n=await L.get("https://cloud.189.cn/api/portal/v2/getUserBriefInfo.action",{headers:{Accept:"application/json;charset=UTF-8",Referer:"https://cloud.189.cn/web/share?code="+e,"User-Agent":f.getRandomPCUA()},allowInterceptConfig:false});if(m.info(n),!n.status){let s=f.toJSON(n.data.responseText);s.res_code in a.code?g.error(a.code[s.res_code]):g.error("è¯·æ±‚å¼‚å¸¸");return}let i=f.toJSON(n.data.responseText);if(i.res_code===0)return i}async getShareInfoByCodeV2(e){const a=this;let n=await L.post({url:"https://cloud.189.cn/api/open/share/getShareInfoByCodeV2.action",data:`shareCode=${e}`,headers:{Accept:"application/json;charset=UTF-8","Content-Type":"application/x-www-form-urlencoded","User-Agent":f.getRandomPCUA(),"Sign-Type":1,Referer:"https://cloud.189.cn/web/share?code="+e,Origin:"https://cloud.189.cn"},allowInterceptConfig:false});if(!n.status){let r=f.toJSON(n.data.responseText);m.error("è·å–ä¸‹è½½å‚æ•°å¤±è´¥çš„JSONä¿¡æ¯",r),r.res_code in a.code?g.error(a.code[r.res_code]):g.error(r.res_message);return}let i=n.data;m.info(i);let s=f.toJSON(i.responseText);if(s.res_code==0)return s;a.code.hasOwnProperty(s.res_code)?g.error(a.code[s.res_code]):g.error("è·å–FileIdå¤±è´¥");}async getShareId(e,a){let n=await L.get({url:`https://cloud.189.cn/api/open/share/checkAccessCode.action?shareCode=${e}&accessCode=${a}`,headers:{Accept:"application/json;charset=UTF-8","Cache-Control":"no-cache","User-Agent":f.getRandomPCUA(),"Sign-Type":1,Referer:`https://cloud.189.cn/web/share?code=${e}`},responseType:"json"});if(!n.status)return;let i=n.data;m.info(i);let s=f.toJSON(i.responseText);if(s.res_code===0&&"shareId"in s)return s.shareId;g.error("è·å–shareIdå¤±è´¥"),m.info(s);}getNoCacheValue(){let e="";for(let a=0;a<17;a++)e+=f.getRandomValue(1,9);return "0."+e}async getDownloadUrl(e,a,n,i){const s=this;let r=await L.get({url:`https://cloud.189.cn/api/open/file/getFileDownloadUrl.action?fileId=${n}&dt=1&shareId=${i}`,headers:{Accept:"application/json;charset=UTF-8","Cache-Control":"no-cache","User-Agent":f.getRandomPCUA(),Referer:`https://cloud.189.cn/web/share?code=${e}`,"Sign-Type":1},responseType:"json",allowInterceptConfig:false});if(m.info(r),!r.status){let c=f.toJSON(r.data.responseText);c.errorCode==="InvalidSessionKey"?s.gotoLogin(s.code.InvalidSessionKey):c.res_code in s.code?g.error(s.code[c.res_code]):g.error("è¯·æ±‚å¼‚å¸¸");return}let l=r.data,o=f.toJSON(l.responseText);if(m.info(o),o.res_code===0)return o.fileDownloadUrl;o.res_code==="InvalidSessionKey"||o.errorCode==="InvalidSessionKey"?s.gotoLogin(s.code.InvalidSessionKey):s.code.hasOwnProperty(o.res_code)?g.error(s.code[o.res_code]):(g.error("è¯·æ±‚å¤±è´¥"),m.error(l));}gotoLogin(e=""){K.confirm({title:{position:"center",text:"å¤©ç¿¼äº‘"},content:{text:e,html:false},btn:{reverse:true,position:"end",ok:{text:"å‰å¾€",enable:true,callback(){window.open("https://cloud.189.cn/api/portal/loginUrl.action?redirectURL=https://cloud.189.cn/web/main","_blank");}}}},S.$config.viewSizeConfig.tianYiYunLoginTip);}async listShareDir(e,a,n=1,i=60,s,r,l=true,o,c=5,u="lastOpTime",d=true){const p=this,w={pageNum:n,pageSize:i,fileId:s,shareDirFileId:r,isFolder:l,shareId:o,shareMode:this.shareMode,iconOption:c,orderBy:u,descending:d,accessCode:a};let b=await L.get(`https://cloud.189.cn/api/open/share/listShareDir.action?${f.toSearchParamsStr(w)}`,{headers:{Accept:"application/json;charset=UTF-8",Referer:`https://cloud.189.cn/web/share?code=${e}`,"Sign-Type":1,"User-Agent":f.getRandomPCUA()},responseType:"json",allowInterceptConfig:false});if(!b.status){let R=f.toJSON(b.data.responseText);m.error("è§£ææ–‡ä»¶å¤¹ä¿¡æ¯å¤±è´¥",R),R.res_code in p.code?g.error(p.code[R.res_code]):"res_message"in R?g.error(R.res_message):g.error("è§£ææ–‡ä»¶å¤¹ä¿¡æ¯å¤±è´¥");return}let x=b.data;m.info(x);let C=f.toJSON(x.responseText);if(C.res_code==0)return C.fileListAO;p.code.hasOwnProperty(C.res_code)?g.error(p.code[C.res_code]):g.error("è·å–FileIdå¤±è´¥");}getFolderInfo(e,a,n,i=0){let s=[];return n.folderList.forEach(r=>{s.push({fileName:r.name,fileSize:0,fileType:"",createTime:f.formatToTimeStamp(r.createDate),latestTime:f.formatToTimeStamp(r.lastOpTime),isFolder:true,index:i,clickEvent:async()=>{const l=await this.listShareDir(e,a,1,100,r.id,r.id,void 0,this.shareId,void 0,void 0,void 0);return l?this.getFolderInfo(e,a,l,i+1):[]}});}),n.fileList.forEach(r=>{s.push({fileName:r.name,fileSize:r.size,fileType:"",createTime:f.formatToTimeStamp(r.createDate),latestTime:f.formatToTimeStamp(r.lastOpTime),isFolder:false,index:i,clickEvent:async()=>{const l=g.loading("æ­£åœ¨è·å–ä¸‹è½½é“¾æ¥...");let o=await this.getDownloadUrl(e,a,r.id,this.shareId);if(l.close(),o)return G.isForwardDownloadLink("tianyiyun")&&(o=G.parseDataToSchemeUri("tianyiyun",o)),{autoDownload:true,mode:"aBlank",url:o}}});}),s}}const Ma={isSupport_GM_download(){try{return typeof Bt=="function"}catch(t){return m.error(t),false}}};class Ia extends ke{async init(e){super.init(e);const{ruleIndex:a,shareCode:n,accessCode:i}=e,s=g.loading("æ­£åœ¨æ£€æŸ¥æ˜¯å¦å·²ç™»å½•UCç½‘ç›˜...");if(!await this.isLogin()){s.close(),this.gotoLogin("æ£€æµ‹åˆ°å°šæœªç™»å½•UCç½‘ç›˜ï¼Œæ˜¯å¦å‰å»ç™»å½•ï¼Ÿ<br />&nbsp;&nbsp;&nbsp;&nbsp;(æ³¨æ„,éœ€è¦å½“å‰æµè§ˆå™¨çš„UAåˆ‡æ¢æˆPCæ‰æœ‰ç™»å½•é€‰é¡¹)");return}s.setText("æ­£åœ¨è·å–UCç½‘ç›˜çš„stoken...");const l=await this.getStoken(this.shareCode,this.accessCode);if(!l){s.close();return}s.setText("æ­£åœ¨è§£ææ–‡ä»¶åˆ—è¡¨...");const o=await this.getDetail(this.shareCode,this.accessCode,l);if(!o){s.close(),g.error("UCç½‘ç›˜ï¼šè·å–detailå¤±è´¥");return}if(o.length===1&&o[0].dir==false&&o[0].file_type===1){s.setText("æ­£åœ¨è·å–ä¸‹è½½é“¾æ¥...");const c=o[0],u=await this.getDownload(this.shareCode,l,c.fid,c.share_fid_token);if(!u||!u[0].download_url){s.close(),g.error("è·å–å•æ–‡ä»¶download_urlå¤±è´¥");return}S.$inst.linearChainDialogView.oneFile({title:"UCç½‘ç›˜å•æ–‡ä»¶ç›´é“¾",fileName:u[0].file_name,fileSize:f.formatByteToSize(u[0].size),downloadUrl:u[0].download_url,fileUploadTime:f.formatTime(u[0].created_at),fileLatestTime:f.formatTime(u[0].last_update_at),clickCallBack:()=>(this.downloadFile(u[0].file_name,u[0].download_url),false)});}else {m.success("è¯¥é“¾æ¥æ˜¯ å¤šæ–‡ä»¶"),s.setText("æ­£åœ¨è§£æå¤šæ–‡ä»¶...");const c=this.getFolderInfo(o,l,0);m.info("é€’å½’å®Œæ¯•"),S.$inst.linearChainDialogView.moreFile("UCç½‘ç›˜æ–‡ä»¶è§£æ",c);return}s.close();}async isLogin(){const e=await L.get("https://drive.uc.cn/",{headers:{"User-Agent":f.getRandomPCUA()}});if(m.success("åˆ¤æ–­æ˜¯å¦å·²ç™»å½•UCç½‘ç›˜",e),!!e.status)return e.data.finalUrl==="https://drive.uc.cn/list"?"å·²ç™»å½•":false}downloadFile(e,a){if(m.info("è°ƒç”¨ã€GM_downloadã€‘ä¸‹è½½ï¼š",arguments),window.location.hostname==="drive.uc.cn"){window.open(a,"_blank");return}if(!Ma.isSupport_GM_download()){g.error("å½“å‰è„šæœ¬ç¯å¢ƒä¸æ”¯æŒAPI ã€GM_downloadã€‘");return}let n=null,i=false,s=false,r=g.loading("ä¸‹è½½ä¸­...",{showClose:true,onClose(){!i&&typeof n=="function"&&n();}}),l=Bt({url:a,name:e,headers:{Referer:"https://drive.uc.cn/"},onload(){i=true,r.close(),g.success(`ä¸‹è½½ ${e} å·²å®Œæˆ`,{consoleLogContent:true});},onprogress(o){if(typeof o=="object"&&"loaded"in o&&"total"in o&&!s){let u=(o.loaded/o.total*100).toFixed(2);r.setText(`ä¸‹è½½ä¸­...${u}%`),o.loaded===o.total&&(s=true);}},onerror(o){r.close(),m.error("ä¸‹è½½å¤±è´¥errorğŸ‘‰",o),typeof o=="object"&&o.error?g.error(`ä¸‹è½½ ${e} å¤±è´¥æˆ–å·²å–æ¶ˆ åŸå› ï¼š${o.error}`,{timeout:6e3,consoleLogContent:true}):g.error(`ä¸‹è½½ ${e} å¤±è´¥æˆ–å·²å–æ¶ˆ`,{consoleLogContent:true});},ontimeout(){r.close(),g.error(`ä¸‹è½½ ${e} è¯·æ±‚è¶…æ—¶`,{consoleLogContent:true});}});typeof l=="object"&&l!=null&&"abort"in l&&(n=l.abort);}gotoLogin(e=""){K.confirm({title:{position:"center",text:"UCç½‘ç›˜"},content:{text:e,html:false},btn:{reverse:true,position:"end",ok:{text:"å‰å¾€",enable:true,callback(){window.open("https://drive.uc.cn","_blank");}}}},S.$config.viewSizeConfig.tianYiYunLoginTip);}async getStoken(e,a){let n=await L.post("https://pc-api.uc.cn/1/clouddrive/share/sharepage/token?entry=ft&fr=pc&pr=UCBrowser",{data:JSON.stringify({share_for_transfer:true,passcode:a,pwd_id:e}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8","User-Agent":f.getRandomPCUA(),Origin:"https://drive.uc.cn",Referer:"https://drive.uc.cn/"},allowInterceptConfig:false});if(!n.status){let s=f.toJSON(n.data.responseText);m.error("è·å–stokenå¤±è´¥JSONä¿¡æ¯",s),"message"in s?g.error(s.message):g.error("è¯·æ±‚å¼‚å¸¸ï¼Œè·å–stokenå¤±è´¥");return}let i=f.toJSON(n.data.responseText);if(m.info("è·å–stokenï¼š",i),i.code!==0){m.error("è·å–stokenå¤±è´¥",i),g.error("è·å–stokenå¤±è´¥");return}return i.data.stoken}async getDetail(e,a,n,i=0,s=0,r=1,l=50,o=0,c=0,u=1){const d=await L.get(`https://pc-api.uc.cn/1/clouddrive/transfer_share/detail?pr=UCBrowser&fr=h5&pwd_id=${e}&__t=${new Date().getTime()}&passcode=${a}&stoken=${encodeURIComponent(n)}&pdir_fid=${i}&force=${s}&_page=${r}&_size=${l}&_fetch_banner=${o}&_fetch_share=${c}&_fetch_total=${u}&_sort=${encodeURIComponent("file_type:asc,file_name:asc")}`,{headers:{Accept:"application/json, text/plain, */*","User-Agent":f.getRandomPCUA(),Origin:"https://drive.uc.cn",Referer:"https://drive.uc.cn/"}});if(!d.status)return;const p=f.toJSON(d.data.responseText);if(m.info("è·å–detailï¼š",p),p.code!==0){m.error("è·å–detailå¤±è´¥",p),g.error("è·å–detailå¤±è´¥");return}const w=p.metadata;return w&&w._total&&w._total>w._size?await this.getDetail(e,a,n,i,s,r,w._total,o,c,u):p.data.list}async getDownload(e,a,n,i){let s=await L.post("https://pc-api.uc.cn/1/clouddrive/file/download?entry=ft&fr=pc&pr=UCBrowser",{data:JSON.stringify({fids:[n],pwd_id:e,stoken:a,fids_token:[i]}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8","User-Agent":f.getRandomPCUA(),Origin:"https://drive.uc.cn",Referer:"https://drive.uc.cn/"}});if(!s.status)return;let r=f.toJSON(s.data.responseText);if(m.info("è·å–downloadï¼š",r),r.code!==0){m.error("è·å–downloadå¤±è´¥",r),g.error("è·å–downloadå¤±è´¥");return}if(r.data.length===0){m.error("è·å–download detailå¤±è´¥",r),g.error("è·å–download detailå¤±è´¥å¤±è´¥");return}return r.data}getFolderInfo(e,a,n=0){let i=[];return e.forEach(s=>{s.dir==false&&s.file_type===1?i.push({fileName:s.file_name,fileSize:s.size,fileType:"",createTime:s.created_at,latestTime:s.updated_at,isFolder:false,index:n,clickEvent:async()=>{const r=g.loading("æ­£åœ¨è·å–ä¸‹è½½é“¾æ¥...");let l="",o=await this.getDownload(this.shareCode,a,s.fid,s.share_fid_token);if(r.close(),o&&o.length?l=o[0].download_url:l="",s.ban)g.error("æ–‡ä»¶å·²è¢«ç¦æ­¢ä¸‹è½½");else {let c=l;if(G.isForwardDownloadLink("uc")&&(c=G.parseDataToSchemeUri("uc",c)),c===l)this.downloadFile(s.file_name,l);else return {autoDownload:true,mode:"aBlank",url:l}}}}):i.push({fileName:s.file_name,fileSize:s.size,fileType:"",createTime:s.created_at,latestTime:s.updated_at,isFolder:true,index:n,clickEvent:async()=>{if(s.include_items===0)return m.success("é‡Œé¢æ²¡æœ‰æ–‡ä»¶"),[];let r=await this.getDetail(this.shareCode,this.accessCode,a,s.fid);return r?this.getFolderInfo(r,a,n+1):[]}});}),i}}class Ea extends ke{token=void 0;code={1004:"no token",1008:"æ‚¨æ²¡æœ‰æƒé™è®¿é—®",1013:"ç³Ÿç³•ï¼Œæ­¤ä»»åŠ¡å·²è¿‡æœŸé”€æ¯ï¼Œä¸‹æ¬¡è¦è®°å¾—ç»­æœŸ",1066:"å¯¹æ–¹è®¾ç½®çš„ä¸‹è½½ / é¢„è§ˆæ¬¡æ•°å·²ç”¨å®Œ",1088:"ç³Ÿç³•ï¼Œæ‚¨è®¿é—®çš„é¡µé¢ä¸å­˜åœ¨"};async init(e){super.init(e);const{ruleIndex:a,shareCode:n,accessCode:i}=e,s=g.loading("æ­£åœ¨è§£æï¼Œè¯·ç¨å...");if(!await this.getWssToken()){s.close();return}s.setText("æ­£åœ¨è·å–pid...");const l=await this.getPid();if(!l){s.close();return}s.setText("æ­£åœ¨è·å–æ–‡ä»¶åˆ—è¡¨ä¿¡æ¯..."),await this.getFileNList(l.bid,l.pid),s.close();}async getWssToken(){const e=this,a=await L.post("https://www.wenshushu.cn/ap/login/anonymous",{responseType:"json",data:JSON.stringify({dev_info:"{}"}),headers:{Accept:"application/json, text/plain, */*","User-Agent":f.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+e.shareCode}});if(m.success(a),!a.status)return;const n=f.toJSON(a.data.responseText);if(n.code===0)return e.token=n.data.token,n.data.token;n.code in e.code?g.error(e.code[n.code]):g.error("è·å–wsså¤±è´¥");}async getPid(){const e=this,a=await L.post({url:"https://www.wenshushu.cn/ap/task/mgrtask",responseType:"json",data:JSON.stringify({tid:e.shareCode,password:"",ufileid:""}),headers:{Accept:"application/json, text/plain, */*","User-Agent":f.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+e.shareCode,"x-token":e.token}});if(m.success(a),!a.status)return;const n=f.toJSON(a.data.responseText);if(n.code===0)return {bid:n.data.boxid,pid:n.data.ufileid};n.code in e.code?g.error(e.code[n.code]):g.error("è·å–pidå¤±è´¥");}async getFileNList(e,a){const n=this,i=await L.post("https://www.wenshushu.cn/ap/ufile/nlist",{responseType:"json",data:JSON.stringify({start:0,sort:{name:"asc"},bid:e,pid:a,options:{uploader:"true"},size:50}),headers:{Accept:"application/json, text/plain, */*","User-Agent":f.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+n.shareCode,"x-token":n.token}});if(m.success(i),!i.status)return;let s=f.toJSON(i.data.responseText);s.code===0?s.data.fileList[0].type===2?(g.error("è¯¥é“¾æ¥ä¸ºå¤šå±‚çº§æ–‡ä»¶åµŒå¥—ï¼Œè·³è½¬"),Se.openBlankUrl(ee.getBlankUrl({ruleKeyName:"wenshushu",ruleIndex:n.ruleIndex,shareCode:n.shareCode,accessCode:n.accessCode}),"wenshushu",n.ruleIndex,n.shareCode,n.accessCode)):await n.getDownloadUrl(s.data.fileList[0]):s.code in n.code?g.error(n.code[s.code]):g.error("è·å–æ–‡ä»¶ä¿¡æ¯å¤±è´¥");}async getDownloadUrl(e){const a=this,n=e.fname,i=f.formatByteToSize(e.size),s=await L.post("https://www.wenshushu.cn/ap/dl/sign",{responseType:"json",data:JSON.stringify({ufileid:e.fid,consumeCode:0}),headers:{Accept:"application/json, text/plain, */*","User-Agent":f.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+a.shareCode,"x-token":a.token}});if(!s.status)return;m.success(s);const r=f.toJSON(s.data.responseText);if(r.code==0){let l=r.data.url;l===""?g.error("å¯¹æ–¹çš„åˆ†äº«æµé‡ä¸è¶³"):(G.isForwardDownloadLink("wenshushu")&&(l=G.parseDataToSchemeUri("wenshushu",l)),S.$inst.linearChainDialogView.oneFile({title:"æ–‡å”å”å•æ–‡ä»¶ç›´é“¾",fileName:n,fileSize:i,downloadUrl:l}));}else r.data in a.code?g.error(a.code[r.data]):g.error("è·å–ä¸‹è½½é“¾æ¥å¤±è´¥");}}const vt={rule:{baidu:ya,lanzou:$a,lanzouyx:_a,tianyiyun:Da,wenshushu:Ea,_123pan:ba,jianguoyun:Ra,uc:Ia,aliyun:ka,chengtong:xa,magnet:Ta,ed2k:Ca,feijipan:Wt}},La=function(t){window.location.hostname==="pan.baidu.com"&&window.location.pathname==="/share/init"&&window.location.search.startsWith("?surl=")&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.waitNode("div.verify-form #accessCode").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),e.value=t.accessCode,h.emit(e,"input"),ce("div.verify-form #submitBtn")?.click();})),window.location.hostname==="pan.baidu.com"&&window.location.pathname==="/wap/init"&&window.location.search.startsWith("?surl=")&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.waitNode("div.extractWrap div.extract-content div.extractInputWrap.extract input[type=text]").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),e.value=t.accessCode,h.emit(e,"input"),ce("div.extractWrap div.extract-content button.m-button")?.click();}));},Na=function(t){window.location.hostname.match(/lanzou[a-z]{1}.com/gi)&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.waitNode("#pwd").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),e.value=t.accessCode,h.emit(e,"input"),(ce("#passwddiv div.passwddiv-input > div")||e.nextElementSibling)?.click(),ce("#sub")?.click();}),h.waitNode("#f_pwd").then(e=>{f.mutationObserver(e,{config:{attributes:true,attributeFilter:["style"]},callback:(a,n)=>{const i=ce("#f_pwd #pwd");if(!f.isVisible(i)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}n.disconnect(),g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),i.value=t.accessCode,h.emit(i,"input"),ce("#f_pwd #sub")?.click();}});}));},Va=function(t){function e(a,n){let i=0;const s=30,r=setInterval(()=>{if(i++,i>s){m.error("ç»“æŸå¾ªç¯æ£€æŸ¥ï¼Œé€€å‡ºã€‚"),clearInterval(r);return}if(!f.isVisible(a)){m.warn(`ç¬¬ ${i} æ¬¡ï¼šè¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç `);return}n(),clearInterval(r);},500);}window.location.hostname==="cloud.189.cn"&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.waitNode("input#code_txt").then(a=>{e(a,()=>{g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç ");const n=ce(".btn.btn-primary.visit");a.value=t.accessCode,Reflect.set(a,"_value",t.accessCode),h.emit(a,"input"),h.emit(n,"click");});})),window.location.hostname==="h5.cloud.189.cn"&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.waitNode("input.access-code-input").then(a=>{e(a,()=>{g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),a.value=t.accessCode,Reflect.set(a,"_value",t.accessCode),h.emit(a,"input"),h.emit(ce("div.button"),"click");});}));},Ba=function(t){window.location.hostname==="caiyun.139.com"&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.waitNode("#token-input").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),e.value=t.accessCode,h.emit(e,"input"),ce("#homepage div.token div.token-form a").click();}),h.waitNode("#app div.token-form input[type=text]").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),e.value=t.accessCode,h.emit(e,"input"),ce("div.token-form a.btn-token").click();}));},pt={async waitReactPropsToSet(t,e,a){Array.isArray(e)||(e=[e]),Array.isArray(a)||(a=[a]);function n(){let i=null;return typeof t=="string"?i=h.selector(t):typeof t=="function"?i=t():t instanceof HTMLElement&&(i=t),i}typeof t=="string"&&!await h.waitNode(t,1e4)||a.forEach(i=>{typeof i.msg=="string"&&m.info(i.msg);const s=function(){let r=n();if(r==null)return {status:false,isTimeout:true,inst:null,$el:r};const l=f.getReactInstance(r);if(l==null)return {status:false,isTimeout:false,inst:null,$el:r};const o=Array.from(e).findIndex(d=>{const p=l[d];return p?!!i.check(p,r):false}),c=e[o],u=l[c];return {status:o!==-1,isTimeout:false,inst:u,$el:r}};f.waitPropertyByInterval(()=>n(),()=>s().status,250,1e4).then(()=>{const r=s();if(r.status){const l=r.inst;i.set(l,r.$el);}else typeof i.failWait=="function"&&i.failWait(r.isTimeout);});});}},Ua=function(t){(window.location.hostname==="www.aliyundrive.com"||window.location.hostname==="www.alipan.com")&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.onReady(()=>{h.waitAnyNode(["#root input.ant-input[placeholder*='æå–ç ']","#root input[name=pwd][placeholder*='æå–ç ']"]).then(e=>{pt.waitReactPropsToSet(e,["reactProps","reactFiber"],{check(a){return typeof a?.onChange=="function"||typeof a?.memoizedProps?.onChange=="function"},set(a){if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}e.value=t.accessCode,(a?.onChange||a?.memoizedProps?.onChange)({currentTarget:e,target:e}),g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç ");const i=ce('#root button[type="submit"]');if(!i){g.error("æäº¤æŒ‰é’®ä¸å­˜åœ¨");return}i.click();}});});}));},za=function(t){window.location.hostname==="www.123pan.com"&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.onReady(()=>{h.waitAnyNode(["#app .ca-fot input.ant-input[type=text][placeholder*='æå–ç ']","#app .appinput input.ant-input[type=text][placeholder*='æå–ç ']"]).then(e=>{pt.waitReactPropsToSet(e,["reactProps","reactFiber"],{check(a){return typeof a?.onChange=="function"||typeof a?.memoizedProps?.onChange=="function"},set(a){if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}e.value=t.accessCode,(a?.onChange||a?.memoizedProps?.onChange)({currentTarget:e,target:e}),g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç ");const i=e.nextElementSibling;if(!i){g.error("æäº¤æŒ‰é’®ä¸å­˜åœ¨");return}i.click();}});});}));},Fa=function(t){window.location.hostname==="share.weiyun.com"&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.waitNode("#app input.input-txt").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),e.value=t.accessCode,h.emit(e,"input"),h.emit(e,"change"),setTimeout(()=>{ce(".form-item button.btn-main").click();},500);}),h.waitNode(".input-wrap input.pw-input").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),e.value=t.accessCode,h.emit(e,"input"),h.emit(e,"change"),setTimeout(()=>{ce(".pw-btn-wrap button.btn").click();},500);}));},Pa=function(t){window.location.hostname==="pan.xunlei.com"&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.waitNode("#__layout div.pass-input-wrap input.td-input__inner").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç "),e.value=t.accessCode,h.emit(e,"input"),h.emit(e,"change"),setTimeout(()=>{ce("#__layout div.pass-input-wrap button.td-button").click();},500);}),h.waitNode("#__layout div.pass-wrapper input.td-input__inner").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç "),e.value=t.accessCode,h.emit(e,"input"),h.emit(e,"change"),setTimeout(()=>{ce("#__layout div.pass-wrapper button.td-button").click();},500);}));},Oa=function(t){window.location.hostname==="pan.quark.cn"&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.onReady(()=>{h.waitNode("#ice-container input.ant-input[class*=ShareReceive][placeholder*='æå–ç ']").then(e=>{pt.waitReactPropsToSet(e,["reactProps","reactEventHandlers"],{check(a){return typeof a?.onChange=="function"||typeof a?.memoizedProps?.onChange=="function"},set(a){if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}e.value=t.accessCode,(a?.onChange||a?.memoizedProps?.onChange)({currentTarget:e,target:e}),g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç ");}});});}));},Ha=function(t){m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.waitNode("#passcode").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),e.value=t.accessCode,h.emit(e,"input"),ce("#main-content .form-group button.btn[type=button]").click();});},ja=function(t){["115.com","115cdn.com","anxia.com"].includes(window.location.hostname)&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.onReady(()=>{h.waitNode("input[placeholder*='è®¿é—®ç ']",1e4).then(async e=>{if(e){if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),e.value=t.accessCode,h.emit(e,"input"),pt.waitReactPropsToSet(e,"reactProps",{check(a){return typeof a?.onChange=="function"},async set(a,n){const i=a?.onChange;i({target:n}),await f.sleep(800);const s=n.parentElement?.nextElementSibling;s instanceof HTMLButtonElement&&s.click();}});}});}));},Ka=function(t){window.location.hostname.endsWith(".link.yunpan.com")&&(m.success("è‡ªåŠ¨å¡«å†™é“¾æ¥",t),h.waitNode("#extract-bg-container input.pwd-input").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),e.value=t.accessCode,h.emit(e,"input"),ce("#extract-bg-container input.submit-btn")?.click();}),h.waitNode("#extractForm input.pwd-input").then(e=>{if(!f.isVisible(e)){m.error("è¾“å…¥æ¡†ä¸å¯è§ï¼Œä¸è¾“å…¥å¯†ç ");return}g.success("è‡ªåŠ¨å¡«å……è®¿é—®ç "),e.value=t.accessCode,h.emit(e,"input"),ce("#extractForm input.submit-btn")?.click();}));},Xe={key:"tempNetDiskInfo",$data:{netDiskInfo:null,get enable(){return k.features.autoFillAccessCode.value}},init(){if(this.$data.enable){this.$data.netDiskInfo=this.getValue();for(let t=0;t<this.$data.netDiskInfo.length;t++){const e=this.$data.netDiskInfo[t];if(!J.linkClickMode_openBlank.openBlankAutoFilleAccessCode(e.ruleKeyName))continue;let n=e.accessCode;if(n==null||typeof n=="string"&&n.trim()==="")continue;let i=e.shareCode;if(e.ruleKeyName==="baidu"&&i.startsWith("1")&&(i=i.slice(1,i.length)),window.location.href.includes(i)){let r=Xe.netDisk[e.ruleKeyName];typeof r=="function"?(m.success("æˆåŠŸåŒ¹é…åˆ°å¯¹åº”çš„è‡ªåŠ¨å¡«å……è®¿é—®ç çš„ç½‘ç›˜ä¿¡æ¯ï¼š",e),r(e)):m.warn("è‡ªåŠ¨å¡«å……è®¿é—®ç å¤±è´¥ï¼š"+e.ruleKeyName+"ï¼ŒåŸå› ï¼šè¯¥ç½‘ç›˜æœªé€‚é…");break}}}},netDisk:{baidu:La,lanzou:Na,tianyiyun:Va,hecaiyun:Ba,aliyun:Ua,wenshushu:()=>{},nainiu:()=>{},_123pan:za,weiyun:Fa,xunlei:Pa,_115pan:ja,chengtong:Ha,kuake:Oa,jianguoyun:()=>{},onedrive:()=>{},"360yunpan":Ka},setValue(t){he(this.key,t);},addValue(t){let e=t.accessCode;if(e==null||typeof e=="string"&&e.trim()==="")return;let a=this.getValue();a=a.filter(n=>!(n.ruleKeyName===t.ruleKeyName&&n.shareCode===t.shareCode)),a.push(t),this.setValue(a);},getValue(){let t=ie(this.key,[]);return Array.isArray(t)||(t=[t]),t=t.filter(e=>Date.now()-e.time<1440*60*1e3),this.setValue(t),t}},We={replaceText(t,e,a){if(Array.isArray(e))for(const n of e)t=this.replaceText(t,n,a);else typeof e=="string"?t=t.replaceAll(e,a):t=t.replace(e,a);return t}},ee={getBlankUrl(t){let e=t.debugConfig?.config??V.$rule.ruleOption[t.ruleKeyName][t.ruleIndex],a=e.blank;if(t.shareCode&&(a=le.replaceParam(a,{shareCode:t.shareCode}),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: blank","ä½œç”¨: ç”¨äºç‚¹å‡»è·³è½¬çš„é“¾æ¥","å¤‡æ³¨: å¯¹shareCodeè¿›è¡Œå‚æ•°æ›¿æ¢",`ç»“æœ: ${a}`]})),t.accessCode&&t.accessCode!==""?(a=le.replaceParam(a,{accessCode:t.accessCode}),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: blank","ä½œç”¨: ç”¨äºç‚¹å‡»è·³è½¬çš„é“¾æ¥","å¤‡æ³¨: å¯¹accessCodeè¿›è¡Œå‚æ•°æ›¿æ¢",`ç»“æœ: ${a}`]})):(a=We.replaceText(a,V.$extraRule.noAccessCodeRegExp,""),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: å†…ç½®çš„noAccessCodeRegExp","ä½œç”¨: å› accessCodeä¸ºç©ºï¼Œä½¿ç”¨è¯¥æ­£åˆ™å»é™¤ä¸éœ€è¦çš„å­—ç¬¦ä¸²",`ç»“æœ: ${a}`]})),e.paramMatch){let n=V.$match.matchedInfo.get(t.ruleKeyName).get(t.shareCode),s=(t.debugConfig?.matchText||n.matchText).match(e.paramMatch),r={};if(s)for(let l=0;l<s.length;l++)r[`$${l}`]=s[l];a=le.replaceParam(a,r),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: paramMatch","ä½œç”¨: ç”¨äºå¯¹matchTextè¿›è¡Œæå–éœ€è¦çš„å…³é”®å†…å®¹ï¼Œæ›¿æ¢å…³é”®å­—ï¼š{#$1#}ã€{#$2#}...","å‚æ•°: "+JSON.stringify(r,void 0,4),`ç»“æœ: ${a}`]});}return a},getCopyUrlInfo(t){let e=t.debugConfig?.config??V.$rule.ruleOption[t.ruleKeyName][t.ruleIndex],a=e.copyUrl;if(t.shareCode&&(a=le.replaceParam(a,{shareCode:t.shareCode}),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: copyUrl","ä½œç”¨: ç”¨äºå¤åˆ¶åˆ°å‰ªè´´æ¿çš„é“¾æ¥","å¤‡æ³¨: å¯¹shareCodeè¿›è¡Œå‚æ•°æ›¿æ¢",`ç»“æœ: ${a}`]})),t.accessCode&&t.accessCode!==""?(a=le.replaceParam(a,{accessCode:t.accessCode}),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: copyUrl","ä½œç”¨: ç”¨äºå¤åˆ¶åˆ°å‰ªè´´æ¿çš„é“¾æ¥","å¤‡æ³¨: å¯¹accessCodeè¿›è¡Œå‚æ•°æ›¿æ¢",`ç»“æœ: ${a}`]})):(a=We.replaceText(a,V.$extraRule.noAccessCodeRegExp,""),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: å†…ç½®çš„noAccessCodeRegExp","ä½œç”¨: å› accessCodeä¸ºç©ºï¼Œä½¿ç”¨è¯¥æ­£åˆ™å»é™¤ä¸éœ€è¦çš„å­—ç¬¦ä¸²",`ç»“æœ: ${a}`]})),e.paramMatch){let n=V.$match.matchedInfo.get(t.ruleKeyName).get(t.shareCode),s=(t.debugConfig?.matchText||n.matchText).match(e.paramMatch),r={};if(s)for(let l=0;l<s.length;l++)r[`$${l}`]=s[l];a=le.replaceParam(a,r),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: paramMatch","ä½œç”¨: ç”¨äºå¯¹matchTextè¿›è¡Œæå–éœ€è¦çš„å…³é”®å†…å®¹ï¼Œæ›¿æ¢å…³é”®å­—ï¼š{#$1#}ã€{#$2#}...","å‚æ•°: "+JSON.stringify(r,void 0,4),`ç»“æœ: ${a}`]});}return t.debugConfig?.logCallBack?.({status:true,msg:"å¤„ç†å®Œæ¯•çš„copyUrl: "+a}),a}},Se={copy(t,e,a,n,i="å·²å¤åˆ¶"){f.copy(ee.getCopyUrlInfo({ruleKeyName:t,ruleIndex:e,shareCode:a,accessCode:n})).then(s=>{s?g.success(i):g.error("æ‰§è¡Œå¤åˆ¶å¤±è´¥",{consoleLogContent:true});}).catch(()=>{g.error("æ‰§è¡Œå¤åˆ¶å¤±è´¥",{consoleLogContent:true});});},async parseFile(t,e,a,n){m.success("é“¾æ¥è§£æï¼š",JSON.stringify({ruleKeyName:t,ruleIndex:e,shareCode:a,accessCode:n},null,2));const i=vt.rule[t];if(i){const s=new i,r={ruleIndex:e,shareCode:a,accessCode:n??""};s.ruleIndex=r.ruleIndex,s.shareCode=r.shareCode,s.accessCode=r.accessCode,m.info("æ–‡ä»¶è§£æï¼š",r),await s.init(r);}else m.error(`${t} æœªé…ç½®è§£æå‡½æ•°`,[t,e,a,n]),g.error("è¯¥é“¾æ¥æœªé…ç½®è§£æå‡½æ•°");},openBlankUrl(t,e,a,n,i,s=false){m.success(`æ–°æ ‡ç­¾é¡µæ‰“å¼€${s?"ï¼ˆåå°æ‰“å¼€ï¼‰":""}`,JSON.stringify({url:t,ruleKeyName:e,ruleIndex:a,shareCode:n,accessCode:i,isOpenInBackEnd:s},null,2)),Xe.$data.enable&&Xe.addValue({url:t,ruleKeyName:e,ruleIndex:a,shareCode:n,accessCode:i,time:Date.now()}),G.isForwardBlankLink(e)&&(t=G.parseDataToSchemeUri(e,t)),ce("meta[name='referrer']")?.setAttribute("content","no-referrer");let r=()=>{if(s)ia(t,{active:false});else try{const l=window.open(t,"_blank");l&&l.focus();}catch(l){m.error(l,t);const o=h.createElement("a");o.setAttribute("href",t),o.setAttribute("target","_blank"),o.click(),o.remove();}};f.isNotNull(i)&&J.linkClickMode_openBlank.openBlankWithCopyAccessCode(e)?f.copy(i).then(()=>{r();}):r();},openBlankWithScheme(t,e,a,n){m.success("schemeæ–°æ ‡ç­¾é¡µæ‰“å¼€",JSON.stringify({ruleKeyName:t,ruleIndex:e,shareCode:a,accessCode:n},null,2));let i=ee.getBlankUrl({ruleKeyName:t,ruleIndex:e,shareCode:a,accessCode:n});i=G.parseDataToSchemeUri(t,i),window.open(i,"_blank");}},Za={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=ee.getBlankUrl({ruleKeyName:"baidu",ruleIndex:e,shareCode:a,accessCode:n}),s=await L.get(i,{headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36",Host:"pan.baidu.com",Referer:`https://pan.baidu.com/share/init?surl=${a}&pwd=${n}`,"sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',Origin:"https://pan.baidu.com"},...pe}),r=s.data.responseText,l=s.data.finalUrl;return typeof l=="string"&&new URL(l).hostname!=="pan.baidu.com"?{...A.verify,msg:`<a href='${l}' target='_blank' style="color: red;">è§¦å‘ç™¾åº¦å®‰å…¨éªŒè¯</a>`,data:s}:!s.status&&f.isNull(r)?{...A.networkError,data:s}:s.data.finalUrl.includes("404.html")?{...A.networkError,data:s}:r.includes("è¿‡æœŸæ—¶é—´ï¼š")?{...A.success,data:s}:r.includes("è¾“å…¥æå–")?{...A.needAccessCode,data:s}:r.includes("ä¸å­˜åœ¨")||r.includes("å·²å¤±æ•ˆ")?{...A.failed,data:s}:{...A.unknown,data:s}}},qa={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=ee.getBlankUrl({ruleKeyName:"lanzou",ruleIndex:e,shareCode:a,accessCode:n}),s=new URL(i),r=await L.get(i,{headers:{"User-Agent":f.getRandomPCUA(),Host:s.hostname,Origin:s.origin,Referer:i},...pe});if(!r.status&&r.type==="ontimeout")return {...A.networkError,data:r};const l=r.data.responseText;return f.isNull(l)?{...A.failed,data:r,tipMsg:"å“åº”æ•°æ®ä¸ºç©º"}:l.includes("è¾“å…¥å¯†ç ")?{...A.needAccessCode,data:r}:l.includes("æ¥æ™šå•¦")||l.includes("ä¸å­˜åœ¨")||l.includes("div>æ–‡ä»¶é“¾æ¥å¤±æ•ˆï¼Œè¯·è·å–æ–°é“¾æ¥</div>")?{...A.failed,data:r}:r.status?{...A.success,data:r}:{...A.unknown,data:r,tipMsg:r.msg}}},Wa={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=new vt.rule.lanzouyx;i.shareCodeId=i.getDecodeShareCodeId(a);const s=i.getEncodeTimeStamp(),r=i.getEncodeUUID(),l=await L.post(`https://api.ilanzou.com/unproved/recommend/list?${f.toSearchParamsStr({devType:i.$data.devType,devModel:i.$data.devModel,uuid:r,extra:i.$data.extra,timestamp:s,code:n,shareId:a,type:i.$data.type,offset:i.$data.offset,limit:i.$data.limit})}`,{headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.ilanzou.com",Referer:"https://www.ilanzou.com/","Sec-Fetch-Site":"same-site",Host:"api.ilanzou.com","User-Agent":f.getRandomPCUA()},responseType:"json",...pe});if(!l.status)return {...A.networkError,data:l};const o=f.toJSON(l.data.responseText);return m.success("è·å–é“¾æ¥ä¿¡æ¯ï¼š",o),o.code!==200?{...A.networkError,data:o}:o.list.length?{...A.success,data:o}:{...A.failed,data:o}}},Ga={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=await L.post("https://api.cloud.189.cn/open/share/getShareInfoByCodeV2.action",{data:`shareCode=${a}`,headers:{Accept:"application/json;charset=UTF-8","Content-Type":"application/x-www-form-urlencoded","User-Agent":f.getRandomPCUA(),"Sign-Type":1,Referer:"https://cloud.189.cn/web/share?code="+a,Origin:"https://cloud.189.cn"},...pe}),s=i.data.responseText;return !i.status&&f.isNull(s)?{...A.networkError,data:i}:s.includes("ShareInfoNotFound")||s.includes("ShareNotFound")||s.includes("FileNotFound")||s.includes("ShareAuditWaiting")||s.includes("ShareExpiredError")||s.includes("ShareAuditNotPass")?{...A.failed,data:i}:s.includes("needAccessCode")?{...A.needAccessCode,data:i}:{...A.success,data:i}}},Ya={async init(t){const{shareCode:e}=t,a=await L.post("https://api.aliyundrive.com/adrive/v3/share_link/get_share_by_anonymous?share_id="+e,{data:JSON.stringify({share_id:e}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json","User-Agent":f.getRandomPCUA(),Referer:"https://www.aliyundrive.com/",Origin:"https://www.aliyundrive.com"},...pe}),n=f.toJSON(a.data.responseText);return !a.status&&f.isNull(n)?{...A.networkError,data:a}:n.code==="ParamFlowException"||n.code==="NotFound.ShareLink"||n.code==="ShareLink.Cancelled"?{...A.failed,data:n}:n.file_count===0||n.file_infos?.length===0?{...A.failed,data:n}:{...A.success,data:n}}},Ja={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=await L.post("https://www.wenshushu.cn/ap/task/mgrtask",{data:JSON.stringify({tid:a}),headers:{"Content-Type":"application/json","User-Agent":f.getRandomPCUA(),"x-token":"wss:7pmakczzw6i",Host:"www.wenshushu.cn",Origin:"https://www.wenshushu.cn",Referer:ee.getBlankUrl({ruleKeyName:"wenshushu",ruleIndex:e,shareCode:a,accessCode:n})},responseType:"json",...pe});if(!i.status&&f.isNull(i.data.responseText))return {...A.networkError,data:i};const s=f.toJSON(i.data.responseText);return s.code!==0?{...A.failed,data:s}:{...A.success,data:s}}},Xa={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=ee.getBlankUrl({ruleKeyName:"weiyun",ruleIndex:e,shareCode:a,accessCode:n}),s=await L.get(i,{headers:{"User-Agent":f.getRandomPCUA(),Host:"share.weiyun.com",Origin:"https://share.weiyun.com",Referer:i},...pe});if(!s.status&&f.isNull(s.data.responseText))return {...A.networkError,data:s};const r=s.data.responseText;return r.includes("å·²åˆ é™¤")||r.includes("å·²è¢«åˆ é™¤")||r.includes("å·²ç»åˆ é™¤")||r.includes("è¿åç›¸å…³æ³•è§„")||r.includes("å·²è¿‡æœŸ")||r.includes("ç›®å½•æ— æ•ˆ")?{...A.failed,data:s}:r.includes('"need_pwd":1')||r.includes('"pwd":"')&&!r.includes('"pwd":""')?{...A.needAccessCode,data:s}:{...A.success,data:s}}},Qa={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=await L.post("https://xluser-ssl.xunlei.com/v1/shield/captcha/init",{data:JSON.stringify({client_id:"Xqp0kJBXWhwaTpB6",device_id:"925b7631473a13716b791d7f28289cad",action:"get:/drive/v1/share",meta:{package_name:"pan.xunlei.com",client_version:"1.45.0",captcha_sign:"1.fe2108ad808a74c9ac0243309242726c",timestamp:"1645241033384"}}),headers:{"User-Agent":f.getRandomPCUA(),Host:"pan.xunlei.com",Referer:ee.getBlankUrl({ruleKeyName:"xunlei",ruleIndex:e,shareCode:a,accessCode:n}),Origin:"https://pan.xunlei.com"},...pe});if(!i.status&&f.isNull(i.data.responseText))return {...A.networkError,data:i};const r=f.toJSON(i.data.responseText).captcha_token,l=await L.get("https://api-pan.xunlei.com/drive/v1/share?share_id="+a,{headers:{"User-Agent":f.getRandomPCUA(),Host:"pan.xunlei.com",Referer:ee.getBlankUrl({ruleKeyName:"xunlei",ruleIndex:e,shareCode:a,accessCode:n}),Origin:"https://pan.xunlei.com","x-captcha-token":r,"x-client-id":"Xqp0kJBXWhwaTpB6","x-device-id":"925b7631473a13716b791d7f28289cad"},...pe});if(!l.status&&f.isNull(l.data.responseText))return {...A.networkError,data:[i,l]};let o=l.data.responseText;return o.includes("NOT_FOUND")||o.includes("SENSITIVE_RESOURCE")||o.includes("EXPIRED")||o.includes("DELETED")?{...A.failed,data:l}:o.includes("PASS_CODE_EMPTY")?{...A.needAccessCode,data:l}:{...A.success,data:l}}},en={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t;let i=ee.getBlankUrl({ruleKeyName:"chengtong",ruleIndex:e,shareCode:a,accessCode:n}),s=new URL(i),r=s.pathname.split("/")[1].trim(),l="";if(s.pathname==="/"&&s.hash.startsWith("#/d/")&&(r="d"),r==="f"||r==="file")l=`https://webapi.ctfile.com/getfile.php?path=${r}&f=${a}&passcode=${n}&token=0&r=${Math.random()}&ref=`;else if(r==="d"||r==="dir")l=`https://webapi.ctfile.com/getdir.php?path=${r}&d=${a}&folder_id=&passcode=${n}&token=0&r=${Math.random()}&ref=`;else return m.warn("æœªçŸ¥path",[e,a,n]),{...A.unknown,data:null};let o=await L.get(l,{headers:{Host:"webapi.ctfile.com",Origin:"https://url95.ctfile.com",Referer:i,Accept:"application/json, text/javascript, */*; q=0.01","User-Agent":f.getRandomPCUA()},...pe}),c=o.data.responseText;if(!o.status&&f.isNull(c))return {...A.networkError,data:o};let u=f.toJSON(c);return u.code===200?{...A.success,data:u}:u.code===401?{...A.needAccessCode,data:u}:u.code===404||u.code===503||u.code===504?{...A.failed,data:u}:{...A.unknown,data:u}}},tn={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=await L.post("https://drive.quark.cn/1/clouddrive/share/sharepage/token?pr=ucpro&fr=pc",{data:JSON.stringify({pwd_id:a,passcode:""}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8","User-Agent":f.getRandomPCUA(),Origin:"https://pan.quark.cn",Referer:ee.getBlankUrl({ruleKeyName:"kuake",ruleIndex:e,shareCode:a,accessCode:n})},...pe});if(!i.status&&f.isNull(i.data.responseText))return {...A.networkError,data:i};const s=f.toJSON(i.data.responseText);if(s.message.includes("éœ€è¦æå–ç "))return {...A.needAccessCode,data:s};if(s.message.includes("ok")){const r=s.data.stoken,l={pwd_id:a,stoken:r,_fetch_share:1,__t:Date.now()},o=await L.get(`https://drive-h.quark.cn/1/clouddrive/share/sharepage/detail?${f.toSearchParamsStr(l)}`,{headers:{Accept:"application/json, text/plain, */*",Origin:"https://pan.quark.cn",Referer:"https://pan.quark.cn/","User-Agent":f.getRandomPCUA()},...pe});if(!o.status||f.isNull(o.data.responseText))return {...A.networkError,data:o};const c=f.toJSON(o.data.responseText);return c.data.share.status==1?c.data.share.partial_violation?{...A.partialViolation,data:[s,c]}:{...A.success,data:[s,c]}:{...A.failed,data:[s,c]}}else return {...A.failed,data:s}}},an={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=ee.getBlankUrl({ruleKeyName:"jianguoyun",ruleIndex:e,shareCode:a,accessCode:n}),s=await L.get(i,{headers:{"User-Agent":f.getRandomPCUA(),Host:"www.jianguoyun.com",Referer:ee.getBlankUrl({ruleKeyName:"jianguoyun",ruleIndex:e,shareCode:a,accessCode:n}),Origin:"https://www.jianguoyun.com"},...pe}),r=s.data.responseText;return !s.status&&f.isNull(r)?{...A.networkError,data:s}:r.includes("<h1>å•Šå™¢ï¼")?{...A.failed,data:s}:{...A.success,data:s}}},nn={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=ee.getBlankUrl({ruleKeyName:"onedrive",ruleIndex:e,shareCode:a,accessCode:n}),s=new URL(i),r=await L.get(i,{headers:{"User-Agent":f.getRandomPCUA(),Host:s.hostname,Referer:i,Origin:s.origin},...pe});if(!r.status){const o=r.data?.status?.toString();return o==="429"?{...A.networkError,data:r}:o==="404"?{...A.failed,data:r}:{...A.networkError,data:r}}const l=r.data.responseText;if(f.isNotNull(l))try{const c=h.toElement(l,!0,!0).querySelector("title");if(c&&h.html(c).includes("é”™è¯¯"))return {...A.failed,data:r}}catch{}return {...A.success,data:r}}},sn={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i=await L.get("https://drive.uc.cn/s/"+a,{headers:{"User-Agent":f.getRandomAndroidUA(),Host:"drive.uc.cn",Referer:ee.getBlankUrl({ruleKeyName:"uc",ruleIndex:e,shareCode:a,accessCode:n}),Origin:"https://drive.uc.cn"},...pe}),s=i.data.responseText;if(!i.status&&f.isNull(s))return {...A.networkError,data:i};const r=h.toElement(s,true,true);if(r.querySelector(".h5-page-main")){const l=r.querySelector(".h5-page-main"),o=l.textContent||l.innerText;return o.includes("å¤±æ•ˆ")||o.includes("ä¸å­˜åœ¨")||o.includes("è¿è§„")||o.includes("åˆ é™¤")?{...A.failed,data:i}:{...A.unknown,data:i}}else return r.querySelector(".main-body .input-wrap input")?{...A.needAccessCode,data:i}:{...A.success,data:i}}},on={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t;let i=await L.get(`https://webapi.115.com/share/snap?share_code=${a}&offset=0&limit=20&receive_code=&cid=`,{headers:{Accept:"application/json, text/javascript, */*;","User-Agent":f.getRandomPCUA(),Host:"webapi.115.com",Referer:"https://115.com/",Origin:"https://115.com"},...pe});if(!i.status)return f.isNull(i.data.responseText)?{...A.failed,data:i}:{...A.networkError,data:i};let s=f.toJSON(i.data.responseText);if(s.state)return {...A.success,data:s};if(typeof s.error=="string"){if(s.error.includes("è®¿é—®ç "))return {...A.needAccessCode,data:s};if(s.error.includes("é“¾æ¥")||s.error.includes("åˆ†äº«å·²å–æ¶ˆ"))return {...A.failed,data:s}}return {...A.unknown,data:s}}},rn={async init(t){const{ruleIndex:e,shareCode:a,accessCode:n}=t,i="https://www.yunpan.com/lk/surl_"+a,s=await L.get(i,{headers:{"User-Agent":f.getRandomPCUA()},responseType:"json",...pe});if(!s.status&&f.isNull(s.data.responseText))return {...A.networkError,data:s};const l=h.toElement(s.data.responseText,true,true).querySelector(".page-error .error-msg");if(l){const o=h.text(l);return o.includes("åˆ†äº«é“¾æ¥å·²å¤±æ•ˆ")?{...A.failed,data:s}:{...A.unknown,data:s,tipMsg:o}}return {...A.success,data:s}}},ln={async init(t){const e=new Wt,a=await L.post("https://api.feijipan.com/ws/recommend/list?"+f.toSearchParamsStr({...e.getRequestParams(t.shareCode),type:0}),{headers:{...e.getRequestHeaders()}});if(!a.status||f.isNull(a.data.responseText))return {...A.networkError,data:a};const n=f.toJSON(a.data.responseText);if(n.code!==200)return {...A.failed,msg:typeof n.msg=="string"?n.msg:A.failed.msg,data:n};if(!Array.isArray(n.list))return {...A.failed,msg:"listä¸æ˜¯æ•°ç»„ç±»å‹",data:n};if(n.list.length===0)return {...A.failed,msg:"listä¸ºç©º",data:n};const i=n.list[0];return Array.isArray(i.fileList)?i?.fileList?.length===0?{...A.failed,msg:"fileListä¸ºç©º",data:n}:{...A.success,data:n}:{...A.failed,msg:"fileListä¸æ˜¯æ•°ç»„ç±»å‹",data:n}}},cn={baidu:Za,lanzou:qa,lanzouyx:Wa,tianyiyun:Ga,aliyun:Ya,wenshushu:Ja,_123pan:Kt,weiyun:Xa,xunlei:Qa,_115pan:on,chengtong:en,kuake:tn,jianguoyun:an,onedrive:nn,uc:sn,"360yunpan":rn,feijipan:ln},pe={allowInterceptConfig:false,onerror(){},ontimeout(){}},te={$data:{subscribeMap:new Map,subscribeMapConsuming:new Map,checkValidStatusMapCache:new Map},get status(){return A},ruleCheckValidFunction:cn,async check(t){Array.isArray(t)||(t=[t]);for(const a of t){const{ruleKeyName:n}=a;this.$data.subscribeMap.has(n)||this.$data.subscribeMap.set(n,[]),this.$data.subscribeMap.get(n).push(a);}await(async()=>{let a=[];for(const[n,i]of this.$data.subscribeMap.entries())a.push(new Promise(async s=>{if(this.$data.subscribeMapConsuming.get(n)){s(null);return}let l=async()=>{for(let c=0;c<i.length;c++)try{const u=i[c];if(u.$urlBox.parentElement){const{needAwait:d}=await this.checkLinkValidity(u,!1);d&&await f.sleep(250);}i.splice(c,1),c--;}catch(u){m.error(u);}this.$data.subscribeMap.get(n)?.length&&i.length&&await l();};await l(),this.$data.subscribeMapConsuming.delete(n),s(null);}));await Promise.all(a);})();},clearAllDelayCheckLinkValidity(){this.$data.subscribeMap.clear(),this.$data.subscribeMapConsuming.clear();},async checkLinkValidity(t,e){const a={needAwait:false},{$checkValidStatus:n}=fe.parseBoxItemInfo(t.$urlBox);if(this.isViewCheckValid(n)&&!e)return a;this.setCheckStatusElementToolTip(t);const i=t.ruleKeyName;if(!J.function.checkLinkValidity(i))return a;const s=this.ruleCheckValidFunction[t.ruleKeyName];if(!s||s&&typeof s.init!="function")return m.error("è¯¥è§„åˆ™æœªé…ç½®æœ‰æ•ˆæ€§æ ¡éªŒå‡½æ•°",t),a;const r={ruleIndex:t.ruleIndex,shareCode:t.shareCode,accessCode:t.accessCode},l=JSON.stringify(r);let o;if(!e&&te.$data.checkValidStatusMapCache.has(l))o=te.$data.checkValidStatusMapCache.get(l);else {if(A.loading.setView(n,t),o=await s.init(r),a.needAwait=true,!o)return m.error("è¯¥è§„åˆ™çš„æœ‰æ•ˆæ€§éªŒè¯å‡½æ•°çš„è¿”å›å€¼ä¸æ˜¯æœ‰æ•ˆå€¼",[o,t]),a;o.code===A.loading.code||o.code===A.networkError.code||o.code===A.verify.code||o.code===A.unknown.code?te.$data.checkValidStatusMapCache.delete(l):te.$data.checkValidStatusMapCache.set(l,o);}return o.setView(n,t,o.tipMsg),o.data&&Reflect.set(n,"data-httpx-response",o.data),a},setViewAgainCheckClickEvent(t,e){h.off(t,"click",void 0,void 0,void 0,a=>!!a.option.once&&a.callback.toString().includes("this.checkLinkValidity")),h.on(t,"click",()=>{const{$urlBox:a,$link:n}=fe.parseBoxItemInfo(t),i=fe.parseBoxAttrRuleInfo(n),s={$urlBox:a,ruleKeyName:i.ruleKeyName,ruleIndex:i.ruleIndex,shareCode:i.shareCode,accessCode:i.accessCode};this.checkLinkValidity(s,true);},{once:true});},isViewCheckValid(t){return !(!t.hasAttribute("data-check-valid")||t.getAttribute("data-check-valid")==="error")},setViewCheckValid(t,e,a){t.setAttribute("data-check-valid",e),t.setAttribute("data-msg",a),Reflect.set(t,"data-msg",a);},removeViewCheckValid(t){t.removeAttribute("data-check-valid"),t.removeAttribute("data-msg"),Reflect.deleteProperty(t,"data-msg");},isStatusSuccess(t){return Math.floor(t.code/100)===2},getStatusName(t){for(const e of Object.keys(A)){const a=A[e];if(t.code===a.code)return e}},setCheckStatusElementToolTip(t){if(!J.function.checkLinlValidityHoverTip(t.ruleKeyName))return;let a=function(){const{$checkValidStatus:i}=fe.parseBoxItemInfo(t.$urlBox);return i}();if(a.hasAttribute("data-pops-tooltip"))return;a.setAttribute("data-pops-tooltip","true");const n=i=>{let s=Reflect.get(i,"data-msg"),r=i.getAttribute("data-msg");return s??r};z.tooltip({$target:a,className:"github-tooltip",isFixed:true,content(){return n(a)},showBeforeCallBack(){const i=n(a);if(i==null||typeof i=="string"&&i.trim()==="")return  false},zIndex(){const i=f.getMaxZIndex(10),s=z.config.InstanceUtils.getPopsMaxZIndex(10).zIndex;return f.getMaxValue(i,s)+100}});}},A={loading:{code:1,msg:"éªŒè¯ä¸­...",setIcon(t){h.html(t,z.config.iconSVG.loading);},setView(t,e,a){te.setViewCheckValid(t,"loading",a??this.msg),this.setIcon(t);}},success:{code:200,msg:"æœ‰æ•ˆ",setIcon(t){h.html(t,`
				<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
					<path
					fill="currentColor"
					d="M874.119618 149.859922A510.816461 510.816461 0 0 0 511.997 0.00208a509.910462 509.910462 0 0 0-362.119618 149.857842c-199.817789 199.679789-199.817789 524.581447 0 724.260236a509.969462 509.969462 0 0 0 362.119618 149.857842A508.872463 508.872463 0 0 0 874.119618 874.120158c199.836789-199.679789 199.836789-524.581447 0-724.260236zM814.94268 378.210681L470.999043 744.132295a15.359984 15.359984 0 0 1-5.887994 4.095996c-1.751998 1.180999-2.913997 2.362998-5.276994 2.913997a34.499964 34.499964 0 0 1-13.469986 2.914997 45.547952 45.547952 0 0 1-12.897986-2.303998l-4.095996-2.363997a45.291952 45.291952 0 0 1-7.009992-4.095996l-196.902793-193.789796a34.126964 34.126964 0 0 1-10.555989-25.186973c0-9.37399 3.583996-18.74698 9.98399-25.186974a36.429962 36.429962 0 0 1 50.372947 0l169.98382 167.423824L763.389735 330.220732a37.059961 37.059961 0 0 1 50.371947-1.732998 33.647965 33.647965 0 0 1 11.165988 25.186973 35.544963 35.544963 0 0 1-9.98399 24.575974v-0.04z m0 0"></path>
				</svg>
				`);},setView(t,e,a){te.setViewCheckValid(t,"success",a??this.msg),this.setIcon(t),te.setViewAgainCheckClickEvent(t,e);}},networkError:{code:-404,msg:"ç½‘ç»œå¼‚å¸¸",setIcon(t){h.html(t,`
				<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
					<path
					fill="currentColor"
					d="M511.808 692.224c-18.048 0-35.136 3.968-50.432 11.392-25.472 12.416-46.528 33.92-57.792 60.032-5.632 14.144-9.024 29.504-9.024 45.952 0 65.152 52.672 117.824 117.248 117.824 65.28 0 117.952-52.672 117.952-117.824 0-64.64-52.672-117.376-117.952-117.376z m0 178.496c-33.408 0-60.608-27.712-60.608-61.12 0-33.472 27.2-60.672 60.608-60.672s61.248 27.2 61.248 60.672c0 33.472-27.776 61.12-61.248 61.12zM286.784 661.632c3.968 3.392 8.512 5.632 12.992 5.632L438.08 523.328c-60.032 14.72-114.432 49.344-155.328 98.624-9.536 11.84-7.872 30.08 4.032 39.68zM622.912 534.656l-43.008 45.312c45.312 13.056 86.72 40.256 117.376 78.208 5.632 6.784 13.568 10.24 22.08 10.24 6.272 0 12.416-2.24 18.176-6.784 11.904-9.6 13.568-27.84 3.392-39.68-31.808-39.104-72.704-69.12-118.016-87.296zM511.808 391.168c17.024 0 33.408 1.216 49.856 3.456l47.68-49.856c-31.744-6.848-64.064-10.24-97.536-10.24-142.784 0-277.12 63.488-367.232 174.656-10.24 11.904-8.576 30.08 3.904 39.68 5.12 4.48 11.328 6.784 18.176 6.784 7.936 0 15.872-3.968 21.568-10.816 79.872-97.536 197.76-153.664 323.584-153.664zM751.616 400.32l-40.256 41.92c47.04 24.96 89.536 60.032 124.096 102.592 10.24 12.48 27.84 14.208 40.256 3.968 11.968-9.6 13.632-27.84 3.968-39.68-36.16-44.8-79.872-81.088-128.064-108.8zM705.152 244.928l42.56-44.672c-73.664-28.992-153.6-44.224-235.904-44.224-196.672 0-380.864 87.872-505.6 239.744-9.6 12.48-7.872 30.08 3.968 40.256 5.632 3.968 11.904 6.208 18.112 6.208 7.936 0 16.448-3.392 22.144-10.176C163.84 292.608 332.096 212.672 511.808 212.672c66.944 0 132.16 10.752 193.344 32.256zM1017.472 395.776c-40.192-49.92-87.296-92.416-139.456-126.976l-39.68 41.344C889.408 343.04 935.36 383.808 973.888 432c9.6 11.904 27.776 13.568 39.68 3.968 11.84-10.176 14.144-27.712 3.904-40.192zM937.408 104.512c-11.328-10.944-29.312-10.496-40.064 0.832L179.008 854.72c-10.816 11.328-10.496 29.248 0.896 40.064 5.44 5.312 12.48 7.872 19.584 7.872 7.488 0 14.848-2.88 20.416-8.704L938.24 144.576c10.88-11.328 10.496-29.248-0.832-40.064z"></path>
				</svg>
				`);},setView(t,e,a){te.setViewCheckValid(t,"error",a??this.msg),this.setIcon(t),te.setViewAgainCheckClickEvent(t,e);}},verify:{code:-405,msg:"è§¦å‘å®‰å…¨éªŒè¯",setIcon(t){h.html(t,`
				<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
					<path 
						fill="currentColor"
						d="M514.389 1005.60899999c-269.967 0-489.59499999-219.642-489.595-489.59499999S244.42199999 26.405 514.389 26.405 1003.984 246.047 1003.984 516s-219.62800001 489.60899999-489.595 489.60900001z m0-938.24399999C267.00400001 67.365 65.754 268.615 65.754 516s201.264 448.63499999 448.635 448.635S963.024 763.385 963.024 516 761.774 67.365 514.389 67.365z" p-id="9895"></path><path d="M245.993 621.56800001c41.014-8.138 86.112-18.03600001 135.264-29.71000001-0.355 14.145-0.177 26.69199999 0.532 37.65499999-40.318 8.493-82.93 18.92400001-127.836 31.29400001l-7.959-39.23900001z m78.506-261.50200001l-12.206 145.872h53.57500001l13.78999998-178.763H259.249v-36.073h160.727l-16.438 214.821h33.423c-2.471 74.61499999-4.779 135.973-6.895 184.06100002-1.065 53.754-24.399 80.623-70.01399999 80.62299998-19.101 0-41.547-0.53200001-67.36500001-1.598-1.775-13.079-4.06799999-27.047-6.895-41.902 25.46300001 3.181 48.087 4.779 67.898 4.779 24.753 0 37.834-15.033 39.253-45.084 2.11599999-38.898 3.891-87.163 5.31099998-144.807H270.951l16.971-181.945h36.577z m309.248-98.659l-10.076 16.971c42.789 76.03500001 95.833 131.373 159.13 166.025-11.318 14.145-20.685 26.528-28.112 37.13699999-62.231-45.971-112.981-101.30799999-152.235-166.02499998-36.073 64.006-86.466 121.474-151.17000001 172.38699999-6.363-9.18799999-15.21-20.33-26.52799998-33.423 70.369-48.797 124.30000001-113.158 161.77799999-193.086h47.213zM441.194 718.111h191.488c25.46300001-62.942 48.087-128.723 67.89800001-197.318l40.31799999 12.725c-20.862 63.297-42.96699999 124.832-66.301 184.593h93.361v36.60499999H441.19300001v-36.60499999z m27.047-169.73900001l37.137-11.67399999c17.32599998 50.217 31.82600002 94.945 43.5 134.198l-39.253 13.258c-11.674-45.261-25.46300001-90.522-41.383-135.78200001z m27.06099999-91.76399999h218.53500001v36.605H495.30200001v-36.605z m64.17100001 67.885l37.655-10.076c14.854 53.043 27.047 99.369 36.605 138.977l-38.72099999 11.141c-10.254-48.797-22.091-95.477-35.53900001-140.04300001z">
					</path>
				</svg>
				`);},setView(t,e,a){te.setViewCheckValid(t,"verify",a??this.msg),this.setIcon(t),te.setViewAgainCheckClickEvent(t,e);}},failed:{code:0,msg:"å·²å¤±æ•ˆ",setIcon(t){h.html(t,`
				<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
					<path
						fill="currentColor"
						d="M549.044706 512l166.189176-166.249412a26.383059 26.383059 0 0 0 0-36.98447 26.383059 26.383059 0 0 0-37.044706 0L512 475.015529l-166.249412-166.249411a26.383059 26.383059 0 0 0-36.98447 0 26.383059 26.383059 0 0 0 0 37.044706L475.015529 512l-166.249411 166.249412a26.383059 26.383059 0 0 0 0 36.98447 26.383059 26.383059 0 0 0 37.044706 0L512 548.984471l166.249412 166.249411a26.383059 26.383059 0 0 0 36.98447 0 26.383059 26.383059 0 0 0 0-37.044706L548.984471 512zM512 1024a512 512 0 1 1 0-1024 512 512 0 0 1 0 1024z"></path>
				</svg>
				`);},setView(t,e,a){te.setViewCheckValid(t,"failed",a??this.msg),this.setIcon(t),te.setViewAgainCheckClickEvent(t,e);}},needAccessCode:{code:201,msg:"éœ€è¦æå–ç ",setIcon(t){h.html(t,`
				<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
					<path
					fill="currentColor"
					d="M757.810429 373.751333 325.645708 373.751333l0-83.895759c0-103.694687 81.507362-184.922686 185.559183-184.922686 78.121242 0 146.053424 46.74565 173.062568 119.090329 3.865028 10.352789 15.384385 15.609513 25.742291 11.746532 10.351766-3.866051 15.609513-15.390525 11.744485-25.742291C688.844707 121.877815 606.198405 64.918545 511.204891 64.918545c-61.918211 0-119.246895 23.662933-161.423483 66.63156-41.3692 42.142819-64.151066 98.363262-64.151066 158.305469l0 83.895759-20.007683 0c-60.774155 0-110.042255 49.267077-110.042255 110.042255l0 366.139981c0 60.774155 49.267077 110.042255 110.042255 110.042255l492.187769 0c60.775178 0 110.042255-49.267077 110.042255-110.042255L867.852684 483.793588C867.852684 423.01841 818.585607 373.751333 757.810429 373.751333zM827.837318 849.933569c0 38.674834-31.352055 70.02689-70.02689 70.02689L265.62266 919.960459c-38.674834 0-70.02689-31.352055-70.02689-70.02689L195.59577 483.793588c0-38.674834 31.352055-70.02689 70.02689-70.02689l492.187769 0c38.674834 0 70.02689 31.352055 70.02689 70.02689L827.837318 849.933569z"></path>
					<path
					fill="currentColor"
					d="M509.715981 583.832002c-11.048637 0-20.007683 8.959046-20.007683 20.007683l0 110.042255c0 11.048637 8.958022 20.007683 20.007683 20.007683s20.007683-8.958022 20.007683-20.007683L529.723663 603.839685C529.723663 592.790024 520.765641 583.832002 509.715981 583.832002z"></path>
				</svg>
				`);},setView(t,e,a){te.setViewCheckValid(t,"needAccessCode",a??this.msg),this.setIcon(t),te.setViewAgainCheckClickEvent(t,e);}},partialViolation:{code:202,msg:"å­˜åœ¨éƒ¨åˆ†è¿è§„æ–‡ä»¶",setIcon(t){h.html(t,`
				<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
					<path 
					fill="currentColor"
					d="M954.963 810.267L543.112 96.919c-14.07-24.37-49.245-24.37-63.315 0L67.945 810.267c-14.07 24.37 3.518 54.832 31.657 54.832h823.703c28.141 0 45.728-30.463 31.658-54.832zM476.699 306.55c0-19.115 15.64-34.755 34.755-34.755 19.115 0 34.755 15.64 34.755 34.755v281.817c0 19.115-15.64 34.755-34.755 34.755-19.115 0-34.755-15.64-34.755-34.755V306.55z m34.755 445.293c-23.198 0-42.004-18.806-42.004-42.004s18.806-42.004 42.004-42.004c23.198 0 42.004 18.806 42.004 42.004s-18.806 42.004-42.004 42.004z"></path>
				</svg>`);},setView(t,e,a){te.setViewCheckValid(t,"partial-violation",a??this.msg),this.setIcon(t),te.setViewAgainCheckClickEvent(t,e);}},unknown:{code:-200,msg:"æœªçŸ¥æ£€æŸ¥æƒ…å†µ",setIcon(t){h.html(t,`
				<svg viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg">
					<path
					fill="currentColor"
					d="M512.473172 1023.995242A511.814852 511.814852 0 0 1 313.545134 40.351073a512.244696 512.244696 0 0 1 398.855715 943.658633 508.815937 508.815937 0 0 1-199.927677 39.985536z m0-943.658634C274.559237 80.336608 80.629391 274.266455 80.629391 512.18039s193.929846 431.843781 431.843781 431.843781 431.843781-193.929846 431.843781-431.843781S751.386745 80.336608 512.473172 80.336608z"></path>
					<path
					fill="currentColor"
					d="M506.475342 716.10662a39.985535 39.985535 0 0 1-39.985536-39.985535v-76.972156c0-79.971071 64.976495-144.947566 144.947566-144.947565a77.971794 77.971794 0 0 0 0-155.943588H445.4974a56.979388 56.979388 0 0 0-56.979387 56.979388 39.985535 39.985535 0 0 1-79.971071 0c0-74.972879 60.977941-136.950458 136.950458-136.950459h164.940333c86.968539 0 157.942864 70.974325 157.942865 157.942865s-69.974687 157.942864-157.942865 157.942864a64.976495 64.976495 0 0 0-64.976494 64.976495v76.972156a39.985535 39.985535 0 0 1-38.985897 39.985535zM505.475703 742.097218a48.982281 48.982281 0 1 0 48.982281 48.982281 48.982281 48.982281 0 0 0-48.982281-48.982281z"></path>
				</svg>
				`);},setView(t,e,a){te.setViewCheckValid(t,"unknown",a??this.msg),this.setIcon(t),te.setViewAgainCheckClickEvent(t,e);}}},un=function(){},St={init(){Object.keys(St.netDisk).forEach(t=>{this.netDisk[t]();});},netDisk:{_123pan:wa,lanzouyx:un,feijipan:va}},dn={requiredFileMap:new Map,async file(t,e){if(f.isNull(t))return m.error("NetDiskRequire.fileçš„å‚æ•°pathä¸ºç©º",t),false;if(this.requiredFileMap.has(t))return m.warn("NetDiskRequire.fileçš„å‚æ•°pathå·²å¼•å…¥è¿‡",t),true;let a=await L.get(t,e);if(!a.status)return  false;let n=a.data.responseText,i=this.requiredFileMap.get(t);return this.requiredFileMap.set(t,i++),m.info("åŠ è½½jsæ–‡ä»¶",t),ne.eval(`
		let exports = void 0;
		let module = void 0;
		let define = void 0;
		`+n),await f.sleep(300),true}},Gt=t=>({"matchRange-text-before":J.matchRange_text.before(t).toString(),"matchRange-text-after":J.matchRange_text.after(t).toString()}),Yt=t=>({"matchRange-html-before":J.matchRange_html.before(t).toString(),"matchRange-html-after":J.matchRange_html.after(t).toString()});class pn{option;storageApi;constructor(e){this.option=e,this.storageApi=new ze(e.STORAGE_API_KEY);}getAllSubscribe(){return this.storageApi.get(this.option.STORAGE_KEY,[])}getAllSubscribeRule(e=false){let a=this.getAllSubscribe(),n=[];for(let i=0;i<a.length;i++){const s=a[i];if(!(e&&!s.data.enable))for(let r=0;r<s.subscribeData.ruleData.length;r++){const l=s.subscribeData.ruleData[r];e&&!l.setting.enable||(l.subscribeUUID=s.uuid,n.push(l));}}return n}getSubscribe(e){return this.getAllSubscribe().find(n=>n.uuid==e)}getSubscribeRule(e,a){let n=this.getSubscribe(e);if(n)return n.subscribeData.ruleData.find(s=>s.key===a)}deleteAllSubscribe(){this.storageApi.delete(this.option.STORAGE_KEY);}deleteSubscribe(e){let a=typeof e=="string"?e:e.uuid,n=this.getAllSubscribe(),i=n.findIndex(s=>s.uuid===a);return i!==-1&&(n.splice(i,1),this.storageApi.set(this.option.STORAGE_KEY,n)),i!==-1}clearSubscribe(e){let a=typeof e=="string"?e:e.uuid,n=this.getAllSubscribe(),i=n.findIndex(s=>s.uuid===a);return i!==-1?(Array.isArray(n[i].subscribeData.ruleData)?n[i].subscribeData.ruleData.length=0:n[i].subscribeData.ruleData=[],this.storageApi.set(this.option.STORAGE_KEY,n),true):false}addSubscribe(e){let a=false,n=this.getAllSubscribe();return n.findIndex(s=>s.uuid===e.uuid)===-1&&(n.push(e),a=true),a&&this.storageApi.set(this.option.STORAGE_KEY,n),a}updateSubscribe(e){let a=false,n=this.getAllSubscribe(),i=n.findIndex(s=>s.uuid===e.uuid);return i!==-1&&(n[i]=e,a=true),a&&this.storageApi.set(this.option.STORAGE_KEY,n),a}updateSubscribeRule(e,a){let n=false,i=this.getAllSubscribe(),s=i.find(r=>r.uuid===e);if(s){let r=s.subscribeData.ruleData.findIndex(l=>l.key===a.key);r!==-1&&(s.subscribeData.ruleData[r]=a,n=true);}return n&&this.storageApi.set(this.option.STORAGE_KEY,i),true}deleteSubscribeRule(e,a){let n=false,i=typeof a=="string"?a:a.key,s=this.getAllSubscribe(),r=s.findIndex(l=>l.uuid===e);if(r!==-1){let o=s[r].subscribeData.ruleData.findIndex(c=>c.key===i);o!==-1&&(s[r].subscribeData.ruleData.splice(o,1),this.storageApi.set(this.option.STORAGE_KEY,s),n=true);}return n}async getSubscribeInfo(e){let a=await L.get(e,{allowInterceptConfig:false,timeout:1e4,headers:{"User-Agent":f.getRandomPCUA()}});if(!a.status)return m.error(a),{data:null,msg:"è·å–è®¢é˜…ä¿¡æ¯å¤±è´¥"};let n=a.data.responseText,i=f.toJSON(n);return typeof i.title=="string"&&typeof i.version=="number"&&typeof i.lastModified=="number"&&Array.isArray(i.ruleData)?{data:{uuid:f.generateUUID(),subscribeData:i,data:{enable:true,url:e,latestUpdateTime:Date.now(),updateFailedTime:null}},msg:""}:(m.error(i),{data:null,msg:"è®¢é˜…é“¾æ¥çš„å†…å®¹æ ¼å¼ä¸æ­£ç¡®"})}async updateAllSubscribe(){let e=this.getAllSubscribe();for(let a=0;a<e.length;a++){const n=e[a];if(!n.data.enable||typeof n.data.updateFailedTime=="number"&&f.formatTime(n.data.updateFailedTime,"yyyyMMdd")===f.formatTime(Date.now(),"yyyyMMdd")||typeof n.data.latestUpdateTime=="number"&&f.formatTime(Date.now(),"yyyyMMdd")===f.formatTime(n.data.latestUpdateTime,"yyyyMMdd"))continue;let i=await this.getSubscribeInfo(n.data.url),s=false;if(i.data){let r=i.data;r.uuid=n.uuid,r.data=n.data,r.data.latestUpdateTime=Date.now();let l=r.data.title||r.subscribeData.title||r.data.url;n.data.updateFailedTime=null,s=this.updateSubscribe(r),s?m.success(`æ›´æ–°è®¢é˜…æˆåŠŸï¼š${l}`):m.error(`æ›´æ–°è®¢é˜…å¤±è´¥ï¼š${l}`,n);}else m.error("æ›´æ–°è®¢é˜…å¤±è´¥ï¼š"+i.msg,n);s||(n.data.updateFailedTime=Date.now(),this.updateSubscribe(n));}}importSubscribe(e){let a=K.alert({title:{text:"è¯·é€‰æ‹©å¯¼å…¥æ–¹å¼",position:"center"},content:{text:`
                    <div class="btn-control" data-mode="local">æœ¬åœ°å¯¼å…¥</div>
                    <div class="btn-control" data-mode="network">ç½‘ç»œå¯¼å…¥</div>
                    <div class="btn-control" data-mode="clipboard">å‰ªè´´æ¿å¯¼å…¥</div>
                `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(o,c){o.close();}}},mask:{enable:true},drag:true,width:P.info.width,height:P.info.height,style:`
                .btn-control{
                    display: inline-block;
                    margin: 10px;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    cursor: pointer;
                }
				.btn-control:hover{
					color: #409eff;
					border-color: #c6e2ff;
					background-color: #ecf5ff;
				}
            `}),n=a.$shadowRoot.querySelector(".btn-control[data-mode='local']"),i=a.$shadowRoot.querySelector(".btn-control[data-mode='network']"),s=a.$shadowRoot.querySelector(".btn-control[data-mode='clipboard']"),r=o=>{let c=this.getAllSubscribe(),u=[];for(let d=0;d<o.length;d++){const p=o[d];c.findIndex(b=>b.uuid===p.uuid)!==-1||u.push(p);}c=c.concat(u),this.storageApi.set(this.option.STORAGE_KEY,c),g.success(`å…± ${o.length} æ¡è®¢é˜…ï¼Œæ–°å¢ ${u.length} æ¡`),e?.();},l=o=>new Promise(c=>{let u=f.toJSON(o);if(!Array.isArray(u)){m.error(u),g.error("å¯¼å…¥å¤±è´¥ï¼Œæ ¼å¼ä¸ç¬¦åˆï¼ˆä¸æ˜¯æ•°ç»„ï¼‰",{consoleLogContent:true}),c(false);return}if(!u.length){g.error("å¯¼å…¥å¤±è´¥ï¼Œè§£æå‡ºçš„æ•°æ®ä¸ºç©º",{consoleLogContent:true}),c(false);return}let d=u[0];if(!(typeof d.data=="object"&&d.data!=null&&typeof d.subscribeData=="object"&&d.subscribeData!=null&&typeof d.uuid=="string")){g.error("å¯¼å…¥å¤±è´¥ï¼Œè§£æçš„æ ¼å¼ä¸ç¬¦åˆ",{consoleLogContent:true}),c(false);return}r(u),c(true);});h.on(n,"click",o=>{h.preventEvent(o),a.close();let c=h.createElement("input",{type:"file",accept:".json"});h.on(c,["propertychange","input"],u=>{if(!c.files?.length)return;let d=c.files[0],p=new FileReader;p.onload=()=>{l(p.result);},p.readAsText(d,"UTF-8");}),c.click();}),h.on(i,"click",o=>{h.preventEvent(o),a.close();let c=K.prompt({title:{text:"ç½‘ç»œå¯¼å…¥",position:"center"},content:{text:"",placeholder:"è¯·å¡«å†™URL",focus:true},btn:{close:{enable:true,callback(p,w){p.close();}},ok:{text:"å¯¼å…¥",callback:async(p,w)=>{let b=p.text;if(f.isNull(b)){g.error("è¯·å¡«å…¥å®Œæ•´çš„url");return}let x=g.loading("æ­£åœ¨è·å–é…ç½®..."),C=await L.get(b,{allowInterceptConfig:false});if(x.close(),!C.status){m.error(C),g.error("è·å–é…ç½®å¤±è´¥",{consoleLogContent:true});return}await l(C.data.responseText)&&p.close();}},cancel:{enable:false}},mask:{enable:true},drag:true,width:P.info.width,height:"auto"}),u=c.$shadowRoot.querySelector("input"),d=c.$shadowRoot.querySelector(".pops-prompt-btn-ok");h.on(u,["input","propertychange"],p=>{h.val(u)===""?h.attr(d,"disabled","true"):h.removeAttr(d,"disabled");}),h.onKeyboard(u,"keydown",(p,w,b)=>{p==="Enter"&&b.length===0&&h.val(u)!==""&&h.emit(d,"click");}),h.emit(u,"input");}),h.on(s,"click",async o=>{h.preventEvent(o),a.close();let c=await f.getClipboardInfo();if(c.error!=null){g.error(c.error.toString());return}if(c.content.trim()===""){g.warning("è·å–åˆ°çš„å‰ªè´´æ¿å†…å®¹ä¸ºç©º");return}await l(c.content);});}exportSubscribe(e="rule.json"){let a=K.alert({title:{text:"è¯·é€‰æ‹©å¯¼å‡ºæ–¹å¼",position:"center"},content:{text:`
                    <div class="btn-control" data-mode="only-export-rule-list">å¯¼å‡ºè®¢é˜…</div>
                `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(s,r){s.close();}}},mask:{enable:true},drag:true,width:P.info.width,height:P.info.height,style:`
                .btn-control{
                    display: inline-block;
                    margin: 10px;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    cursor: pointer;
                }
				.btn-control:hover{
					color: #409eff;
					border-color: #c6e2ff;
					background-color: #ecf5ff;
				}
            `}),n=a.$shadowRoot.querySelector(".btn-control[data-mode='only-export-rule-list']"),i=(s,r)=>{let l=new Blob([JSON.stringify(r,null,4)]),o=window.URL.createObjectURL(l),c=document.createElement("a");c.href=o,c.download=s,c.click(),setTimeout(()=>{window.URL.revokeObjectURL(o);},1500);};h.on(n,"click",s=>{h.preventEvent(s);try{let r=this.getAllSubscribe();if(r.length===0){g.warning("è®¢é˜…ä¸ºç©ºï¼Œæ— éœ€å¯¼å‡º");return}i(e,r),a.close();}catch(r){g.error(r.toString(),{consoleLogContent:true});}});}}const ae=new pn({STORAGE_API_KEY:"userRule",STORAGE_KEY:"rule-subscribe"}),hn=`.whitesevPopNetDiskHistoryMatch .pops-confirm-content {
  display: flex;
  flex-direction: column;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content ul {
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content li {
  display: flex;
  flex-direction: column;
  justify-content: center;
  border-radius: 10px;
  box-shadow:
    0 0.3px 0.6px rgb(0 0 0 / 6%),
    0 0.7px 1.3px rgb(0 0 0 / 8%),
    0 1.3px 2.5px rgb(0 0 0 / 10%),
    0 2.2px 4.5px rgb(0 0 0 / 12%),
    0 4.2px 8.4px rgb(0 0 0 / 14%),
    0 10px 20px rgb(0 0 0 / 20%);
  margin: 20px 10px;
  padding: 10px;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-search {
  /*height: 11%;*/
  flex: 0;
  padding: 5px 0px;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-table {
  /*height: calc(85% - 40px);*/
  overflow: auto;
  flex: 1;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-page {
  display: flex;
  justify-content: center;
  align-items: center;
  /*margin-top: 10px;*/
  flex: 0;
  padding: 5px 0px;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-search input {
  border: none;
  border-bottom: 1px solid #000000;
  padding: 0px 5px;
  line-height: normal;
  width: -moz-available;
  width: -webkit-fill-available;
  width: fill-available;
  margin: 5px 5px 0px 5px;
  background: none;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-search input:focus-visible {
  outline: none;
  border-bottom: 1px solid #0009ff;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link {
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link a {
  color: #ff4848;
  font-size: 0.8em;
  border: none;
  word-break: break-word;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link a[isvisited="true"] {
  color: #8b8888;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-icon {
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-icon .netdisk-icon-img {
  width: 28px;
  height: 28px;
  min-width: 28px;
  min-height: 28px;
  font-size: 0.8em;
  border-radius: 10px;
  box-shadow:
    0 0.3px 0.6px rgb(0 0 0 / 6%),
    0 0.7px 1.3px rgb(0 0 0 / 8%),
    0 1.3px 2.5px rgb(0 0 0 / 10%),
    0 2.2px 4.5px rgb(0 0 0 / 12%),
    0 4.2px 8.4px rgb(0 0 0 / 14%),
    0 10px 20px rgb(0 0 0 / 20%);
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url {
  color: #000;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-top-url {
  color: #000;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-functions button.btn-delete {
  background: #263cf3;
  color: #fff;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-functions button.btn-delete:active {
  background: #6e7be8;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-icon,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-top-url,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-add-time,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-update-time,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url-title,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-functions {
  display: flex;
  margin: 5px 0px;
}
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link p,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-icon p,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url p,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-top-url p,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-add-time p,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-update-time p,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url-title p,
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-functions p {
  min-width: 80px;
  max-width: 80px;
  align-self: center;
}
`,ht={storageKey:"netDiskHistoryMatch",isSetOtherEvent:false,dataPaging:void 0,show(){let t=this.getStorageData(),e="",a=this;t=this.orderNetDiskHistoryMatchData(t),e=`
        <div class="netdiskrecord-search">
            <input type="text" placeholder="æœç´¢é“¾æ¥/ç½‘å€/ç½‘å€æ ‡é¢˜ï¼ŒæŒ‰ä¸‹å›è½¦è¿›è¡Œæœç´¢ï¼ˆå¯æ­£åˆ™ï¼‰">
        </div>
        <div class="netdiskrecord-table">
			<ul></ul>
		</div>
        <div class="netdiskrecord-page">

        </div>`,S.$el.$historyView=K.confirm({title:{text:"å†å²åŒ¹é…è®°å½•",position:"center"},content:{text:e,html:true},btn:{reverse:true,position:"space-between",close:{callback(n){n.close(),S.$el.$historyView=void 0;}},ok:{enable:false,callback(n){n.close(),S.$el.$historyView=void 0;}},cancel:{enable:true,text:"å…³é—­",callback(n){n.close(),S.$el.$historyView=void 0;}},other:{enable:true,text:`æ¸…ç©ºæ‰€æœ‰(${t.length})`,type:"xiaomi-primary",callback:()=>{K.confirm({title:{text:"åˆ é™¤",position:"center"},content:{text:"ç¡®å®šæ¸…ç©ºæ‰€æœ‰çš„è®°å½•ï¼Ÿ",html:false},btn:{ok:{enable:true,callback(n){a.clearStorageData(),a.clearLinkElements(),a.clearPageNavigator(),n.close();let i=S.$el.$historyView.$shadowRoot.querySelector(".netdiskrecord-page"),s=S.$el.$historyView.$shadowRoot.querySelector(".pops-confirm-btn-other");h.html(i,""),h.text(s,h.text(s).replace(/[\d]+/gi,"0"));}},cancel:{text:"å–æ¶ˆ",enable:true}}});}}},mask:{clickCallBack(n){n(),S.$el.$historyView=null;}},class:"whitesevPopNetDiskHistoryMatch",style:hn},S.$config.viewSizeConfig.historyMatchView),this.addLinkElements(t.slice(0,9)),this.setDataPaging(t),this.setEvent(S.$el.$historyView.$shadowRoot),this.setSearchEvent(),lt.setRightClickMenu(S.$el.$historyView.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch"),".netdiskrecord-link a",true);},getLinkContainer(){return S.$el.$historyView.$shadowRoot.querySelector(".netdiskrecord-table ul")},addLinkElements(t){Array.isArray(t)||(t=[t]);let e=document.createDocumentFragment();for(let n=0;n<t.length;n++){let i=t[n],s=this.createLinkItemElementInfo(i);e.appendChild(s.$liItemContainer);}this.getLinkContainer().appendChild(e);},createLinkItemElementInfo(t){let e=V.handleLinkShow({ruleKeyName:t.ruleKeyName,ruleIndex:t.ruleIndex,shareCode:t.shareCode,accessCode:t.accessCode,matchText:t.matchText}),a=h.createElement("li",{innerHTML:`
			<div class="netdiskrecord-link">
				<p>é“¾æ¥</p>
				<a  href="javascript:;" isvisited="false">${e}</a>
			</div>
			<div class="netdiskrecord-icon">
				<p>ç½‘ç›˜</p>
				<div class="netdisk-icon-img"></div>
			</div>
			<div class="netdiskrecord-url">
				<p>ç½‘å€</p>
				<a href="${t.url}" target="_blank">${t.url}</a>
			</div>
			<div class="netdiskrecord-url-title">
				<p>ç½‘å€æ ‡é¢˜</p>
				${t.title}
			</div>
			<div class="netdiskrecord-add-time">
				<p>è®°å½•æ—¶é—´</p>
				${f.formatTime(t.addTime)}
			</div>
			<div class="netdiskrecord-update-time">
				<p>æ›´æ–°æ—¶é—´</p>
				${f.formatTime(t.updateTime)}
			</div>
			<div class="netdiskrecord-functions">
				<p>åŠŸèƒ½</p>
				<button class="btn-delete" type="button">åˆ é™¤</button>
			</div>
			`}),n=a.querySelector(".netdiskrecord-link"),i=n.querySelector("a"),s=a.querySelector(".netdiskrecord-icon"),r=a.querySelector(".netdisk-icon-img"),l=a.querySelector(".netdiskrecord-url"),o=a.querySelector(".netdiskrecord-url-title"),c=a.querySelector(".netdiskrecord-add-time"),u=a.querySelector(".netdiskrecord-update-time"),d=a.querySelector(".netdiskrecord-functions"),p=d.querySelector(".btn-delete");if(fe.handleBoxAttrRuleInfo({ruleKeyName:t.ruleKeyName,ruleIndex:t.ruleIndex,shareCode:t.shareCode,accessCode:t.accessCode},i),r.style.cssText=`background: url(${S.$inst.icon.getIcon(t.ruleKeyName)}) no-repeat;background-size:100%`,t.url!==t.topURL){let w=h.createElement("div",{className:"netdiskrecord-top-url",innerHTML:`
				<p>Topç½‘å€</p>
				<a href="${t.topURL}" target="_blank">${t.topURL}</a>
				`});h.after(l,w);}return p.setAttribute("data-json",JSON.stringify(t)),Reflect.set(p,"data-json",t),{$liItemContainer:a,$link:n,$linkAnchor:i,$icon:s,$iconImg:r,$url:l,$urlTitle:o,$addTime:c,$updateTime:u,$features:d,$featuresBtnDelete:p,html:a.outerHTML}},clearLinkElements(){let t=this.getLinkContainer();h.empty(t),t.scrollTo(0,0);},clearPageNavigator(){h.remove(S.$el.$historyView.$shadowRoot.querySelectorAll(".netdiskrecord-page > *"));},setEvent(t){let e=this;Je.setNetDiskUrlClickEvent(t,".netdiskrecord-link a"),h.on(t,"click",".netdiskrecord-functions button.btn-delete",function(a){let n=t.querySelector(".pops-confirm-btn-other"),i=K.loading({$parent:e.getLinkContainer(),content:{text:"åˆ é™¤ä¸­..."},only:true,addIndexCSS:false}),s=a.target,r=s.getAttribute("data-json");s.closest("li")?.remove(),e.deleteStorageData(r),i?.close();let l=h.text(n),o=l.match(/[\d]+/gi),c=parseInt(o[o.length-1]);c--,l=l.replace(/[\d]+/gi,c.toString()),h.text(n,l);let u=e.getStorageData();u=e.orderNetDiskHistoryMatchData(u),e.dataPaging.refresh(u),e.pageChangeCallBack(u,e.dataPaging.CONFIG.currentPage);});},pageChangeCallBack(t,e){let a=(e-1)*10,n=t.slice(a,a+9);this.clearLinkElements(),this.addLinkElements(n);},setDataPaging(t){let e=this,a=new zt({data:t,pageShowDataMaxCount:10,pageMaxStep:z.isPhone()?2:4,currentPage:1,pageChangeCallBack:function(i){e.pageChangeCallBack(t,i);}});this.dataPaging=a,a.addCSS(S.$el.$historyView.$shadowRoot);const n=S.$el.$historyView.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-page");a.append(n);},setSearchEvent(){let t=false,e,a=this;function n(){if(t)return;t=true,e=K.loading({$parent:a.getLinkContainer(),content:{text:"æœç´¢ä¸­..."},only:true,addIndexCSS:false});let i=S.$el.$historyView.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-search input").value.trim(),s=a.getStorageData();if(s=a.orderNetDiskHistoryMatchData(s),i===""){a.clearLinkElements(),a.clearPageNavigator(),a.addLinkElements(s.slice(0,9)),e?.close(),t=false,a.setDataPaging(s);return}m.info("å†å²åŒ¹é…è®°å½•-æœç´¢ï¼š"+i);let r=s.filter(l=>{let o=V.handleLinkShow({ruleKeyName:l.ruleKeyName,ruleIndex:l.ruleIndex,shareCode:l.shareCode,accessCode:l.accessCode,matchText:l.matchText,showToast:false});o||m.info(l);let c=f.toRegExp(i,"i");if(typeof o=="string"&&o.match(c)||l.shareCode.match(c)||l.url.match(c)||l.topURL.match(c)||l.title.match(c))return  true});a.clearLinkElements(),a.clearPageNavigator(),a.addLinkElements(r),e?.close(),e=void 0,t=false;}h.onKeyboard(S.$el.$historyView.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-search input"),"keypress",i=>{i==="Enter"&&n();});},orderNetDiskHistoryMatchData(t){let e=k.historyMatch["netdisk-history-match-ordering-rule"].value,a=e.indexOf("é™åº")!==-1,n=e.indexOf("è®°å½•æ—¶é—´")!==-1?"addTime":"updateTime";return f.sortListByProperty(t,i=>i[n],a),t},queryAccessCode(t,e,a){let n=this.getStorageData();for(let i=0;i<n.length;i++){const s=n[i];if(s.ruleKeyName===t&&s.shareCode===e)return a&&f.isNotNull(s.accessCode),s.accessCode}},syncAccessCode(t,e,a,n){if(k.historyMatch.saveMatchNetDisk.value){if(ht.changeMatchedDataAccessCode(t,e,a,n))return m.success("å·²æˆåŠŸåŒæ­¥è®¿é—®ç è‡³å†å²åŒ¹é…è®°å½•"),true;m.error("åŒæ­¥è®¿é—®ç è‡³å†å²åŒ¹é…è®°å½•å¤±è´¥");}return  false},changeMatchedDataAccessCode(t,e,a,n){let i=this.getStorageData(),s=false;for(let r=0;r<i.length;r++){const l=i[r];l.ruleKeyName===t&&String(l.ruleIndex)===String(e)&&l.shareCode===a&&(s=true,i[r].accessCode=n,i[r].updateTime=Date.now());}return s&&this.saveStorageData(i),s},changeMatchedData(t,e,a,n,i){if(!k.historyMatch.saveMatchNetDisk.value)return  false;let s=this.getStorageData(),r=false;for(let l=0;l<s.length;l++){const o=s[l];if(o.ruleKeyName===t&&a.startsWith(o.shareCode)&&o.ruleIndex===e&&(k.historyMatch["netdisk-history-match-merge-same-link"].value||o.url===window.location.href&&o.topURL===top.window.location.href)){r=true;let c=false;if(i.trim()!==""&&o.matchText!==i&&(c=true,m.success("åŒ¹é…å†å²è®°å½• -> è®¾ç½®æ–°çš„matchText",[i]),s[l].matchText=i),f.isNotNull(n)&&o.accessCode!==n&&(c=true,m.success("åŒ¹é…å†å²è®°å½• -> ä¿®æ”¹accessCode"),s[l].accessCode=n),c){s[l].updateTime=Date.now(),s[l].title&&(s[l].title=document.title),k.historyMatch["netdisk-history-match-merge-same-link"].value&&(s[l].url=window.location.href,s[l].topURL=top.window.location.href);break}}}if(!r){r=true,m.success("åŒ¹é…å†å²è®°å½• -> å¢åŠ æ–°çš„");let l=Date.now();s=[...s,{url:window.location.href,topURL:top.window.location.href,ruleKeyName:t,ruleIndex:e,shareCode:a,accessCode:n,addTime:l,updateTime:l,title:document.title||top.document.title,matchText:i}];}return this.saveStorageData(s),true},checkAndRepairLocalData(){let t=0,e=ie(this.storageKey);if(Array.isArray(e))for(let a=0;a<e.length;a++){let n=false;const i=e[a];typeof i.matchText!="string"&&(i.matchText="",n=true),typeof i.ruleKeyName!="string"&&typeof i.netDiskName=="string"&&(i.ruleKeyName=i.netDiskName,delete i.netDiskName,n=true),typeof i.ruleIndex!="number"&&typeof i.netDiskIndex=="number"&&(i.ruleIndex=i.netDiskIndex,delete i.netDiskIndex,n=true),n&&t++;}else e=[];return this.saveStorageData(e),{count:e.length,repairCount:t}},getStorageData(){let t=ie(this.storageKey,[]);return t==null&&(t=[],this.saveStorageData(t)),t},saveStorageData(t){he(this.storageKey,t);},deleteStorageData(t){let e=false,a=this.getStorageData();for(let n=0;n<a.length;n++)if(JSON.stringify(a[n])===t){m.success("åˆ é™¤ ===> ",a[n]),a.splice(n,1),e=true;break}return e&&this.saveStorageData(a),e},clearStorageData(){this.saveStorageData([]);}},nt={addHost(t){let e=this.getList();e.includes(t)||e.push(t),this.updateList(e);},findHost(t){return this.getList().findIndex(n=>n===t)!==-1},removeHost(t){let e=this.getList(),a=false,n=e.findIndex(i=>i===t);return n!==-1&&(a=true,e.splice(n,1),this.updateList(e)),a},getList(){let t=ie(q.$key.neverTipWorkerInitErrorKey,[]);return Array.isArray(t)||(t=[t]),t},updateList(t){he(q.$key.neverTipWorkerInitErrorKey,t);}},qe={depthQueryShadowRootAllNode(t){let e=[];function a(n){let i=Array.from(n.querySelectorAll("*"));return i.forEach(s=>{if(s.classList&&s.classList.contains("pops-shadow-container"))return;let r=s.shadowRoot;r&&r instanceof ShadowRoot&&e.push({shadowRoot:r,childNode:a(r)});}),i}return a(t),e},ignoreStrRemove(t,e=false){let a=[];return a.length&&a.forEach(n=>{if(n!=null)if(e)n.innerHTML!=null&&(t=t.replaceAll(n.innerHTML,""));else {let i=n.innerText||n.textContent;i!=null&&(i=i.replaceAll(i,""));}}),t},getPageText(t=document.documentElement,e){let a=[];if(a.push(t?.textContent||t?.innerText||""),e){let n=this.depthQueryShadowRootAllNode(t);n.length&&n.forEach(i=>{let s=i.shadowRoot.textContent;s&&a.push(s);});}return a=a.filter(n=>n!==""),a},getPageHTML(t=document.documentElement,e){let a=[];if(a.push(t.innerHTML),e){let n=this.depthQueryShadowRootAllNode(t);n.length&&n.forEach(i=>{let s=i.shadowRoot.innerHTML;s&&a.push(s);});}return a=a.filter(n=>n!==""),a},getInputElementValue(t=document.documentElement,e){let a=[];if(Array.from(t.querySelectorAll("input")).forEach(n=>{a.push(n.value);}),e){let n=this.depthQueryShadowRootAllNode(t);n.length&&n.forEach(i=>{for(let s=0;s<i.childNode.length;s++){const r=i.childNode[s];r instanceof HTMLInputElement&&r.value&&a.push(r.value);}});}return a},getTextAreaElementValue(t=document.documentElement,e){let a=[];if(Array.from(t.querySelectorAll("textarea")).forEach(n=>{a.push(n.value);}),e){let n=this.depthQueryShadowRootAllNode(t);n.length&&n.forEach(i=>{for(let s=0;s<i.childNode.length;s++){const r=i.childNode[s];r instanceof HTMLTextAreaElement&&r.value&&a.push(r.value);}});}return a},getSelectContent(){let t={text:"",html:""},e=window.getSelection();if(e){t.text=e.toString();let a=h.createElement("div");if(!e.isCollapsed){const n=e.getRangeAt(0).cloneContents();a.appendChild(n),t.html=h.html(a);}}return t}},fn={$data:{ajaxHooker:null},execMatch(t){k.match.toBeMatchedXhrHookResponseText.value&&(this.$data.ajaxHooker||(this.$data.ajaxHooker=f.ajaxHooker(),this.$data.ajaxHooker.hook(e=>{e.response=a=>{typeof a.responseText=="string"&&q.postMessage({...t,textList:[a.responseText],from:"Xhr"});};})));}},Jt=new f.Vue,it=Jt.reactive({domChange:true}),q={$data:{delayNotMatchCount:0,blobUrl:"",GM_matchWorker:null},$flag:{isInit:false,isHandleMatch:false,dispatchMonitorDOMChange:false},$key:{neverTipWorkerInitErrorKey:"never-toast-worker-error",postMessageType:"worker-init-error"},$check:{checkTimeId:void 0,workerInitError:null},init(){this.listenWorkerInitErrorDialog(),this.initWorker(),this.monitorDOMChange(),f.hasWorkerCSP().then(t=>{t&&this.workerInitFailed();});},initWorker(){try{const t=`
(() => {
    function ${q.handleRegularMatch.toString()}

    function ${q.uniqueArr}
    
    this.addEventListener(
    "message",
    function (event) {
        const data = event.data;
        let matchedList = [];
        ${q.handleRegularMatch.name}(data,(matchData)=>{
          matchedList.push(matchData);
          data.textList = matchData.textList;
        })
        matchedList = ${q.uniqueArr.name}(matchedList);
        this.postMessage({
          options: data,
          msg: "Match End",
          data: matchedList,
          startTime: data.startTime,
          endTime: Date.now(),
        });
    },
    {
        capture: true,
    }
    );
})();`,e=new Blob([t],{type:"application/javascript"});let a=window.URL.createObjectURL(e);window.trustedTypes&&typeof window.trustedTypes.createPolicy=="function"&&(a=window.trustedTypes.createPolicy("workerPolicy",{createScriptURL:i=>i}).createScriptURL(a)),this.$data.blobUrl=a,this.$data.GM_matchWorker=new Worker(this.$data.blobUrl),this.$data.GM_matchWorker.onmessage=this.onMessage,this.$data.GM_matchWorker.onerror=this.onError,m.info(`Worker(Blob Url): ${this.$data.blobUrl}`);}catch(t){this.coverWorker(t);}finally{typeof this.$data.blobUrl=="string"&&globalThis.URL.revokeObjectURL(this.$data.blobUrl),this.$data.blobUrl="";}},coverWorker(t){t!=null&&(this.$check.workerInitError=t),m.info("use local GM_matchWorker",t),this.$data.GM_matchWorker={postMessage(e){return new Promise(a=>{let n=[];try{q.handleRegularMatch(e,i=>{n.push(i),e.textList=i.textList;});}catch(i){q.onError(i);}finally{n=q.uniqueArr(n),q.onMessage(new MessageEvent("message",{data:{isInitTest:true,options:e,msg:"Match End",data:n,startTime:e.startTime,endTime:Date.now()}})),a(null);}})}};},handleRegularMatch(t,e){const a=Object.keys(t.matchedRuleOption),n=[];for(let i of t.textList){for(let s=0;s<t.characterMapping.length;s++){const r=t.characterMapping[s];try{typeof r.searchValue=="string"?i=i.replaceAll(r.searchValue,r.replaceValue):i=i.replace(r.searchValue,r.replaceValue);}catch{}}n.push(i);}for(const i of a){const s=t.matchedRuleOption[i];for(let r=0;r<s.length;r++){const l=s[r];let o=[];if(t.matchTextRange.includes("innerText")&&o.push(new RegExp(l.link_innerText,"gi")),t.matchTextRange.includes("innerHTML")&&o.push(new RegExp(l.link_innerHTML,"gi")),!t.matchTextRange.length)throw m.error(t),new TypeError("æœªè®¾ç½®åŒ¹é…èŒƒå›´");if(!o.length)throw new TypeError("æœªçŸ¥çš„åŒ¹é…èŒƒå›´: "+t.matchTextRange);for(let c=0;c<o.length;c++){const u=o[c];for(let d=0;d<n.length;d++){let w=n[d].match(u);w&&w.length&&e({ruleKeyName:i,ruleIndex:r,data:w,textList:n});}}}}},uniqueArr(t){return t.filter((e,a,n)=>a===n.findIndex(i=>JSON.stringify(i)===JSON.stringify(e)))},listenWorkerInitErrorDialog(){F.isTopWindow()&&h.on(globalThis,"message",t=>{const e=t.data;if(typeof e=="object"&&e?.type===this.$key.postMessageType){const a=e.data;q.$check.workerInitError=a.error,this.registerWorkerInitErrorNeverTipToast(a.hostname),K.confirm({title:{text:"Worker Init Error",position:"center"},content:{text:`
                <div style="padding: 10px;gap: 10px;display: flex;flex-direction: column;">
                  <div class="msg-wrapper">
                    <div class="tip-text">é”™è¯¯ï¼š</div>
                    <div class="msg-container" data-type="error">
                      <p>${a.error}</p>
                    </div>
                  </div>
                  <div class="msg-wrapper">
                    <div class="tip-text">é“¾æ¥${F.isTopWindow()?"":"ï¼ˆiframeï¼‰"}ï¼š</div>  
                    <div class="msg-container" data-type="url">
                      <p>${a.url}</p>
                    </div>
                  </div>
                  <div class="msg-wrapper">
                    <div class="tip-text">ä¿¡æ¯ï¼š</div>  
                    <div class="msg-container" data-type="msg">
                      <p>åˆå§‹åŒ–Workerå¤±è´¥ï¼Œè‹¥é¡µé¢æ–‡æœ¬è¿‡å¤§ï¼Œåˆ™æ‰§è¡Œæ–‡æœ¬åŒ¹é…æ—¶ä¼šå¯¼è‡´é¡µé¢å¡æ­»</p>
                    </div>
                  </div>
                  <div class="msg-wrapper">
                    <div class="tip-text">è§£å†³ï¼š</div>
                    <div class="msg-container" data-type="solution">
                      <div>1. ç‚¹å‡»ä¸‹é¢çš„<code>å¿«é€Ÿæ·»åŠ ç½‘ç«™è§„åˆ™</code>-<code>è‡ªå®šä¹‰</code>ï¼ŒæŠŠ<code>è®¾ç½®</code>-<code>åŠŸèƒ½</code>-<code>åŒ¹é…æ¨¡å¼</code>åˆ‡æ¢ä¸º<code>Menu</code></div>
                      <div>2. ä½¿ç”¨CSPæ’ä»¶ç¦ç”¨CSPç­–ç•¥ï¼ˆä¸å»ºè®®ä½¿ç”¨ï¼‰</div>
                    </div>
                  </div>
                </div>
                `,html:true},style:`
              .msg-wrapper{
                display: flex;
                align-items: baseline;
              }
              .tip-text{
                white-space: nowrap;
              }
              .msg-container{

              }
              .msg-container > p{

              }
              .msg-container[data-type="error"]{
                color: red;
              }
              `,btn:{merge:true,position:"space-between",ok:{text:"å¿«é€Ÿæ·»åŠ ç½‘ç«™è§„åˆ™",callback(){const n=xe.getTemplateData();n.name="æ‰‹åŠ¨åŒ¹é…ï¼š"+a.hostname,n.url=`^http(s|):\\/\\/${a.hostname}\\/`,n.data[k.features["netdisk-match-mode"].KEY]="Menu";const i=new Pt({title(){return "è§„åˆ™ç®¡ç†å™¨"},contentConfig:[xe.getRulePanelViewOption(n)]});i.showEditView(i.option.contentConfig[0].ruleOption,void 0,false,n,void 0,void 0,void 0,()=>{g.success("æ·»åŠ æˆåŠŸ");});}},cancel:{text:"ç½‘ç«™è§„åˆ™",callback(){Qe.showView("ç½‘ç«™è§„åˆ™");}},other:{enable:true,text:"ä¸å†æç¤º",type:"xiaomi-primary",callback(){K.confirm({title:{text:"æç¤º",position:"center"},content:{text:`ç¡®å®šä¸å†å¼¹å‡ºè¯¥æç¤ºï¼Ÿï¼ˆä»…é’ˆå¯¹åŸŸåï¼š${a.hostname}ï¼‰`},btn:{ok:{callback(n){nt.addHost(a.hostname),n.close();}}}},{PC:{width:"400px",height:"200px"},Mobile:{width:"80vw",height:"200px"}});}}}},{PC:{width:"550px",height:"350px"},Mobile:{width:"88vw",height:"500px"}});}},{capture:true});},dispatchWorkerInitErrorDialog(t){top?.postMessage({type:this.$key.postMessageType,data:{url:window.location.href,hostname:window.location.hostname,error:t??this.$check.workerInitError}},"*");},registerWorkerInitErrorNeverTipToast(t){let e="ğŸ’€ Workeråˆå§‹åŒ–å¤±è´¥";const a=()=>nt.findHost(t)?e+"ï¼ˆå·²è®¾ç½®ä¸å†æç¤ºï¼‰":e,n={key:"workerInitErrorNeverTipToast-"+t,text:a(),autoReload:false,isStoreValue:false,showText:a,callback:()=>{nt.findHost(t)?confirm("æ˜¯å¦å…è®¸å¼¹å‡ºWorkeråˆå§‹åŒ–å¤±è´¥çš„å¼¹çª—æç¤ºï¼Ÿ")&&(nt.removeHost(t)?g.success("åˆ é™¤æˆåŠŸ"):g.error("åˆ é™¤å¤±è´¥"),Ke.update(n)):this.dispatchWorkerInitErrorDialog();}};Ke.update(n);},postMessage(t,e){q.$data.GM_matchWorker.postMessage(t,e);},onMessage(t){const e=t.data;(e.options.from==="PasteText"||e.options.from==="ShortCut-Select-Content")&&S.$inst.matchPasteText.workerMatchEndCallBack(e),e.options.from.startsWith("FirstLoad")&&q.$data.delayNotMatchCount++,q.successCallBack(e);},onError(t){q.errorCallBack(t);},successCallBack(t){if(!t.data.length){q.matchingEndCallBack();return}const e=[];for(const n of t.data){V.$match.matchedInfoRuleKey.add(n.ruleKeyName);const i=new Set;n.data.forEach(s=>{i.add(s);}),i.forEach(s=>{const r=V.handleLink({ruleKeyName:n.ruleKeyName,ruleIndex:n.ruleIndex,matchText:s});r&&e.push({shareCode:r.shareCode,accessCode:r.accessCode,ruleKeyName:n.ruleKeyName,ruleIndex:n.ruleIndex,matchText:s});});}const a=e.filter((n,i,s)=>s.findIndex(l=>l.accessCode===n.accessCode&&l.ruleIndex===n.ruleIndex&&l.ruleKeyName===n.ruleKeyName&&l.shareCode===n.shareCode)===i);if(a.forEach(n=>{V.$match.tempMatchedInfo.has(n.ruleKeyName)&&V.$match.tempMatchedInfo.get(n.ruleKeyName).set(n.shareCode,n);}),a.forEach(n=>{let{shareCode:i,accessCode:s,ruleKeyName:r,ruleIndex:l,matchText:o}=n;const u=V.$rule.rule.find(w=>w.setting.key===r).rule[l];let d=false;if(V.$match.blackMatchedInfo.forEach((w,b)=>{if(b!==n.ruleKeyName)return;w.has(i)&&(d=true,m.warn(`åŒ¹é…åˆ°é»‘åå•åˆ†äº«ç ï¼Œå·²è¿‡æ»¤ï¼š${i}`,JSON.stringify(n)));}),d)return;if(u.shareCodeExcludeRegular&&Array.isArray(u.shareCodeExcludeRegular))for(const w of u.shareCodeExcludeRegular){const b=V.$match.matchedInfo.get(w),x=V.$match.tempMatchedInfo.get(w);if(b.startsWith(i)||x.startsWith(i)){m.warn(`${r}ï¼šè¯¥åˆ†äº«ç ã€${i}ã€‘ä¸å·²åŒ¹é…åˆ°è¯¥åˆ†äº«ç çš„è§„åˆ™ã€${w}ã€‘å†²çª`);return}}const p=V.$match.matchedInfo.get(r);if(V.$data.isMatchedLink=true,p.startsWith(i)){const w=p.getStartsWith(i);if(typeof w.isForceAccessCode=="boolean"&&w.isForceAccessCode||f.isNotNull(w.accessCode)||f.isNull(s))return;p.set(i,V.createLinkStorageInst(s,l,false,o)),S.$inst.linkView.changeBoxItemView(r,l,i,s,o),m.info(`è¯¥åŒ¹é…é¡¹æ— å¯†ç ï¼Œè®¾ç½®å¯†ç  ${r} ${l}: ${i}  ===> ${s}`);}else {if(f.isNull(s)&&k.accessCode.allowQueryHistoryMatchingAccessCode.value){const w=ht.queryAccessCode(r,i,true);w&&(m.info("å†å²åŒ¹é…è®°å½• ==> æŸ¥è¯¢åˆ°è®¿é—®ç ï¼š"+w),s=w);}p.set(i,V.createLinkStorageInst(s,l,false,o)),S.$data.isMatchedNetDiskIconMap.add(r),S.$inst.linkView.addBoxItemView(r,l,i,s,o),m.success(`æ·»åŠ é“¾æ¥ ${r} ${l}: ${i}  ===> ${s}`);}}),Object.keys(V.$match.tempMatchedInfo.getItems()).forEach(n=>{V.$match.tempMatchedInfo.get(n).clear();}),V.$data.isMatchedLink)switch(k.features["netdisk-behavior-mode"].value){case "suspension_smallwindow".toLowerCase():ue.mode.current_suspension_smallwindow_mode.value==="suspension"?S.$inst.suspension.init():S.$inst.linkView.show();break;case "suspension_window".toLowerCase():S.$inst.suspension.init();break;case "smallwindow".toLowerCase():S.$inst.linkView.show();break;default:m.error("æœªçŸ¥çš„è¡Œä¸ºæ¨¡å¼ï¼š"+k.features["netdisk-behavior-mode"].value);}q.matchingEndCallBack();},errorCallBack(t){q.matchingEndCallBack(true),m.error("Worker Error CallBack"+(F.isTopWindow()?"":" (iframe)"),t);},matchingEndCallBack(t){if(t)q.$flag.isHandleMatch=false,q.$data.delayNotMatchCount>0&&(q.$data.delayNotMatchCount=0,it.domChange=true);else {const e=parseFloat(k.match.delaytime.value.toString())*1e3;setTimeout(()=>{q.matchingEndCallBack(true);},e);}},workerInitFailed(){if(this.coverWorker(),k.features["netdisk-match-mode"].value==="Menu")return;let e=ie(this.$key.neverTipWorkerInitErrorKey,[]);if(Array.isArray(e)||(e=[e]),this.$check.workerInitError!=null||this.$flag.isInit==false){m.error("åˆå§‹åŒ–Workerå¤±è´¥ï¼Œå¯èƒ½é¡µé¢ä½¿ç”¨äº†Content-Security-Policyç­–ç•¥ï¼Œå½“å‰å·²ä½¿ç”¨å…¶å®ƒå‡½æ•°æ¥ä»£æ›¿Workeræ‰§è¡Œæ–‡æœ¬åŒ¹é…ï¼Œå¦‚æœæ‰§è¡ŒåŒ¹é…çš„æ–‡æœ¬çš„å†…å®¹è¿‡å¤§ä¼šæ—¶ï¼Œåˆ™ä¼šå¯¼è‡´é¡µé¢å¡æ­»",this.$check.workerInitError);const a=e.find(n=>n===window.location.hostname);a?this.registerWorkerInitErrorNeverTipToast(a):this.dispatchWorkerInitErrorDialog();}},monitorDOMChange(){const t=k.match.isAddedNodesToMatch.value,e=k.match.readClipboard.value,a=k.match.pageMatchRange.value;let n=true,i=true,s=true;const r=k.match.depthQueryWithShadowRoot.value,l={},o=dt.getMappingData();V.$rule.rule.forEach(d=>{const p=d.setting.key;J.function.enable(p)&&(Reflect.has(l,p)?l[p]=[...l[p],...d.rule]:Reflect.set(l,p,d.rule));});const c=async function(d){if(q.$flag.isHandleMatch){q.$data.delayNotMatchCount++;return}if(t&&d&&d.length){let b=false;for(let x=0;x<d.length;x++){const C=d[x];if(C.addedNodes&&C.addedNodes instanceof NodeList&&C.addedNodes.length){b=true;break}}if(!b)return}q.$flag.isHandleMatch=true;const p=Date.now();if(e)try{let b=await f.getClipboardInfo();b.error!=null&&(V.$data.clipboardText=b.content);}catch{}typeof V.$data.clipboardText!="string"&&(V.$data.clipboardText="");const w=[];if(f.isNotNull(V.$data.clipboardText)){const b=V.$data.clipboardText;w.push(b);}if(k.match.allowMatchLocationHref.value){const b=le.getDecodeComponentUrl();w.push(b);}if(n&&(n=false,w.length)){q.postMessage({characterMapping:o,textList:w,matchTextRange:a,matchedRuleOption:l,startTime:p,from:"FirstLoad-DOMChange"});return}if(a.includes("innerText")){const b=qe.getPageText(document.documentElement,r);if(w.push(...b),i){i=false,q.postMessage({characterMapping:o,textList:w,matchTextRange:a,matchedRuleOption:l,startTime:p,from:"FirstLoad-Text-DOMChange"});return}}if(a.includes("innerHTML")){const b=qe.getPageHTML(document.documentElement,r);if(w.push(...b),s){s=false,q.postMessage({characterMapping:o,textList:w,matchTextRange:a,matchedRuleOption:l,startTime:p,from:"FirstLoad-HTML-DOMChange"});return}}if(k.match.toBeMatchedWithInputElementValue.value){const b=qe.getInputElementValue(document.documentElement,r);w.push(...b);}if(k.match.toBeMatchedTextAreaElementValue.value){const b=qe.getTextAreaElementValue(document.documentElement,r);w.push(...b);}q.postMessage({characterMapping:o,textList:w,matchTextRange:a,matchedRuleOption:l,startTime:p,from:"DOMChange"});};Jt.watch(()=>it.domChange,d=>{if(d){const p=ha("html");c([{addedNodes:p,attributeName:null,attributeNamespace:null,nextSibling:null,oldValue:null,previousSibling:null,removedNodes:p,target:p[0],type:"attributes"}]);}},{triggerMethod:"set"});const u=k.features["netdisk-match-mode"].value;fn.execMatch({characterMapping:o,matchTextRange:a,matchedRuleOption:l,startTime:Date.now()}),u==="MutationObserver"?(f.mutationObserver(document.documentElement,{callback:c,config:{childList:k.match["mutationObserver-childList"].value,characterData:k.match["mutationObserver-characterData"].value,subtree:k.match["mutationObserver-subtree"].value}}),it.domChange=true):u==="Menu"?Ke.add({key:"performPageTextMatchingManually_"+window.location.href,text:"ç‚¹å‡»æ‰§è¡Œæ–‡æœ¬åŒ¹é…"+(F.isTopWindow()?"":"ï¼ˆiframeï¼‰"),autoReload:false,isStoreValue:false,showText(d){return d},callback:()=>{it.domChange=true;}}):m.error("æœªçŸ¥åŒ¹é…æ¨¡å¼ï¼š"+u);}},It={$el:{$select:null,$log:null,$matchText:null,$button:null},reset(){Object.keys(this.$el).forEach(t=>{Reflect.deleteProperty(this.$el,t);});},setLog(t,...e){let a="";e.forEach(i=>{a!==""&&(a+=`
`),typeof i!="string"?a+=JSON.stringify(i,void 0,4):a+=i;});const n=h.createElement("p",{innerText:a},{"data-tag":t});h.append(this.$el.$log,n);},clearLog(){h.empty(this.$el.$log);},showUI(t){if(this.reset(),f.isNull(t.regexp)){g.error("è¯·å…ˆé…ç½®regexp");return}const e=this,n=de.parseRule([t])[0].rule,i=K.confirm({title:{text:`è°ƒè¯•è§„åˆ™ ${t.key}`,position:"center"},content:{text:`
          <div class="custom-rule-container">
              <textarea class="custom-rule-match-text" placeholder="è¯·è¾“å…¥éœ€è¦æµ‹è¯•åŒ¹é…çš„å­—ç¬¦ä¸²"></textarea>
              <div class="custom-rule-input-container">
              <select class="custom-rule-select-regexp"></select>
              <button class="custom-rule-run-match-button" type="button" data-type="primary" data-icon="" data-righticon="false">
                  <span>æ‰§è¡Œ</span>
              </button>
              </div>
          </div>
          <div class="custom-rule-match-log">
              <div>åŒ¹é…æ—¥å¿—â†“</div>
              <div class="custom-rule-match-log-container"></div>
          </div>
          `,html:true},btn:{ok:{enable:false}},style:`
        .custom-rule-container{
            display: flex;
            align-items: center;
        }
        .custom-rule-select-regexp{
            width: 100%;
            height: 32px;
            line-height: normal;
            border: 1px solid rgb(184, 184, 184, var(--pops-bd-opacity));
            border-radius: 5px;
            text-align: center;
            outline: 0;
            background: rgb(255, 255, 255, var(--pops-bg-opacity));
            box-shadow: none;
        }
        .custom-rule-input-container{
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin: 5px;
            width: 30%;
        }
        .custom-rule-select-regexp-item{

        }
        button.custom-rule-run-match-button{
            margin-top: 5px;
        }
        textarea.custom-rule-match-text{
            width: 100%;
            min-height: 70px;
            outline: none;
            margin: 0px;
            background-image: none;
            background-color: transparent;
            display: inline-block;
            resize: vertical;
            padding: 5px;
            line-height: normal;
            box-sizing: border-box;
            border: 1px solid rgb(220, 223, 230);
            appearance: none;
        }
        .custom-rule-match-log{

        }
        .custom-rule-match-log-container{
            padding: 5px;
            background: rgb(229, 229, 229);
        }
        .custom-rule-match-log-container p{
            margin: 2px 0px;
            border-bottom: 1px solid #000000;
        }
        .custom-rule-match-log-container p:last-child{
            border-bottom: 0px;
            margin-bottom: 0px;
        }
        .custom-rule-match-log-container p[data-tag]{
          padding: 10px 0px;
        }
        .custom-rule-match-log-container p[data-tag="info"]{

        }
        .custom-rule-match-log-container p[data-tag="success"]{
            color: green;
        }
        .custom-rule-match-log-container p[data-tag="warn"]{
            color: yellow;
        }
        .custom-rule-match-log-container p[data-tag="error"]{
            color: red;
        }
        `},S.$config.viewSizeConfig.customRuleDebugView);this.$el.$select=i.$shadowRoot.querySelector(".custom-rule-select-regexp"),this.$el.$matchText=i.$shadowRoot.querySelector(".custom-rule-match-text"),this.$el.$log=i.$shadowRoot.querySelector(".custom-rule-match-log-container"),this.$el.$button=i.$shadowRoot.querySelector(".custom-rule-run-match-button"),n.forEach((l,o)=>{this.$el.$select.appendChild(h.createElement("option",{className:"custom-rule-select-regexp-item",innerText:"regexpä¸‹æ ‡:"+o,"data-value":l}));});const s=function(l){Array.isArray(l.msg)?e.setLog(l.status?"info":"error",...l.msg):e.setLog(l.status?"info":"error",l.msg),l.status||e.setLog("error","æ‰§è¡Œå®Œæ¯•");},r=function(){try{if(f.isNull(e.$el.$matchText.value)){g.error("è¯·å…ˆè¾“å…¥å¾…åŒ¹é…çš„å­—ç¬¦ä¸²");return}e.clearLog();const l=t.key,o=e.$el.$select.selectedIndex,c=e.$el.$select.options[o]["data-value"];m.info("å½“å‰é€‰ä¸­çš„è§„åˆ™: ",c);const u={};u[t.key]=[c];let d=[];if(q.handleRegularMatch({characterMapping:dt.getMappingData(),matchedRuleOption:u,textList:[e.$el.$matchText.value],matchTextRange:["innerText","innerHTML"],startTime:Date.now(),from:"Debug"},p=>{d.push(...p.data);}),!d.length){e.setLog("error","æœªæˆåŠŸåŒ¹é…åˆ°æ•°æ®");return}d=q.uniqueArr(d),e.setLog("info","æˆåŠŸåŒ¹é…åˆ°çš„æ•°æ® ==> ",d),d.forEach((p,w)=>{e.setLog("success","å½“å‰å¤„ç†çš„å­—ç¬¦ä¸²: "+p),e.setLog("success","å½“å‰æ‰§è¡Œ: å¯¹shareCodeè¿›è¡Œå¤„ç†è·å–");const b=V.handleShareCode({ruleKeyName:l,ruleIndex:o,matchText:p,debugConfig:{matchText:p,config:c,logCallBack:s}});if(f.isNull(b))return;e.setLog("info"," "),e.setLog("info","================åˆ†å‰²çº¿================"),e.setLog("info"," "),e.setLog("success","å½“å‰æ‰§è¡Œ: å¯¹accessCodeè¿›è¡Œå¤„ç†è·å–");const x=V.handleAccessCode({ruleKeyName:l,ruleIndex:o,matchText:p,debugConfig:{matchText:p,config:c,logCallBack:s}});e.setLog("info"," "),e.setLog("info","================åˆ†å‰²çº¿================"),e.setLog("info"," "),e.setLog("success","å½“å‰æ‰§è¡Œ: å¯¹uiLinkShowè¿›è¡Œå¤„ç†è·å–");const C=V.handleLinkShow({ruleKeyName:l,ruleIndex:o,shareCode:b,accessCode:x,matchText:p,debugConfig:{matchText:p,config:c,logCallBack:s}});e.setLog("info"," "),e.setLog("info","================åˆ†å‰²çº¿================"),e.setLog("info"," "),e.setLog("success","å½“å‰æ‰§è¡Œ: å¯¹blankè¿›è¡Œå¤„ç†è·å–");const R=ee.getBlankUrl({ruleKeyName:l,ruleIndex:o,shareCode:b,accessCode:x,debugConfig:{matchText:p,config:c,logCallBack:s}});e.setLog("info"," "),e.setLog("info","================åˆ†å‰²çº¿================"),e.setLog("info"," "),e.setLog("success","å½“å‰æ‰§è¡Œ: å¯¹copyUrlè¿›è¡Œå¤„ç†è·å–");const M=ee.getCopyUrlInfo({ruleKeyName:l,ruleIndex:o,shareCode:b,accessCode:x,debugConfig:{matchText:p,config:c,logCallBack:s}});e.setLog("success","æ‰§è¡Œå®Œæ¯•");});}catch(l){m.error(l),e.setLog(l.toString());}};h.on(e.$el.$button,"click",r);}},Et=`.pops[type-value="confirm"] .pops-confirm-content {
  overflow: hidden;
}
/* textareaç¾åŒ– */
.pops.whitesevPopNetDiskCustomRules[type-value="confirm"] .pops-confirm-content textarea {
  width: 100%;
  height: 100%;
  border: none;
  outline: none;
  padding: 0;
  margin: 0;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  background-image: none;
  background-color: transparent;

  display: inline-block;
  resize: vertical;
  padding: 5px 15px;
  line-height: normal;
  box-sizing: border-box;
  border: 1px solid #dcdfe6;
  transition: border-color 0.2s cubic-bezier(0.645, 0.045, 0.355, 1);
  appearance: none;
  resize: none;
}
/* è·å¾—ç„¦ç‚¹ */
.pops.whitesevPopNetDiskCustomRules[type-value="confirm"] .pops-confirm-content textarea:focus {
  outline: none;
  border-color: #3677f0;
}
/* æç¤ºæ–‡å­— */
.pops.whitesevPopNetDiskCustomRules[type-value="confirm"] .pops-confirm-content textarea::placeholder {
  color: #c0c4cc;
}
/* é¼ æ ‡hover */
.pops.whitesevPopNetDiskCustomRules[type-value="confirm"] .pops-confirm-content textarea:hover {
  border-color: #c0c4cc;
}
`,Ve={show(t,e,a){let n="æ·»åŠ ";t&&(n="ç¼–è¾‘"),n+="é“¾æ¥è¯†åˆ«è§„åˆ™";let i=null;function s(u,d){let p=i.value.trim(),w=de.parseRuleStrToRule(p);if(w.success){let b=w.data;if(t)if(de.updateRule(e,b))g.success("æ›´æ–°æˆåŠŸ");else {g.error("æ›´æ–°å¤±è´¥");return}else de.addRule(b),g.success("æ·»åŠ æˆåŠŸ");a?.(b);}else g.error(w.msg);}function r(u){let d=i.value.trim(),p=de.parseRuleStrToRule(d);if(p.success){let w=p.data;It.showUI(w);}else g.error(p.msg);}function l(u){try{let d=JSON.parse(i.value),p=de.getFormatRule(d);i.value=p,g.success("æ ¼å¼åŒ–æˆåŠŸ");}catch(d){m.error(d),g.error(d.message,{timeout:3500,isHTML:true});}}i=K.confirm({title:{text:n,position:"center"},content:{text:'<textarea class="netdisk-custom-rules" placeholder="è¯·è¾“å…¥è§„åˆ™é…ç½®"></textarea>',html:true},btn:{merge:true,mergeReverse:false,reverse:false,position:"space-between",ok:{text:"ä¿å­˜",callback:(u,d)=>{s();}},cancel:{text:"è°ƒè¯•",callback:(u,d)=>{r();}},other:{enable:true,text:"æ ¼å¼åŒ–",type:"xiaomi-primary",callback:(u,d)=>{l();}}},class:"whitesevPopNetDiskCustomRules",style:Et},S.$config.viewSizeConfig.customRulesView).$shadowRoot.querySelector("textarea");let c;t?c=de.getRule(e):c=de.getTemplateRule(),i.value=de.getFormatRule(c);},showSubscribe(t,e,a){let n="ç¼–è¾‘è®¢é˜…çš„é“¾æ¥è¯†åˆ«è§„åˆ™",i=null;function s(u,d){let p=i.value.trim(),w=de.parseRuleStrToRule(p);if(w.success){let b=w.data;if(ae.updateSubscribeRule(t,b))g.success("æ›´æ–°æˆåŠŸ");else {g.error("æ›´æ–°å¤±è´¥");return}a?.(b);}else g.error(w.msg);}function r(u){let d=i.value.trim(),p=de.parseRuleStrToRule(d);if(p.success){let w=p.data;It.showUI(w);}else g.error(p.msg);}function l(u){try{let d=JSON.parse(i.value),p=de.getFormatRule(d);i.value=p,g.success("æ ¼å¼åŒ–æˆåŠŸ");}catch(d){m.error(d),g.error(d.message,{isHTML:true,timeout:3500});}}i=K.confirm({title:{text:n,position:"center"},content:{text:'<textarea class="netdisk-custom-rules" placeholder="è¯·è¾“å…¥è§„åˆ™é…ç½®"></textarea>',html:true},btn:{merge:true,mergeReverse:false,reverse:false,position:"space-between",ok:{text:"ä¿å­˜",callback:(u,d)=>{s();}},cancel:{text:"è°ƒè¯•",callback:(u,d)=>{r();}},other:{enable:true,text:"æ ¼å¼åŒ–",type:"xiaomi-primary",callback:(u,d)=>{l();}}},class:"whitesevPopNetDiskCustomRules",style:Et},S.$config.viewSizeConfig.customRulesView).$shadowRoot.querySelector("textarea");let c;c=ae.getSubscribeRule(t,e),i.value=de.getFormatRule(c);}},Ue=new ze("userRule"),Oe=new ze("userRuleBindContext"),de={$data:{STORAGE_KEY:"rule",EXPORT_CONFIG_KEY:"rule-export-config",__userRule:null,get userRule(){return this.__userRule==null&&(this.__userRule=new f.Dictionary),this.__userRule}},init(){const t=ie("userRule");Array.isArray(t)&&(Ye("userRule"),this.setRule(t));let e=this.parseRule(this.getAllRule());const a=this.parseRule(ae.getAllSubscribeRule());e=e.concat(a),e.forEach(n=>{this.$data.userRule.set(n.setting.key,n);});},parseRuleStrToRule(t){function e(n){return typeof n.link_innerText!="string"?{success:false,msg:"regexpç¼ºå¤±çš„é”®å: link_innerTextï¼Œç±»å‹: string"}:typeof n.link_innerHTML!="string"?{success:false,msg:"regexpç¼ºå¤±çš„é”®å: link_innerHTMLï¼Œç±»å‹: string"}:typeof n.shareCode!="string"?{success:false,msg:"regexpç¼ºå¤±çš„é”®å: shareCodeï¼Œç±»å‹: string"}:typeof n.shareCodeNeedRemoveStr!="string"&&!Array.isArray(n.shareCodeNeedRemoveStr)?{success:false,msg:"regexpç¼ºå¤±çš„é”®å: shareCodeNeedRemoveStrï¼Œç±»å‹: string|string[]"}:typeof n.uiLinkShow!="string"?{success:false,msg:"regexpç¼ºå¤±çš„é”®å: uiLinkShowï¼Œç±»å‹: string"}:typeof n.blank!="string"?{success:false,msg:"regexpç¼ºå¤±çš„é”®å: blankï¼Œç±»å‹: string"}:typeof n.copyUrl!="string"?{success:false,msg:"regexpç¼ºå¤±çš„é”®å: copyUrlï¼Œç±»å‹: string"}:typeof n.accessCode=="string"&&typeof n.checkAccessCode!="string"?{success:false,msg:"regexpè®¾ç½®äº†accessCodeä½†æ˜¯æ²¡æœ‰è®¾ç½®checkAccessCode"}:typeof n.accessCode!="string"&&typeof n.checkAccessCode=="string"?{success:false,msg:"regexpè®¾ç½®äº†checkAccessCodeä½†æ˜¯æ²¡æœ‰è®¾ç½®accessCode"}:{success:true,msg:"æ ¡éªŒruleæˆåŠŸ"}}function a(n){return typeof n.name!="string"?{success:false,msg:"settingç¼ºå¤±çš„é”®å: nameï¼Œç±»å‹: string"}:typeof n.enable!="boolean"?{success:false,msg:"settingç¼ºå¤±çš„é”®å: enableï¼Œç±»å‹: boolean"}:{success:true,msg:"æ ¡éªŒsettingæˆåŠŸ"}}try{let n=typeof t=="string"?f.toJSON(t):t;if(m.info("è§£æå‡ºçš„è§„åˆ™å¯¹è±¡ï¼š",n),typeof n!="object")return {success:!1,msg:"è¯¥è§„åˆ™ä¸æ˜¯objectç±»å‹"};if(Object.keys(n).length===0)return {success:!1,msg:"è¯¥è§„åˆ™ä¸ºç©º"};if(typeof n.key!="string")return {success:!1,msg:"ç¼ºå¤±çš„é”®å: keyï¼Œç±»å‹: string"};if(typeof n.regexp!="object")return {success:!1,msg:"ç¼ºå¤±çš„é”®å: regexpï¼Œç±»å‹: object|Arrany"};if(typeof n.setting!="object")return {success:!1,msg:"ç¼ºå¤±çš„é”®å: settingï¼Œç±»å‹: object"};if(Array.isArray(n.regexp))for(const s of n.regexp){let r=e(s);if(!r.success)return r}else {let s=e(n.regexp);if(!s.success)return s}let i=a(n.setting);return i.success?{success:!0,msg:"è§£ææˆåŠŸ",data:n}:i}catch(n){return m.error(n),{success:false,msg:n.message}}},getBindContext(t){return {rule:t,NetDiskRequire:dn,CryptoJS:He,httpx:L,utils:f,DOMUtils:h,window,unsafeWindow:ne,NetDiskCheckLinkValidity:te,NetDiskCheckLinkValidityStatus:A,log:m,Qmsg:g,pops:z,setValue:Oe.set.bind(Oe),getValue:Oe.get.bind(Oe),deleteValue:Oe.delete.bind(Oe)}},parseRule(t){function e(n,i,s){let{shareCode:r,shareCodeNeedRemoveStr:l,shareCodeNotMatch:o,checkAccessCode:c,accessCode:u,acceesCodeNotMatch:d,accessCodeNeedRemoveStr:p,paramMatch:w,...b}=s,x={...b};if(x.link_innerText=le.replaceParam(x.link_innerText,Gt(n)),x.link_innerHTML=le.replaceParam(x.link_innerText,Yt(n)),typeof r=="string"&&(x.shareCode=new RegExp(r,"ig")),l&&(typeof l=="string"&&(l=[l]),Array.isArray(l))){Array.isArray(x.shareCodeNeedRemoveStr)?x.shareCodeNeedRemoveStr.length=0:x.shareCodeNeedRemoveStr=[];for(const C of l)if(typeof C=="string"){const R=new RegExp(C,"ig");x.shareCodeNeedRemoveStr.push(R);}}if(o&&(typeof o=="string"&&(o=[o]),Array.isArray(o))){Array.isArray(x.shareCodeNotMatch)?x.shareCodeNotMatch.length=0:x.shareCodeNotMatch=[];for(const C of o)if(typeof C=="string"){const R=new RegExp(C,"ig");x.shareCodeNotMatch.push(R);}}if(typeof c=="string"&&(x.checkAccessCode=new RegExp(c,"ig")),typeof u=="string"&&(x.accessCode=new RegExp(u,"ig")),d&&(typeof d=="string"&&(d=[d]),Array.isArray(d))){Array.isArray(x.acceesCodeNotMatch)?x.acceesCodeNotMatch.length=0:x.acceesCodeNotMatch=[];for(const C of d)if(typeof C=="string"){const R=new RegExp(C,"ig");x.acceesCodeNotMatch.push(R);}}if(p&&(typeof p=="string"&&(p=[p]),Array.isArray(p))){Array.isArray(x.accessCodeNeedRemoveStr)?x.accessCodeNeedRemoveStr.length=0:x.accessCodeNeedRemoveStr=[];for(const C of p)if(typeof C=="string"){const R=new RegExp(C,"ig");x.accessCodeNeedRemoveStr.push(R);}}return typeof w=="string"&&(x.paramMatch=new RegExp(w,"i")),x}let a=[];for(const n of t){let i={subscribeUUID:n.subscribeUUID,rule:[],setting:{name:n.setting.name,key:n.key,configurationInterface:{matchRange_text:{},matchRange_html:{},function:{},linkClickMode_openBlank:{},schemeUri:{},ownFormList:[]}},isUserRule:true,afterRenderUrlBox:void 0};const s=n.regexp,r=n.key;if(Array.isArray(s)?s.forEach(c=>{i.rule.push(e(r,n,c));}):i.rule.push(e(r,n,s)),n.setting){if(this.initDefaultValue(O.function.enable(r),!!n.setting.enable),i.setting.configurationInterface.function.enable=!!n.setting.enable,typeof n.setting.isBlank=="boolean"&&(this.initDefaultValue(O.function.linkClickMode(r),"openBlank"),i.setting.configurationInterface.function.linkClickMode={openBlank:{default:true,enable:true}}),typeof n.setting.linkClickMode=="object"){let c=f.assign(le.getDefaultLinkClickMode(),n.setting.linkClickMode||{}),u=null,d=[];const p=Object.keys(c);for(const w of p){let b=c[w];b.enable&&(b.default&&(u=w),d.push({value:w,text:b.text}));}u==null&&(u=d[0].value),this.initDefaultValue(O.function.linkClickMode(r),u);}typeof n.setting.openBlankWithCopyAccessCode=="boolean"&&(this.initDefaultValue(O.linkClickMode_openBlank.openBlankWithCopyAccessCode(r),!!n.setting.openBlankWithCopyAccessCode),i.setting.configurationInterface.linkClickMode_openBlank.openBlankWithCopyAccessCode=!!n.setting.openBlankWithCopyAccessCode),typeof n.setting.openBlankAutoFilleAccessCode=="boolean"&&(this.initDefaultValue(O.linkClickMode_openBlank.openBlankAutoFilleAccessCode(r),!!n.setting.openBlankAutoFilleAccessCode),i.setting.configurationInterface.linkClickMode_openBlank.openBlankAutoFilleAccessCode=!!n.setting.openBlankAutoFilleAccessCode),typeof n.setting.checkLinkValidity=="boolean"&&(this.initDefaultValue(O.function.checkLinkValidity(r),!!n.setting.checkLinkValidity),i.setting.configurationInterface.function.checkLinkValidity=!!n.setting.checkLinkValidity),typeof n.setting.checkLinkValidityHoverTip=="boolean"&&this.initDefaultValue(O.function.checkLinkValidityHoverTip(r),!!n.setting.checkLinkValidityHoverTip),typeof n.setting.isForward=="boolean"&&(this.initDefaultValue(O.schemeUri.enable(r),!!n.setting.isForward),i.setting.configurationInterface.schemeUri.enable=!!n.setting.isForward),typeof n.setting.schemeUri=="string"&&(this.initDefaultValue(O.schemeUri.uri(r),n.setting.schemeUri),i.setting.configurationInterface.schemeUri.uri=n.setting.schemeUri),typeof n.setting.innerTextAccessCodeBeforeMaxRange=="number"&&(this.initDefaultValue(O.matchRange_text.before(r),n.setting.innerTextAccessCodeBeforeMaxRange),i.setting.configurationInterface.matchRange_text.before=n.setting.innerTextAccessCodeBeforeMaxRange),typeof n.setting.innerTextAccessCodeAfterMaxRange=="number"&&(this.initDefaultValue(O.matchRange_text.after(r),n.setting.innerTextAccessCodeAfterMaxRange),i.setting.configurationInterface.matchRange_text.after=n.setting.innerTextAccessCodeAfterMaxRange),typeof n.setting.innerHTMLAccessCodeBeforeMaxRange=="number"&&(this.initDefaultValue(O.matchRange_html.before(r),n.setting.innerHTMLAccessCodeBeforeMaxRange),i.setting.configurationInterface.matchRange_html.before=n.setting.innerHTMLAccessCodeBeforeMaxRange),typeof n.setting.innerHTMLAccessCodeAfterMaxRange=="number"&&(this.initDefaultValue(O.matchRange_html.after(r),n.setting.innerHTMLAccessCodeAfterMaxRange),i.setting.configurationInterface.matchRange_html.after=n.setting.innerHTMLAccessCodeAfterMaxRange);}if(typeof n.icon=="string"){let c=n.icon;S.$inst.icon.addIcon(r,c);}const l=Object.getPrototypeOf(async function(){}).constructor;if(typeof n.checkLinkValidityFunction=="string")try{let c=this.getBindContext(n);Reflect.set(te.ruleCheckValidFunction,r,{init:new l("netDiskInfo",n.checkLinkValidityFunction).bind(c)});}catch(c){m.error(c);}if(typeof n.AuthorizationFunction=="string")try{let c=this.getBindContext(n);Reflect.deleteProperty(c,"NetDiskCheckLinkValidity"),St.netDisk[r]=new l(n.AuthorizationFunction).bind(c);}catch(c){m.error(c);}if(typeof n.AutoFillAccessCodeFunction=="string")try{let c=this.getBindContext(n);Reflect.deleteProperty(c,"NetDiskCheckLinkValidity"),Xe.netDisk[r]=new l("netDiskInfo",n.AutoFillAccessCodeFunction).bind(c);}catch(c){m.error(c);}if(typeof n.parseFunction=="string")try{let c=this.getBindContext(n);Reflect.deleteProperty(c,"NetDiskCheckLinkValidity"),Reflect.set(vt.rule,r,new l(n.parseFunction).bind(c));}catch(c){m.error(c);}if(typeof n.afterRenderUrlBox=="string")try{let c=this.getBindContext(n);Reflect.deleteProperty(c,"NetDiskCheckLinkValidity"),i.afterRenderUrlBox=new l("option",n.afterRenderUrlBox).bind(c);}catch(c){m.error(c);}let o=a.find(c=>c.setting.key===i.setting.key);o?o.rule=o.rule.concat(i.rule):a.push(i);}return a},getNetDiskRuleConfig(){return this.$data.userRule.values()},initDefaultValue(t,e){ie(t)==null&&he(t,e);},getTemplateRule(){return {key:"è§„åˆ™å",icon:"å›¾æ ‡é“¾æ¥å­—ç¬¦ä¸²æˆ–å›¾ç‰‡çš„base64å­—ç¬¦ä¸²",regexp:[{link_innerText:"",link_innerHTML:"",shareCode:"",shareCodeNeedRemoveStr:"",uiLinkShow:"",blank:"",copyUrl:""}],setting:{name:"è®¾ç½®ç•Œé¢çš„åå­—",enable:true,linkClickMode:"openBlank",openBlankWithCopyAccessCode:true}}},getRulePanelViewOption(t){const e=this,a=()=>t??this.getTemplateRule(),n={id:"user-rule",title:"é“¾æ¥è¯†åˆ«",headerTitle:"é“¾æ¥è¯†åˆ«è§„åˆ™",ruleOption:{btnControls:{add:{enable:true,callback(i){return Ve.show(false,void 0,s=>{this.updateRuleContaienrElement(n.ruleOption,void 0,i.$section);}),false}},filter:{enable:true,option:[{name:"æ— ",value:"",selectedCallBack(i){},filterCallBack(i){return  true}},{name:"å·²å¯ç”¨",value:"enable",selectedCallBack(i){},filterCallBack(i){return i.setting.enable}},{name:"æœªå¯ç”¨",value:"notEnable",selectedCallBack(i){},filterCallBack(i){return !i.setting.enable}}],inputOption:[{name:"è§„åˆ™å",value:"name",selectedCallBack(i){},filterCallBack(i,s){return !!i.setting.name.match(s)}},{name:"é”®",value:"key",selectedCallBack(i){},filterCallBack(i,s){return !!i.key.match(s)}}]},clearAll:{enable:true,callback:()=>{this.clearRule();}},import:{enable:true,callback:i=>{this.importRule(()=>{i();});}},export:{enable:true,callback:()=>{this.exportRule($e+"-é“¾æ¥è¯†åˆ«è§„åˆ™.json",$e+"-é“¾æ¥è¯†åˆ«è§„åˆ™-è®¢é˜…æ¨¡å¼.json");}},ruleEdit:{enable:true,callback(i){return Ve.show(true,i.ruleData.key,async s=>{let r=await i.context.updateRuleItemElement(i.option,i.subscribeOption,s,i.$ruleItem,i.$section);i.$ruleItem=r;}),false}},ruleDelete:{enable:true,deleteCallBack:i=>e.deleteRule(i.key)}},data:()=>this.getAllRule(),getAddData:()=>a(),getData:i=>this.getAllRule().find(l=>l.key===i.key)??i,getDataItemName:i=>i.setting.name,updateData:i=>this.updateRule(i.key,i),deleteData:i=>this.deleteRule(i.key)},subscribe:{enable:true,data(){return ae.getAllSubscribe()},getData:i=>ae.getSubscribe(i.uuid)??i,getDataItemName(i){return `
						<style>
							.subscribe-rule-title-info-wrapper{
								display: flex;
								flex-direction: column;
								gap: 4px;
							}
							.subscribe-rule-title-info-wrapper .rule-name-text{
								white-space: nowrap;
								text-overflow: ellipsis;
								overflow: hidden;
								font-weight: 600;
								font-size: 16px;
								line-height: 24px;
							}
							.subscribe-rule-title-info-wrapper .subscribe-rule-small-span-text{
								font-size: 14px;
								line-height: 16px;
								white-space: pre-wrap;
							}
						</style>
						<div class="subscribe-rule-title-info-wrapper">
							<div class="rule-name-text" style="white-space: nowrap;text-overflow: ellipsis;overflow: hidden;font-size: 16px;font-weight: 600;line-height: 24px;">${i.data.title||i.subscribeData.title||i.data.url}</div>
								<div class="subscribe-rule-small-span-text">${i.subscribeData.ruleData.length} æ¡è§„åˆ™ï¼Œæ›´æ–°äºï¼š${f.formatTime(i.data.latestUpdateTime,"yyyyå¹´MMæœˆddæ—¥ HH:mm:ss")}${typeof i.data.updateFailedTime=="number"?`ï¼Œ<span style="color: red;">æ›´æ–°å¤±è´¥äºï¼š${f.formatTime(i.data.updateFailedTime,"yyyyå¹´MMæœˆddæ—¥ HH:mm:ss")}</span>`:""}</div>
								${i.subscribeData.homePage?`<a href="${i.subscribeData.homePage}" class="subscribe-rule-small-span-text" target="_blank" style="color:#67b279;">è½¬åˆ°ä¸»é¡µ</a>`:""}
								<a href="${i.data.url}" class="subscribe-rule-small-span-text" target="_blank" style="color:#67b279;">è®¢é˜…åœ°å€</a>
						</div>`},addData:i=>ae.addSubscribe(i),updateData:i=>ae.updateSubscribe(i),deleteData:i=>ae.deleteSubscribe(i),btnControls:{add:{enable:true},filter:{enable:true,option:[{name:"æ— ",value:"",selectedCallBack(i){},filterCallBack(i){return  true}},{name:"å·²å¯ç”¨",value:"enable",selectedCallBack(i){},filterCallBack(i){return i.data.enable}},{name:"æœªå¯ç”¨",value:"notEnable",selectedCallBack(i){},filterCallBack(i){return !i.data.enable}}],inputOption:[{name:"æ ‡é¢˜",value:"name",selectedCallBack(i){},filterCallBack(i,s){let r=false;return typeof i.data.title=="string"&&(r=!!i.data.title.match(s)),!r&&typeof i.subscribeData.title=="string"&&(r=!!i.subscribeData.title.match(s)),r}},{name:"è®¢é˜…åœ°å€",value:"url",selectedCallBack(i){},filterCallBack(i,s){return !!i.data.url.match(s)}}]},clearAll:{enable:true,callback:()=>{ae.deleteAllSubscribe();}},ruleEnable:{enable:true,getEnable(i){return i.data.enable},async callback(i,s){i.data.enable=s,ae.updateSubscribe(i);}},ruleEdit:{enable:true,callback:i=>{let s=i.ruleData.uuid;return i.enterDeepMenu({headerTitle:i.ruleData.data.title||i.ruleData.subscribeData.title||i.ruleData.data.url,data(){return ae.getSubscribe(s)?.subscribeData?.ruleData??i.ruleData.subscribeData.ruleData},getData(r){return ae.getSubscribeRule(s,r.key)??r},getDataItemName(r){return r.setting.name},addData(r){return  true},updateData(r){return ae.updateSubscribeRule(s,r)},deleteData(r){return ae.deleteSubscribeRule(s,r)},btnControls:{filter:{enable:true,option:[{name:"æ— ",value:"",selectedCallBack(r){},filterCallBack(r){return  true}},{name:"å·²å¯ç”¨",value:"enable",selectedCallBack(r){},filterCallBack(r){return r.setting.enable}},{name:"æœªå¯ç”¨",value:"notEnable",selectedCallBack(r){},filterCallBack(r){return !r.setting.enable}}],inputOption:[{name:"è§„åˆ™å",value:"name",selectedCallBack(r){},filterCallBack(r,l){return !!r.setting.name.match(l)}},{name:"é”®",value:"key",selectedCallBack(r){},filterCallBack(r,l){return !!r.key.match(l)}}]},clearAll:{enable:true,callback:()=>{ae.clearSubscribe(s);}},ruleEdit:{enable:true,callback(r){return Ve.showSubscribe(s,r.ruleData.key,async l=>{const o=await r.context.updateRuleItemElement(r.option,r.subscribeOption,l,r.$ruleItem,r.$section);r.$ruleItem=o;}),false}},ruleDelete:{enable:true,deleteCallBack(r){return ae.deleteSubscribeRule(s,r)}}}}),false}},ruleDelete:{enable:true,deleteCallBack:i=>ae.deleteSubscribe(i)},import:{enable:true,callback(i){ae.importSubscribe(()=>{i();});}},export:{enable:true,callback(){ae.exportSubscribe($e+"-ç½‘ç«™è§„åˆ™-è®¢é˜….json");}}},getSubscribeInfo:ae.getSubscribeInfo.bind(ae)}};return n},addRule(t){const e=this.getAllRule();e.push(t),this.setRule(e);},setRule(t){t=Array.isArray(t)?t:[t],Ue.set(this.$data.STORAGE_KEY,t);},updateRule(t,e){const a=this.getAllRule(),n=a.findIndex(i=>i.key===t);return n!==-1?(a.splice(n,1,e),this.setRule(a),true):false},deleteRule(t){const e=this.getAllRule(),a=e.findIndex(n=>n.key===t);return a!==-1?(e.splice(a,1),this.setRule(e),true):false},clearRule(){Ue.delete(this.$data.STORAGE_KEY);},getAllRule(){return Ue.get(this.$data.STORAGE_KEY,[])},getRule(t){return this.getAllRule().find(a=>a.key===t)},getFormatRule(t){return JSON.stringify(t||this.getAllRule(),void 0,4)},exportRule(t="rule.json",e="rule-subscribe.json"){const a=K.alert({title:{text:"è¯·é€‰æ‹©å¯¼å‡ºæ–¹å¼",position:"center"},content:{text:`
                    <div class="btn-control" data-mode="only-export-rule-list">å¯¼å‡ºè§„åˆ™</div>
                    <div class="btn-control" data-mode="export-to-subscribe">å¯¼å‡ºè®¢é˜…è§„åˆ™</div>
                `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(r,l){r.close();}}},mask:{enable:true},drag:true,width:P.info.width,height:P.info.height,style:`
      .btn-control{
          display: inline-block;
          margin: 10px;
          padding: 10px;
          border: 1px solid #ccc;
          border-radius: 5px;
          cursor: pointer;
        }
				.btn-control:hover{
					color: #409eff;
					border-color: #c6e2ff;
					background-color: #ecf5ff;
				}`}),n=a.$shadowRoot.querySelector(".btn-control[data-mode='only-export-rule-list']"),i=a.$shadowRoot.querySelector(".btn-control[data-mode='export-to-subscribe']"),s=(r,l)=>{const o=new Blob([JSON.stringify(l,null,4)]),c=window.URL.createObjectURL(o),u=document.createElement("a");u.href=c,u.download=r,u.click(),setTimeout(()=>{window.URL.revokeObjectURL(c);},1500);};h.on(n,"click",r=>{h.preventEvent(r);try{const l=this.getAllRule();if(l.length===0){g.warning("è§„åˆ™ä¸ºç©ºï¼Œæ— éœ€å¯¼å‡º");return}s(t,l),a.close();}catch(l){g.error(l.toString(),{consoleLogContent:true});}}),h.on(i,"click",r=>{h.preventEvent(r);const l=this;a.close();try{if(this.getAllRule().length===0){g.warning("è§„åˆ™ä¸ºç©ºï¼Œæ— éœ€å¯¼å‡º");return}const c=z.config.PanelHandlerComponents(),u=function(y){return {get(v,$){return y[v]??$},set(v,$){y[v]=$,Ue.set(l.$data.EXPORT_CONFIG_KEY,y);}}},d=()=>{const y=Ue.get(this.$data.EXPORT_CONFIG_KEY,{});if(y?.title===""||y.title==null){g.error("è®¢é˜…æ ‡é¢˜ä¸èƒ½ä¸ºç©º");return}if(y.version==null){g.error("ç‰ˆæœ¬å·ä¸èƒ½ä¸ºç©º");return}else y.version=Number(y.version);y.homePage==null&&(y.homePage=void 0),y.lastModified=Date.now(),y.ruleData=this.getAllRule(),s(e,y),p.close();},p=K.alert({title:{text:"è¯·å¡«å†™å¯¼å‡ºé…ç½®",position:"center"},content:{text:`
							
						`,html:!0},btn:{ok:{enable:!0,text:"å¯¼å‡º",callback(y,v){d();}},close:{enable:!0,callback(y,v){y.close();}}},mask:{enable:!0},drag:!0,width:P.info.width,height:P.info.height,style:`
						${z.config.cssText.panelCSS}

						.pops-alert-content li{
							list-style-type: none;
							display: flex;
							align-items: center;
							justify-content: space-between;
							margin: 10px;
						}
					`}),w=p.$shadowRoot.querySelector(".pops-alert-content"),b=Ue.get(this.$data.EXPORT_CONFIG_KEY,{}),x=re("è®¢é˜…æ ‡é¢˜","title","");Reflect.set(x.props,j,u(b));const C=c.createSectionContainerItem_input(x).$el,R=re("ç‰ˆæœ¬å·","version","");Reflect.set(R.props,j,u(b));const M=c.createSectionContainerItem_input(R).$el,T=re("ä¸»é¡µåœ°å€","homePage","","",void 0,"é€‰å¡«");Reflect.set(T.props,j,u(b));const _=c.createSectionContainerItem_input(T).$el;h.append(w,C),h.append(w,M),h.append(w,_);}catch(o){g.error(o.toString(),{consoleLogContent:true});}});},importRule(t){const e=K.alert({title:{text:"è¯·é€‰æ‹©å¯¼å…¥æ–¹å¼",position:"center"},content:{text:`
                    <div class="btn-control" data-mode="local">æœ¬åœ°å¯¼å…¥</div>
                    <div class="btn-control" data-mode="network">ç½‘ç»œå¯¼å…¥</div>
                    <div class="btn-control" data-mode="clipboard">å‰ªè´´æ¿å¯¼å…¥</div>
                `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(l,o){l.close();}}},mask:{enable:true},drag:true,width:P.info.width,height:P.info.height,style:`
                .btn-control{
                    display: inline-block;
                    margin: 10px;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    cursor: pointer;
                }
				.btn-control:hover{
					color: #409eff;
					border-color: #c6e2ff;
					background-color: #ecf5ff;
				}
            `}),a=e.$shadowRoot.querySelector(".btn-control[data-mode='local']"),n=e.$shadowRoot.querySelector(".btn-control[data-mode='network']"),i=e.$shadowRoot.querySelector(".btn-control[data-mode='clipboard']"),s=l=>{let o=this.getAllRule();const c=[];for(let u=0;u<l.length;u++){const d=l[u];o.findIndex(w=>w.key===d.key)!==-1||c.push(d);}o=o.concat(c),c.length?(Ue.set(this.$data.STORAGE_KEY,o),m.info("æ–°å¢çš„è§„åˆ™ï¼š",c),g.success(`å…± ${l.length} æ¡è§„åˆ™ï¼Œæ–°å¢ ${c.length} æ¡`)):g.error("æœªæ–°å¢è§„åˆ™ï¼Œè¯·åˆ é™¤æ—§è§„åˆ™å†é‡æ–°å¯¼å…¥"),t?.();},r=l=>new Promise(o=>{let c=f.toJSON(l);if(Array.isArray(c)){if(!c.length){g.error("å¯¼å…¥å¤±è´¥ï¼Œè§£æå‡ºçš„æ•°æ®ä¸ºç©º",{consoleLogContent:true}),o(false);return}}else c=[c];const u=[];for(let p=0;p<c.length;p++){const w=c[p],b=this.parseRuleStrToRule(w);if(!b.success){if(c.length===1){g.error(b.msg,{timeout:4e3});return}continue}b.data&&u.push(b.data);}const d=c.length-u.length;d>0&&(d===c.length?g.error("æ‰€æœ‰è§„åˆ™å‡æœªé€šè¿‡è§„åˆ™æ£€æŸ¥ï¼Œè¯·æ£€æŸ¥è§„åˆ™",{timeout:4e3}):g.warning(`æ£€æµ‹åˆ°æœ‰ ${d}æ¡æœªé€šè¿‡è§„åˆ™æ£€æŸ¥çš„è§„åˆ™ï¼Œå·²å¿½ç•¥`,{timeout:4e3})),u.length&&(s(u),o(true));});h.on(a,"click",l=>{h.preventEvent(l),e.close();const o=h.createElement("input",{type:"file",accept:".json"});h.on(o,["propertychange","input"],c=>{if(!o.files?.length)return;const u=o.files[0],d=new FileReader;d.onload=()=>{r(d.result);},d.readAsText(u,"UTF-8");}),o.click();}),h.on(n,"click",l=>{h.preventEvent(l),e.close();const o=K.prompt({title:{text:"ç½‘ç»œå¯¼å…¥",position:"center"},content:{text:"",placeholder:"è¯·å¡«å†™URL",focus:true},btn:{close:{enable:true,callback(d,p){d.close();}},ok:{text:"å¯¼å…¥",callback:async(d,p)=>{const w=d.text;if(f.isNull(w)){g.error("è¯·å¡«å…¥å®Œæ•´çš„url");return}const b=g.loading("æ­£åœ¨è·å–é…ç½®..."),x=await L.get(w,{allowInterceptConfig:false});if(b.close(),!x.status){m.error(x),g.error("è·å–é…ç½®å¤±è´¥",{consoleLogContent:true});return}await r(x.data.responseText)&&d.close();}},cancel:{enable:false}},mask:{enable:true},drag:true,width:P.info.width,height:"auto"}),c=o.$shadowRoot.querySelector("input"),u=o.$shadowRoot.querySelector(".pops-prompt-btn-ok");h.on(c,["input","propertychange"],d=>{h.val(c)===""?h.attr(u,"disabled","true"):h.removeAttr(u,"disabled");}),h.onKeyboard(c,"keydown",(d,p,w)=>{d==="Enter"&&w.length===0&&h.val(c)!==""&&h.emit(u,"click");}),h.emit(c,"input");}),h.on(i,"click",async l=>{h.preventEvent(l),e.close();const o=await f.getClipboardInfo();if(o.error!=null){g.error(o.error.toString());return}if(o.content.trim()===""){g.warning("è·å–åˆ°çš„å‰ªè´´æ¿å†…å®¹ä¸ºç©º");return}await r(o.content);});}},Qe={init(){this.updateAllSubscribe();},getPanelView(t=0){const e={title:"è§„åˆ™ç®¡ç†å™¨",contentConfig:[de.getRulePanelViewOption(),xe.getRulePanelViewOption(),dt.getRulePanelViewOption()]};return e.contentConfig=e.contentConfig.map((n,i)=>(typeof t=="number"&&t===i||typeof t=="string"&&t===n.title?n.isDefault=true:n.isDefault=false,n)),new Pt(e)},showView(t){this.getPanelView(t).showView();},updateAllSubscribe(){ae.updateAllSubscribe(),Y.updateAllSubscribe(),se.updateAllSubscribe();}},gn={rule:[{link_innerText:"(115.com|115cdn.com|anxia.com)/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"(115.com|115cdn.com|anxia.com)/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/(115.com|115cdn.com|anxia.com)\/s\/([0-9a-zA-Z\-_]{8,24})/gi,shareCodeNeedRemoveStr:/(115.com|115cdn.com|anxia.com)\/s\//gi,checkAccessCode:/(æå–ç |å¯†ç |\?password=|è®¿é—®ç )[\s\S]+/gi,accessCode:/(æå–ç |å¯†ç |\?password=|è®¿é—®ç )([0-9a-zA-Z]{4})/i,paramMatch:/(115.com|115cdn.com|anxia.com)/i,uiLinkShow:"{#$1#}/s/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://{#$1#}/s/{#shareCode#}",copyUrl:`https://{#$1#}/s/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"115ç½‘ç›˜",key:"_115pan",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},mn={rule:[{link_innerText:"[0-9a-z]+.(link.yunpan.com|link.yunpan.360.cn)/lk/surl_[0-9a-zA-Z]{8,24}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]+|)",link_innerHTML:"[0-9a-z]+.(link.yunpan.com|link.yunpan.360.cn)/lk/surl_[0-9a-zA-Z]{8,24}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]+|)",shareCode:/(link.yunpan.com|link.yunpan.360.cn)\/lk\/surl_([0-9a-zA-Z]{8,24})/gi,shareCodeNeedRemoveStr:/(link.yunpan.com|link.yunpan.360.cn)\/lk\/surl_/gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç )[\s\S]+/gi,accessCode:/([0-9a-zA-Z]+)/gi,paramMatch:/([0-9a-z]+).(link.yunpan.com|link.yunpan.360.cn)\/lk\//i,uiLinkShow:"https://{#$1#}.{#$2#}/lk/surl_{#shareCode#} æå–ç : {#accessCode#}",blank:"https://{#$1#}.{#$2#}/lk/surl_{#shareCode#}",copyUrl:`https://{#$1#}.{#$2#}/lk/surl_{#shareCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"(yunpan.360.cn|www.yunpan.com)/lk/surl_[0-9a-zA-Z]{8,24}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]+|)",link_innerHTML:"(yunpan.360.cn|www.yunpan.com)/lk/surl_[0-9a-zA-Z]{8,24}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]+|)",shareCode:/(yunpan.360.cn|www.yunpan.com)\/lk\/surl_([0-9a-zA-Z]{8,24})/gi,shareCodeNeedRemoveStr:/(yunpan.360.cn|www.yunpan.com)\/lk\/surl_/gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç )[\s\S]+/gi,accessCode:/([0-9a-zA-Z]+)/gi,paramMatch:/(yunpan.360.cn|www.yunpan.com)/i,uiLinkShow:"https://{#$1#}/lk/surl_{#shareCode#} æå–ç : {#accessCode#}",blank:"https://{#$1#}/lk/surl_{#shareCode#}",copyUrl:`https://{#$1#}/lk/surl_{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"360AIäº‘ç›˜",key:"360yunpan",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:false,isForwardBlankLink:false,uri:""}}}},wn={rule:[{link_innerText:"aliyundrive.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"aliyundrive.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/aliyundrive\.com\/s\/([a-zA-Z0-9_\-]{8,14})/g,shareCodeNeedRemoveStr:/aliyundrive\.com\/s\//gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"aliyundrive.com/s/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://www.aliyundrive.com/s/{#shareCode#}",copyUrl:`https://www.aliyundrive.com/s/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"aliyundrive.com/t/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"aliyundrive.com/t/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/aliyundrive\.com\/t\/([a-zA-Z0-9_\-]{8,14})/g,shareCodeNeedRemoveStr:/aliyundrive\.com\/t\//gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"aliyundrive.com/t/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://www.aliyundrive.com/t/{#shareCode#}",copyUrl:`https://www.aliyundrive.com/t/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"alipan.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"alipan.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/alipan\.com\/s\/([a-zA-Z0-9_\-]{8,14})/g,shareCodeNeedRemoveStr:/alipan\.com\/s\//gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"alipan.com/s/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://www.alipan.com/s/{#shareCode#}",copyUrl:`https://www.alipan.com/s/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"é˜¿é‡Œäº‘",key:"aliyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:true,isForwardBlankLink:true,uri:""}}}},bn={rule:[{link_innerText:"pan.baidu.com/s/[0-9a-zA-Z-_]{6,24}([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç |\\?pwd=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"pan.baidu.com/s/[0-9a-zA-Z-_]{6,24}([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç |\\?pwd=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/pan\.baidu\.com\/s\/([0-9a-zA-Z-_]+)/gi,shareCodeNeedRemoveStr:/pan\.baidu\.com\/s\//gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç |pwd=)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"pan.baidu.com/s/{#shareCode#}?pwd={#accessCode#}",blank:"https://pan.baidu.com/s/{#shareCode#}?pwd={#accessCode#}",copyUrl:"https://pan.baidu.com/s/{#shareCode#}?pwd={#accessCode#}"},{link_innerText:"pan.baidu.com/(share|wap)/init\\?surl=[0-9a-zA-Z-_]{5,24}([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç |&pwd=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"pan.baidu.com/(share|wap)/init\\?surl=[0-9a-zA-Z-_]{5,24}([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç |&pwd=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/pan\.baidu\.com\/(share|wap)\/init\?surl=([0-9a-zA-Z-_]+)/gi,shareCodeNeedRemoveStr:/pan\.baidu\.com\/(share|wap)\/init\?surl=/gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç |&pwd=)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"pan.baidu.com/share/init?surl={#shareCode#}&pwd={#accessCode#}",blank:"https://pan.baidu.com/share/init?surl={#shareCode#}&pwd={#accessCode#}",copyUrl:"https://pan.baidu.com/share/init?surl={#shareCode#}&pwd={#accessCode#}"}],setting:{name:"ç™¾åº¦ç½‘ç›˜",key:"baidu",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},kn={rule:[{link_innerText:"(pan.jc-box.com|download.jamcz.com|545c.com)/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"(pan.jc-box.com|download.jamcz.com|545c.com)/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/(pan.jc-box.com|download.jamcz.com|545c.com)\/d\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(pan.jc-box.com|download.jamcz.com|545c.com)\/d\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç |\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,paramMatch:/([a-zA-Z0-9\.]+)\/d\//i,uiLinkShow:"{#$1#}/d/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://{#$1#}/d/{#shareCode#}?p={#accessCode#}",copyUrl:`https://{#$1#}/d/{#shareCode#}?p={#accessCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"ct.ghpym.com(/|/#/)d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"ct.ghpym.com(/|/#/)d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/ct.ghpym.com(\/|\/#\/)d\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/ct.ghpym.com(\/|\/#\/)d\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç |\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,paramMatch:/([a-zA-Z0-9\.]+)(\/|\/#\/)d\//i,uiLinkShow:"{#$1#}{#$2#}d/{#shareCode#} æå–ç : {#accessCode#}",blank:"http://{#$1#}{#$2#}d/{#shareCode#}?p={#accessCode#}",copyUrl:`http://{#$1#}{#$2#}d/{#shareCode#}?p={#accessCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"ctfile.com/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"ctfile.com/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/ctfile.com\/d\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/ctfile.com\/d\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç |\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"url95.ctfile.com/d/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://url95.ctfile.com/d/{#shareCode#}?p={#accessCode#}",copyUrl:`https://url95.ctfile.com/d/{#shareCode#}?p={#accessCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"(2k.us|u062.com|545c.com|t00y.com|tc5.us)/file/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"(2k.us|u062.com|545c.com|t00y.com|tc5.us)/file/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/(2k.us|u062.com|545c.com|t00y.com|tc5.us)\/file\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(2k.us|u062.com|545c.com|t00y.com|tc5.us)\/file\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç |\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"u062.com/file/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://u062.com/file/{#shareCode#}?p={#accessCode#}",copyUrl:`https://u062.com/file/{#shareCode#}?p={#accessCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc|download.jamcz.com|download.macenjoy.co)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc|download.jamcz.com|download.macenjoy.co)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc|download.jamcz.com|download.macenjoy.co)\/f\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc|download.jamcz.com|download.macenjoy.co)\/f\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç |\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,paramMatch:/([0-9a-zA-Z\.]+)\/f\//i,uiLinkShow:"{#$1#}/f/{#shareCode#} æå–ç : {#accessCode#}",blank:"http://{#$1#}/f/{#shareCode#}?p={#accessCode#}",copyUrl:`http://{#$1#}/f/{#shareCode#}?p={#accessCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"url[0-9]{2}.com/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"url[0-9]{2}.com/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/url[0-9]{2}.com\/f\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/url[0-9]{2}.com\/f\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç |\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,paramMatch:/([0-9a-zA-Z\.]+)\/f\//i,uiLinkShow:"{#$1#}/f/{#shareCode#} æå–ç : {#accessCode#}",blank:"http://{#$1#}/f/{#shareCode#}?p={#accessCode#}",copyUrl:`http://{#$1#}/f/{#shareCode#}?p={#accessCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"(ctfile.com|089u.com)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"(ctfile.com|089u.com)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/(ctfile.com|089u.com)\/f\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(ctfile.com|089u.com)\/f\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç |\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"url95.ctfile.com/f/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://url95.ctfile.com/f/{#shareCode#}?p={#accessCode#}",copyUrl:`https://url95.ctfile.com/f/{#shareCode#}?p={#accessCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"(089u.com|474b.com)/dir/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"(089u.com|474b.com)/dir/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{6}|)",shareCode:/(089u.com|474b.com)\/dir\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(089u.com|474b.com)\/dir\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç |\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{6})/gi,uiLinkShow:"089u.com/dir/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://089u.com/dir/{#shareCode#}?p={#accessCode#}",copyUrl:`https://089u.com/dir/{#shareCode#}?p={#accessCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"åŸé€šç½‘ç›˜",key:"chengtong",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""},ownFormList:[{type:"container",text:"æ–‡ä»¶è§£æé…ç½®",views:[re("<a target='_blank' href='https://github.com/qinlili23333/ctfileGet/'>è§£æç«™</a>","chengtong-parse-file-api-host","https://ctfile.qinlili.bid","è§£æç«™é…ç½®ï¼Œæš‚æ—¶åªæ”¯æŒfileï¼Œéfileä¸ºæ–°æ ‡ç­¾é¡µæ‰“å¼€",void 0,"")]}]}}},yn={rule:[{link_innerText:"ed2k://\\|file\\|[^\\|]+\\|\\d+\\|[a-fA-F0-9]{32}\\|",link_innerHTML:"ed2k://\\|file\\|[^\\|]+\\|\\d+\\|[a-fA-F0-9]{32}\\|",shareCode:/ed2k:\/\/\\|file\\|[^\\|]+\\|\\d+\\|([a-fA-F0-9]{32})\|/gi,shareCodeNeedRemoveStr:/ /gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç )[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4})/gi,paramMatch:/ed2k:\/\/\|file\|([^\|]+)\|(\d+)\|([a-fA-F0-9]{32})\|/i,uiLinkShow:"ed2k://|file|{#$1#}|{#$2#}|{#$3#}|/",blank:"ed2k://|file|{#$1#}|{#$2#}|{#$3#}|/",copyUrl:"ed2k://|file|{#$1#}|{#$2#}|{#$3#}|/"}],setting:{name:"ed2k",key:"ed2k",configurationInterface:{function:{enable:true,linkClickMode:{openBlank:{default:true},"openBlank-closePopup":{enable:true},parseFile:{enable:true,text:"å…ƒæ•°æ®é¢„è§ˆ"},"parseFile-closePopup":{enable:true,text:"å…ƒæ•°æ®é¢„è§ˆ & å…³é—­å¼¹çª—"}}},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},xn={rule:[{link_innerText:"caiyun.139.com/m/i\\?([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"caiyun.139.com/m/i\\?([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/caiyun\.139\.com\/m\/i\?([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/caiyun\.139\.com\/m\/i\?/gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"caiyun.139.com/m/i?{#shareCode#} æå–ç : {#accessCode#}",blank:"https://caiyun.139.com/m/i?{#shareCode#}",copyUrl:`https://caiyun.139.com/m/i?{#shareCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"caiyun.139.com/w/i/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"caiyun.139.com/w/i/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/caiyun\.139\.com\/w\/i\/([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/caiyun\.139\.com\/w\/i\//gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"caiyun.139.com/w/i/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://caiyun.139.com/w/i/{#shareCode#}",copyUrl:`https://caiyun.139.com/w/i/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"yun.139.com(/link/|/shareweb/#/)w/i/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"yun.139.com(/link/|/shareweb/#/)w/i/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/yun\.139\.com(\/link\/|\/shareweb\/#\/)w\/i\/([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/yun\.139\.com(\/link\/|\/shareweb\/#\/)w\/i\//gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,paramMatch:/yun.139.com(\/link\/|\/shareweb\/#\/)w\/i\//i,uiLinkShow:"yun.139.com{#$1#}w/i/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://yun.139.com{#$1#}w/i/{#shareCode#}",copyUrl:`https://yun.139.com{#$1#}w/i/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"yun.139.com/shareweb/#/w/i/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"yun.139.com/shareweb/#/w/i/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/yun\.139\.com\/shareweb\/#\/w\/i\/([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/yun\.139\.com\/shareweb\/#\/w\/i\//gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"yun.139.com/shareweb/#/w/i/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://yun.139.com/shareweb/#/w/i/{#shareCode#}",copyUrl:`https://yun.139.com/shareweb/#/w/i/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"ä¸­å›½ç§»åŠ¨äº‘ç›˜",key:"hecaiyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}}},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:false,uri:""}}}},Cn={rule:[{link_innerText:"jianguoyun.com/p/[0-9a-zA-Z-_]{16,24}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]+|)",link_innerHTML:"jianguoyun.com/p/[0-9a-zA-Z-_]{16,24}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]+|)",shareCode:/jianguoyun.com\/p\/([0-9a-zA-Z\-_]{16,24})/gi,shareCodeNeedRemoveStr:/jianguoyun.com\/p\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç )[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{3,6})/gi,uiLinkShow:"jianguoyun.com/p/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://www.jianguoyun.com/p/{#shareCode#}",copyUrl:`https://www.jianguoyun.com/p/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"åšæœäº‘",key:"jianguoyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:false,isForwardBlankLink:false,uri:""}}}},vn={rule:[{link_innerText:"quark.cn/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?pwd=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"quark.cn/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=|\\?pwd=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/quark.cn\/s\/([0-9a-zA-Z\-_]{8,24})/gi,shareCodeNeedRemoveStr:/quark.cn\/s\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç |password=|pwd=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"quark.cn/s/{#shareCode#}?pwd={#accessCode#}",blank:"https://pan.quark.cn/s/{#shareCode#}?pwd={#accessCode#}",copyUrl:"https://pan.quark.cn/s/{#shareCode#}?pwd={#accessCode#}"}],setting:{name:"å¤¸å…‹ç½‘ç›˜",key:"kuake",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},Sn=()=>({rule:[{link_innerText:"(lanzou[a-z]{0,1}|lan[a-z]{2}).com/(tp/|u/|)([0-9a-zA-Z_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{3,20})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{3,6}|)",link_innerHTML:"(lanzou[a-z]{0,1}|lan[a-z]{2}).com/(tp/|u/|)([0-9a-zA-Z_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{3,20})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{3,6}|)",shareCode:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/(tp\/|u\/|)([0-9a-zA-Z_\-]{5,22}|[%0-9a-zA-Z]{4,90}|[\u4e00-\u9fa5]{3,20})/gi,shareCodeNeedRemoveStr:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/(tp\/|u\/|)/gi,shareCodeExcludeRegular:["lanzouyx"],checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{3,})/gi,uiLinkShow:`${we.hostname}/{#shareCode#} æå–ç : {#accessCode#}`,blank:`https://${we.hostname}/{#shareCode#}`,copyUrl:`https://${we.hostname}/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"(lanzou[a-z]{0,1}|lan[a-z]{2}).com/s/([0-9a-zA-Z_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{3,20})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{3,6}|)",link_innerHTML:"(lanzou[a-z]{0,1}|lan[a-z]{2}).com/s/([0-9a-zA-Z_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{3,20})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{3,6}|)",shareCode:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/s\/([0-9a-zA-Z_\-]{5,22}|[%0-9a-zA-Z]{4,90}|[\u4e00-\u9fa5]{3,20})/gi,shareCodeNeedRemoveStr:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/s\//gi,shareCodeExcludeRegular:["lanzouyx"],checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{3,})/gi,uiLinkShow:`${we.hostname}/s/{#shareCode#} æå–ç : {#accessCode#}`,blank:`https://${we.hostname}/s/{#shareCode#}`,copyUrl:`https://${we.hostname}/s/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"è“å¥äº‘",key:"lanzou",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:false,isForwardBlankLink:false,uri:""},ownFormList:[{text:"å…¶å®ƒé…ç½®",type:"container",views:[re("è“å¥äº‘åŸŸå",we.MENU_KEY,we.DEFAULT_HOST_NAME,"",void 0,`ä¾‹å¦‚ï¼š${we.DEFAULT_HOST_NAME}`)]}]}}}),Rn={rule:[{link_innerText:"ilanzou.com/s/([a-zA-Z0-9_-]{5,22})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç |\\?code=)[\\s\\S]{0,{#matchRange-text-after#}}[a-zA-Z0-9]{3,6}|)",link_innerHTML:"ilanzou.com/s/([a-zA-Z0-9_-]{5,22})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç |\\?code=)[\\s\\S]{0,{#matchRange-html-after#}}[a-zA-Z0-9]{3,6}|)",shareCode:/ilanzou.com\/s\/([a-zA-Z0-9_\-]{5,22})/gi,shareCodeNeedRemoveStr:/ilanzou.com\/s\//gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç |\?code=)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{3,})/gi,uiLinkShow:"www.ilanzou.com/s/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://www.ilanzou.com/s/{#shareCode#}?code={#accessCode#}",copyUrl:"https://www.ilanzou.com/s/{#shareCode#}?code={#accessCode#}"}],setting:{name:"è“å¥äº‘ä¼˜äº«",key:"lanzouyx",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:false,isForwardBlankLink:false,uri:""}}}},An={rule:[{link_innerText:"magnet:\\?xt=urn:btih:[0-9a-fA-F]{32,40}",link_innerHTML:"magnet:\\?xt=urn:btih:[0-9a-fA-F]{32,40}",shareCode:/magnet:\?xt=urn:btih:([0-9a-fA-F]{32,40})/gi,shareCodeNeedRemoveStr:/magnet:\?xt=urn:btih:/gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç )[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"magnet:?xt=urn:btih:{#shareCode#}",blank:"magnet:?xt=urn:btih:{#shareCode#}",copyUrl:"magnet:?xt=urn:btih:{#shareCode#}"}],setting:{name:"BTç£åŠ›",key:"magnet",configurationInterface:{function:{enable:true,linkClickMode:{openBlank:{default:true},"openBlank-closePopup":{enable:true},parseFile:{enable:true,text:"å…ƒæ•°æ®é¢„è§ˆ"},"parseFile-closePopup":{enable:true,text:"å…ƒæ•°æ®é¢„è§ˆ & å…³é—­å¼¹çª—"}}},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},$n={rule:[{link_innerText:"[0-9a-zA-Z-_]+.sharepoint.com/[0-9a-zA-Z-_:]+/[0-9a-zA-Z-_:]+/personal/[0-9a-zA-Z-_]+/[0-9a-zA-Z-_]+([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=\\?e=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]+|)",link_innerHTML:"[0-9a-zA-Z-_]+.sharepoint.com/[0-9a-zA-Z-_:]+/[0-9a-zA-Z-_:]+/personal/[0-9a-zA-Z-_]+/[0-9a-zA-Z-_]+([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=\\?e=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]+|)",shareCode:/[0-9a-zA-Z-_]+\/[0-9a-zA-Z-_:]+\/[0-9a-zA-Z-_:]+\/personal\/[0-9a-zA-Z-_]+\/([0-9a-zA-Z\-_]+)/gi,shareCodeNeedRemoveStr:/[0-9a-zA-Z-_]+\/[0-9a-zA-Z-_:]+\/[0-9a-zA-Z-_:]+\/personal\/[0-9a-zA-Z-_]+\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç |\?password=|\?e=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,8})/gi,paramMatch:/([0-9a-zA-Z-_]+).sharepoint.com\/([0-9a-zA-Z-_:]+)\/([0-9a-zA-Z-_:]+)\/personal\/([0-9a-zA-Z-_]+)\/([0-9a-zA-Z-_]+)/i,uiLinkShow:"{#$1#}.sharepoint.com/{#$2#}/{#$3#}/personal/{#$4#}/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://{#$1#}.sharepoint.com/{#$2#}/{#$3#}/personal/{#$4#}/{#shareCode#}?e={#accessCode#}",copyUrl:`https://{#$1#}.sharepoint.com/{#$2#}/{#$3#}/personal/{#$4#}/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"OneDrive",key:"onedrive",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:false,uri:""}}}},_n={rule:[{link_innerText:"(cloud.189.cn/web/share\\?code=([0-9a-zA-Z_-]){8,14}|cloud.189.cn/t/([a-zA-Z0-9_-]{8,14}))([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"(cloud.189.cn/web/share\\?code=([0-9a-zA-Z_-]){8,14}|cloud.189.cn/t/([a-zA-Z0-9_-]{8,14}))([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/cloud.189.cn\/web\/share\?code=([0-9a-zA-Z_\-]){8,14}|cloud.189.cn\/t\/([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/cloud\.189\.cn\/t\/|cloud.189.cn\/web\/share\?code=/gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"cloud.189.cn/t/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://cloud.189.cn/t/{#shareCode#}",copyUrl:`https://cloud.189.cn/t/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"å¤©ç¿¼äº‘",key:"tianyiyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:false,isForwardBlankLink:false,uri:""}}}},Tn={rule:[{link_innerText:"(drive|fast).uc.cn/s/[0-9a-zA-Z]{8,24}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]+|)",link_innerHTML:"(drive|fast).uc.cn/s/[0-9a-zA-Z]{8,24}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç |\\?password=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]+|)",shareCode:/(drive|fast).uc.cn\/s\/([0-9a-zA-Z]{8,24})/gi,shareCodeNeedRemoveStr:/(drive|fast).uc.cn\/s\//gi,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç )[\s\S]+/gi,accessCode:/([0-9a-zA-Z]+)/gi,uiLinkShow:"drive.uc.cn/s/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://drive.uc.cn/s/{#shareCode#}",copyUrl:`https://drive.uc.cn/s/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"UCç½‘ç›˜",key:"uc",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:false,isForwardBlankLink:false,uri:""}}}},Dn={rule:[{link_innerText:"weiyun.com/[0-9a-zA-Z-_]{7,24}([\\s\\S]{0,{#matchRange-text-before#}}(è®¿é—®ç |å¯†ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"weiyun.com/[0-9a-zA-Z-_]{7,24}([\\s\\S]{0,{#matchRange-html-before#}}(è®¿é—®ç |å¯†ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/weiyun.com\/([0-9a-zA-Z\-_]{7,24})/gi,shareCodeNeedRemoveStr:/weiyun.com\//gi,shareCodeNotMatch:/^(ftn_handler)/,checkAccessCode:/(æå–ç |å¯†ç |è®¿é—®ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"share.weiyun.com/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://share.weiyun.com/{#shareCode#}",copyUrl:`https://share.weiyun.com/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"å¾®äº‘",key:"weiyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},Mn={rule:[{link_innerText:"(wenshushu.cn|wss.ink|ws28.cn|wss1.cn|ws59.cn|wss.cc)/f/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"(wenshushu.cn|wss.ink|ws28.cn|wss1.cn|ws59.cn|wss.cc)/f/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/(wenshushu.cn|wss.ink|ws28.cn|wss1.cn|ws59.cn|wss.cc)\/f\/([a-zA-Z0-9_-]{8,14})/gi,shareCodeNeedRemoveStr:/(wenshushu.cn|wss.ink|ws28.cn|wss1.cn|ws59.cn|wss.cc)\/f\//gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/[0-9a-zA-Z]{4}/gi,uiLinkShow:"www.wenshushu.cn/f/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://www.wenshushu.cn/f/{#shareCode#}",copyUrl:`https://www.wenshushu.cn/f/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`},{link_innerText:"wenshushu.cn/k/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"wenshushu.cn/k/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(å¯†ç |è®¿é—®ç |æå–ç )[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/wenshushu.cn\/k\/([a-zA-Z0-9_-]{8,14})/gi,shareCodeNeedRemoveStr:/wenshushu.cn\/k\//gi,checkAccessCode:/(å¯†ç |è®¿é—®ç |æå–ç )[\s\S]+/g,accessCode:/[0-9a-zA-Z]{4}/gi,uiLinkShow:"www.wenshushu.cn/k/{#shareCode#} æå–ç : {#accessCode#}",blank:"https://www.wenshushu.cn/k/{#shareCode#}",copyUrl:`https://www.wenshushu.cn/k/{#shareCode#}
å¯†ç ï¼š{#accessCode#}`}],setting:{name:"æ–‡å”å”",key:"wenshushu",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:true,isForwardBlankLink:true,uri:""}}}},In={rule:[{link_innerText:"xunlei.com/s/[0-9a-zA-Z-_]{8,30}([\\s\\S]{0,{#matchRange-text-before#}}(\\?pwd=|è®¿é—®ç |æå–ç |å¯†ç |)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"xunlei.com/s/[0-9a-zA-Z-_]{8,30}([\\s\\S]{0,{#matchRange-html-before#}}(\\?pwd=|è®¿é—®ç |æå–ç |å¯†ç |)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/xunlei.com\/s\/([0-9a-zA-Z\-_]{8,30})/gi,shareCodeNeedRemoveStr:/xunlei.com\/s\//gi,checkAccessCode:/(\?pwd=|æå–ç |å¯†ç |è®¿é—®ç )[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"pan.xunlei.com/s/{#shareCode#}?pwd={#accessCode#} æå–ç : {#accessCode#}",blank:"https://pan.xunlei.com/s/{#shareCode#}?pwd={#accessCode#}",copyUrl:"https://pan.xunlei.com/s/{#shareCode#}?pwd={#accessCode#}"}],setting:{name:"è¿…é›·äº‘ç›˜",key:"xunlei",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankAutoFilleAccessCode:true,openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},ft={dataKey:"ruleData",$data:{ruleContent:[]},init(){this.initRule();},initRule(){let t=[bn,Sn,Rn,_n,xn,wn,Mn,Ht,Dn,In,gn,kn,vn,An,yn,Cn,$n,Tn,mn,Zt],e=de.getNetDiskRuleConfig();[...t,...e].forEach(a=>{if(typeof a=="function"&&(a=a()),typeof a.setting.key!="string")throw new Error("è§„åˆ™æœªè®¾ç½®key");if(a.rule==null)throw new Error("è§„åˆ™æœªè®¾ç½®rule");const n=a.setting.key,i=a.setting.name,s=a.rule;if(Reflect.has(V.$rule.ruleOption,n)){let c=V.$rule.ruleOption[n];a.isUserRule?c=[...s,...c]:c=[...c,...s];let u=V.$rule.rule.find(d=>d.setting.key===n);u.rule=c;}else Reflect.set(V.$rule.ruleOption,n,a.rule),V.$rule.rule.push(a);Reflect.set(V.$rule.ruleSetting,n,a.setting),a.rule=this.parseRuleMatchRule(a);let r=this.parseRuleSetting(a),l=a.setting.name;S.$inst.icon.hasIcon(n)&&(l=`
					<div class="netdisk-aside-icon" style="background-image: url(${S.$inst.icon.getIcon(n)});"></div>
					<div class="netdisk-aside-text">${i}</div>`);let o=i;a.isUserRule&&(o+=`
					<div 
						class="netdisk-custom-rule-edit" 
						data-key="${n}" 
						data-type="${a.setting.name}"
						${typeof a.subscribeUUID=="string"?`data-subscribe-uuid="${a.subscribeUUID}"`:""}"
						
					>${z.config.iconSVG.edit}</div>`,o+=`
					<div
						class="netdisk-custom-rule-delete"
						data-key="${n}"
						data-type="${a.setting.name}"
						${typeof a.subscribeUUID=="string"?`data-subscribe-uuid="${a.subscribeUUID}"`:""}"
					>${z.config.iconSVG.delete}</div>`),this.$data.ruleContent.push({id:"netdisk-panel-config-"+n,title:l,headerTitle:o,attributes:{"data-key":n},views:r,afterRender:c=>{c.$asideLiElement.setAttribute("data-function-enable",J.function.enable(n,true).toString());}});});},parseRuleMatchRule(t){let e=t.rule,a=[],n=t.setting.key;for(let i=0;i<e.length;i++){const s=e[i];typeof s.link_innerText=="string"&&(s.link_innerText=le.replaceParam(s.link_innerText,Gt(n))),typeof s.link_innerHTML=="string"&&(s.link_innerHTML=le.replaceParam(s.link_innerHTML,Yt(n))),a.push(s);}return a},parseRuleSetting(t){let e=[];const a=t.setting.configurationInterface,n=t.setting.key;if(a==null)return [];if(a.function){let i=[];if("enable"in a.function){let s=typeof a.function.enable=="boolean"?a.function.enable:false;i.push(Z("å¯ç”¨",O.function.enable(n),s,(r,l)=>{const o="data-function-enable";let d=r.target.getRootNode().querySelector(`.pops-panel-aside li[data-key="${n}"]`);d&&d.setAttribute(o,l.toString());},"å¼€å¯å¯å…è®¸åŒ¹é…è¯¥è§„åˆ™")),a.function.enable=J.function.enable(n);}if("linkClickMode"in a.function){let s=f.assign(le.getDefaultLinkClickMode(),a.function.linkClickMode||{}),r=null,l=[];const o=Object.keys(s);for(const c of o){let u=s[c];u.enable&&(u.default&&(r=c),l.push({value:c,text:u.text}));}r==null&&(r=l[0].value),i.push(Me("ç‚¹å‡»åŠ¨ä½œ",O.function.linkClickMode(n),r,l,void 0,"ç‚¹å‡»åŒ¹é…åˆ°çš„é“¾æ¥çš„æ‰§è¡Œçš„åŠ¨ä½œ"));for(const c in a.function.linkClickMode){const u=a.function.linkClickMode[c];c===J.function.linkClickMode(n)?u.default=true:u.default=false;}}if("checkLinkValidity"in a.function){const s=typeof a.function.checkLinkValidity=="boolean"?a.function.checkLinkValidity:true;i.push(Z("éªŒè¯é“¾æ¥æœ‰æ•ˆæ€§",O.function.checkLinkValidity(n),s,void 0,"è‡ªåŠ¨è¯·æ±‚é“¾æ¥ï¼Œåˆ¤æ–­è¯¥é“¾æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåœ¨å¤§/å°çª—å†…æ˜¾ç¤ºéªŒè¯ç»“æœå›¾æ ‡")),a.function.checkLinkValidity=J.function.checkLinkValidity(n);}if("checkLinkValidityHoverTip"in a.function){const s=typeof a.function.checkLinkValidityHoverTip=="boolean"?a.function.checkLinkValidityHoverTip:true;i.push(Z("éªŒè¯é“¾æ¥æœ‰æ•ˆæ€§-æ‚¬åœæç¤º",O.function.checkLinkValidityHoverTip(n),s,void 0,"å½“é¼ æ ‡æ‚¬åœåœ¨éªŒè¯ç»“æœå›¾æ ‡ä¸Šæ—¶ä¼šæ˜¾ç¤ºç›¸å…³éªŒè¯ä¿¡æ¯"));}i.length&&e.push({text:"åŠŸèƒ½",type:"container",views:i});}if(a.linkClickMode_openBlank){let i=[];if("openBlankAutoFilleAccessCode"in a.linkClickMode_openBlank){const s=typeof a.linkClickMode_openBlank.openBlankAutoFilleAccessCode=="boolean"?a.linkClickMode_openBlank.openBlankAutoFilleAccessCode:true;i.push(Z("è‡ªåŠ¨å¡«å……è®¿é—®ç ",O.linkClickMode_openBlank.openBlankAutoFilleAccessCode(n),s,void 0,"å½“ç‚¹å‡»åŠ¨ä½œæ˜¯ã€æ–°æ ‡ç­¾é¡µæ‰“å¼€ã€‘æ—¶ä¸”å­˜åœ¨è®¿é—®ç ï¼Œé‚£å°±ä¼šè‡ªåŠ¨å¡«å……è®¿é—®ç ")),a.linkClickMode_openBlank.openBlankAutoFilleAccessCode=J.linkClickMode_openBlank.openBlankAutoFilleAccessCode(n);}if("openBlankWithCopyAccessCode"in a.linkClickMode_openBlank){const s=typeof a.linkClickMode_openBlank.openBlankWithCopyAccessCode=="boolean"?a.linkClickMode_openBlank.openBlankWithCopyAccessCode:false;i.push(Z("è·³è½¬æ—¶å¤åˆ¶è®¿é—®ç ",O.linkClickMode_openBlank.openBlankWithCopyAccessCode(n),s,void 0,"å½“ç‚¹å‡»åŠ¨ä½œæ˜¯ã€æ–°æ ‡ç­¾é¡µæ‰“å¼€ã€‘æ—¶ä¸”å­˜åœ¨è®¿é—®ç ï¼Œé‚£å°±ä¼šå¤åˆ¶è®¿é—®ç åˆ°å‰ªè´´æ¿")),a.linkClickMode_openBlank.openBlankWithCopyAccessCode=J.linkClickMode_openBlank.openBlankWithCopyAccessCode(n);}i.length&&e.push({text:"ç‚¹å‡»åŠ¨ä½œ-æ–°æ ‡ç­¾é¡µæ‰“å¼€",type:"container",views:i});}if(a.schemeUri){const i=[];if("enable"in a.schemeUri){const s=typeof a.schemeUri.enable=="boolean"?a.schemeUri.enable:false;i.push(Z("å¯ç”¨",O.schemeUri.enable(n),s,void 0,"å¼€å¯åå¯è¿›è¡Œscheme uriè½¬å‘")),a.schemeUri.enable=J.schemeUri.enable(n);}if("isForwardBlankLink"in a.schemeUri){const s=typeof a.schemeUri.isForwardBlankLink=="boolean"?a.schemeUri.isForwardBlankLink:false;i.push(Z("è½¬å‘æ–°æ ‡ç­¾é¡µé“¾æ¥",O.schemeUri.isForwardBlankLink(n),s,void 0,"å¯¹æ–°æ ‡ç­¾é¡µæ‰“å¼€çš„é“¾æ¥è¿›è¡Œschemeè½¬æ¢")),a.schemeUri.isForwardBlankLink=J.schemeUri.isForwardBlankLink(n);}if("isForwardLinearChain"in a.schemeUri){const s=typeof a.schemeUri.isForwardLinearChain=="boolean"?a.schemeUri.isForwardLinearChain:false;i.push(Z("è½¬å‘ç›´é“¾",O.schemeUri.isForwardLinearChain(n),s,void 0,"å¯¹è§£æçš„ç›´é“¾è¿›è¡Œschemeè½¬æ¢")),a.schemeUri.isForwardLinearChain=J.schemeUri.isForwardLinearChain(n);}if("uri"in a.schemeUri){const s=typeof a.schemeUri.uri=="string"?a.schemeUri.uri:"";i.push(re("Urié“¾æ¥",O.schemeUri.uri(n),s,"è‡ªå®šä¹‰çš„Schemeçš„Urié“¾æ¥",void 0,"jumpwsv://go?package=xx&activity=xx&intentAction=xx&intentData=xx&intentExtra=xx")),a.schemeUri.uri=J.schemeUri.uri(n);}i.length&&e.push({text:"Scheme Uriè½¬å‘",type:"container",isFold:true,views:i});}if(a.matchRange_text){let i=[];if("before"in a.matchRange_text){const s=typeof a.matchRange_text.before=="number"?a.matchRange_text.before:0;i.push(ye("é—´éš”å‰",O.matchRange_text.before(n),s,0,100,void 0,void 0,"æå–ç é—´éš”å‰çš„å­—ç¬¦é•¿åº¦")),a.matchRange_text.before=J.matchRange_text.before(n);}if("after"in a.matchRange_text){const s=typeof a.matchRange_text.after=="number"?a.matchRange_text.after:0;i.push(ye("é—´éš”å",O.matchRange_text.after(n),s,0,100,void 0,void 0,"æå–ç é—´éš”åçš„å­—ç¬¦é•¿åº¦")),a.matchRange_text.after=J.matchRange_text.after(n);}i.length&&e.push({text:"æå–ç æ–‡æœ¬åŒ¹é…Text",type:"container",views:i});}if(a.matchRange_html){let i=[];if("before"in a.matchRange_html){const s=typeof a.matchRange_html.before=="number"?a.matchRange_html.before:0;i.push(ye("é—´éš”å‰",O.matchRange_html.before(n),s,0,100,void 0,void 0,"æå–ç é—´éš”å‰çš„å­—ç¬¦é•¿åº¦")),a.matchRange_html.before=J.matchRange_html.before(n);}if("after"in a.matchRange_html){const s=typeof a.matchRange_html.after=="number"?a.matchRange_html.after:0;i.push(ye("é—´éš”å",O.matchRange_html.after(n),s,0,100,void 0,void 0,"æå–ç é—´éš”åçš„å­—ç¬¦é•¿åº¦")),a.matchRange_html.after=J.matchRange_html.after(n);}i.length&&e.push({text:"æå–ç æ–‡æœ¬åŒ¹é…HTML",type:"container",views:i});}return a.ownFormList&&e.push(...a.ownFormList),e},getRulePanelContent(){return this.$data.ruleContent}},Xt=`div[class^="netdisk-custom-rule-"] {
  display: flex;
  align-items: center;
  margin-left: 10px;
  cursor: pointer;
}
div[class^="netdisk-custom-rule-"] svg,
div[class^="netdisk-custom-rule-"] svg {
  width: 1.2em;
  height: 1.2em;
}
/* æ§ä»¶è¢«ç¦ç”¨çš„é¢œè‰² */
aside.pops-panel-aside li[data-key][data-function-enable="false"] {
  color: #a8abb2;
  filter: grayscale(100%);
}
/* å·¦ä¾§ç½‘ç›˜å›¾æ ‡ */
aside.pops-panel-aside .netdisk-aside-icon {
  width: 20px;
  height: 20px;
  background-size: 100% 100%;
  background-repeat: no-repeat;
}
/* è®¾ç½®é—´éš” */
aside.pops-panel-aside ul li {
  gap: 4px;
}

/* mobileæ¨¡å¼ */
@media screen and (max-width: 600px) {
  /* éšè—å·¦ä¾§ç½‘ç›˜å›¾æ ‡ */
  aside.pops-panel-aside .netdisk-aside-text {
    display: none;
  }
}
`,gt={show(){if(S.$el.$settingView){g.error("è®¾ç½®ç•Œé¢å·²å­˜åœ¨");return}const t=ft.getRulePanelContent(),e=[...Be.getConfig(0),...t,...Be.getDefaultBottomContentConfig()],a=K.panel({title:{text:`${je?.script?.name||$e}-è®¾ç½®`,position:"center"},content:e,btn:{close:{enable:true,callback(n){n.close(),S.$el.$settingView=void 0;}}},mask:{clickCallBack(n){n(),S.$el.$settingView=void 0;}},class:"whitesevPopSetting",style:Xt},S.$config.viewSizeConfig.settingView);F.registerConfigSearch({$panel:a,content:e,searchDialogStyle:`
			/* ç½‘ç›˜å›¾æ ‡ */
			.netdisk-aside-icon {
				width: 20px;
				height: 20px;
				background-size: 100% 100%;
				background-repeat: no-repeat;
				margin: 0px 4px;
			}
		`}),S.$el.$settingView=a,this.setRuleHeaderControlsClickEvent(a.$shadowRoot);},setRuleHeaderControlsClickEvent(t){h.on(t,"click",".netdisk-custom-rule-edit",function(e){const a=e.target,n=a.getAttribute("data-key");a.getAttribute("data-type");const i=a.getAttribute("data-subscribe-uuid");typeof i=="string"&&i.trim()!==""?Ve.showSubscribe(i,n,function(s){de.updateRule(n,s);}):Ve.show(true,n);}),h.on(t,"click",".netdisk-custom-rule-delete",function(e){const a=e.target,n=a.getAttribute("data-key"),i=a.getAttribute("data-type"),s=a.getAttribute("data-subscribe-uuid");K.alert({title:{text:"æç¤º",position:"center"},content:{text:`ç¡®å®šåˆ é™¤è§„åˆ™ ${i}(${n}) å—ï¼Ÿ`},btn:{ok:{callback(r){let l;if(typeof s=="string"&&s.trim()!==""?l=ae.deleteSubscribeRule(s,n):l=de.deleteRule(n),l){const o=S.$el.$settingView.$shadowRoot.querySelector(`.pops-panel-aside > ul > li[data-key="${n}"]`),c=o.previousElementSibling,u=o.nextElementSibling;c?c.click():u&&u.click(),o?.remove(),g.success("åˆ é™¤æˆåŠŸ"),r.close();}else g.error("åˆ é™¤è§„åˆ™å¤±è´¥");}}}});});}},En=`<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">\r
	<path\r
		d="M510.1056 674.2528c-89.1904 0-161.6896-72.5504-161.6896-161.6896s72.5504-161.6896 161.6896-161.6896 161.6896 72.5504 161.6896 161.6896-72.4992 161.6896-161.6896 161.6896z m0-251.7504c-49.664 0-90.0096 40.3968-90.0096 90.0096s40.3968 90.0096 90.0096 90.0096 90.0096-40.3968 90.0096-90.0096-40.3456-90.0096-90.0096-90.0096z"></path>\r
	<path\r
		d="M510.1056 957.5424c-36.1984 0-72.3968-4.4544-107.5712-13.1584a35.88096 35.88096 0 0 1-27.1872-36.352c0.0512-1.2288 0.1024-2.4576 0.1024-3.6864 0-49.664-40.3968-90.0608-90.0608-90.0608-17.2544 0-34.048 4.9152-48.5376 14.2336a35.86048 35.86048 0 0 1-45.0048-5.12c-53.2992-54.5792-91.8528-122.0608-111.5136-195.2256a35.7888 35.7888 0 0 1 19.3024-41.6768c31.3856-14.848 51.6608-46.7968 51.6608-81.4592 0-33.8944-18.7904-64.6144-48.9984-80.128a35.8656 35.8656 0 0 1-17.92-42.3424c20.5824-67.5328 57.7536-130.0992 107.3664-180.9408 11.8784-12.1856 30.72-14.336 45.0048-5.12 14.4896 9.3184 31.2832 14.2336 48.5888 14.2336 49.664 0 90.0608-40.3968 90.0608-90.0096 0-1.28-0.0512-2.5088-0.1024-3.7376a35.82464 35.82464 0 0 1 27.1872-36.3008c72.2944-17.9712 149.504-17.408 221.9008 1.792 16.0768 4.2496 27.136 19.0464 26.624 35.6864l-0.0512 2.6112c0 49.664 40.3968 90.0096 90.0096 90.0096 16.128 0 31.9488-4.352 45.7728-12.4928a35.87072 35.87072 0 0 1 44.1344 5.9904c48.4864 50.432 84.7872 112.2816 104.96 178.8416 5.0176 16.4864-2.4064 34.1504-17.6128 42.1376a89.8048 89.8048 0 0 0-48.2816 79.7696c0 34.3552 20.0192 66.2016 50.944 81.152a35.80928 35.80928 0 0 1 19.0464 41.5232c-19.2512 72.0896-56.9856 138.8544-109.1072 193.0752a35.79904 35.79904 0 0 1-44.0832 5.9904c-13.824-8.192-29.6448-12.4928-45.7216-12.4928-49.664 0-90.0096 40.3968-90.0096 90.0608l0.0512 2.6112a35.8912 35.8912 0 0 1-26.624 35.6864 445.69088 445.69088 0 0 1-114.3296 14.8992z m-64.768-77.3632a375.53664 375.53664 0 0 0 135.936-1.1776c12.1856-77.2096 79.1552-136.3968 159.744-136.3968 18.8416 0 37.4784 3.2768 55.04 9.6768a374.58944 374.58944 0 0 0 66.9184-117.9136c-40.0384-30.208-64.7168-78.2336-64.7168-129.3312 0-49.7152 22.5792-95.744 60.416-126.0544a374.74304 374.74304 0 0 0-62.5664-106.1376 161.34144 161.34144 0 0 1-55.1424 9.6768c-80.5376 0-147.5584-59.1872-159.744-136.3968a376.76032 376.76032 0 0 0-135.936-1.2288C433.664 222.6176 366.3872 282.4704 285.44 282.4704c-20.6336 0-40.9088-3.9424-59.8528-11.4688a375.0912 375.0912 0 0 0-63.8464 107.264c38.4 30.3104 61.2864 76.5952 61.2864 126.7712 0 51.5584-24.9856 99.84-65.5872 129.9968a373.74464 373.74464 0 0 0 68.1984 119.04c18.8928-7.5264 39.168-11.4688 59.8016-11.4688 80.9472 0 148.224 59.8528 159.8976 137.5744z"></path>\r
</svg>\r
`,Ln=`<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">\r
	<path\r
		d="M511.998 64C264.574 64 64 264.574 64 511.998S264.574 960 511.998 960 960 759.422 960 511.998 759.422 64 511.998 64z m353.851 597.438c-82.215 194.648-306.657 285.794-501.306 203.579S78.749 558.36 160.964 363.711 467.621 77.917 662.27 160.132c168.009 70.963 262.57 250.652 225.926 429.313a383.995 383.995 0 0 1-22.347 71.993z"></path>\r
	<path\r
		d="M543.311 498.639V256.121c0-17.657-14.314-31.97-31.97-31.97s-31.97 14.314-31.97 31.97v269.005l201.481 201.481c12.485 12.485 32.728 12.485 45.213 0s12.485-32.728 0-45.213L543.311 498.639z"></path>\r
</svg>\r
`,Nn=`<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">\r
	<path\r
		d="M761.948797 511.939185c0-16.541632-13.500891-30.042523-30.042523-30.042523H542.042395v-189.742249c0-16.541632-13.379261-30.042523-30.042523-30.042523-16.541632 0-30.042523 13.500891-30.042523 30.042523v189.863879H292.09347c-16.541632 0-30.042523 13.500891-30.042523 30.042523 0 8.270816 3.40563 15.811854 8.757335 21.285188 5.473334 5.473334 12.892743 8.757335 21.285188 8.757335h189.863879v189.863879c0 8.270816 3.40563 15.811854 8.757335 21.285188 5.473334 5.473334 12.892743 8.757335 21.285188 8.757335 16.541632 0 30.042523-13.500891 30.042523-30.042523V541.981708h189.863879c16.541632 0 30.042523-13.379261 30.042523-30.042523z m0 0"></path>\r
	<path\r
		d="M780.436504 511.939185c0-17.757928-14.473928-32.231857-32.231857-32.231856H544.353358V275.85604c0-17.757928-14.473928-32.231857-32.231856-32.231857s-32.231857 14.473928-32.231857 32.231857v203.972918H275.916727C258.158799 479.828958 243.684871 494.302886 243.684871 512.060815c0 8.878964 3.648889 17.028151 9.487112 22.866374 5.838223 5.838223 13.86578 9.487112 22.866374 9.487112h203.972918v203.972918c0 8.878964 3.648889 17.028151 9.487113 22.866374 5.838223 5.838223 13.86578 9.487112 22.866373 9.487113 17.757928 0 32.231857-14.473928 32.231857-32.231857V544.292671h203.972918c17.514669 0 31.866968-14.473928 31.866968-32.353486z m0 0"></path>\r
	<path\r
		d="M829.93977 928.034208H194.181604C140.29967 928.034208 96.512997 884.247535 96.512997 830.487231V193.512769c0-53.760304 43.786673-97.546977 97.546977-97.546977H829.93977c53.760304 0 97.546977 43.786673 97.546977 97.546977v636.974462c0.12163 53.760304-43.665043 97.546977-97.546977 97.546977zM194.181604 156.780615C173.869453 156.780615 157.327821 173.322247 157.327821 193.512769v636.974462C157.327821 850.677753 173.869453 867.219385 194.181604 867.219385H829.93977c20.312151 0 36.732153-16.541632 36.732154-36.732154V193.512769c0-20.312151-16.541632-36.732153-36.732154-36.732154H194.181604z"></path>\r
</svg>\r
`,Vn=`<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">\r
	<path\r
		d="M560.104 574.25c0.625-0.64 1.182-1.2 1.67-1.683 24.773-24.465 55.547-42.364 89.471-51.779 1.014-0.281 2.241-0.603 3.682-0.965a16 16 0 0 1 13.64 2.823l1.477 1.134 25.485 19.554h22.942l15.46-11.862 11.457-8.791a16 16 0 0 1 13.692-2.81c3.65 0.93 6.585 1.734 8.803 2.412a206.001 206.001 0 0 1 14.852 5.167 205.45 205.45 0 0 1 69.482 45.108c0.491 0.485 1.05 1.049 1.68 1.692a16 16 0 0 1 4.412 13.355l-0.529 3.863-3.935 28.758 11.471 19.547L892.89 651.5l3.15 1.34a16 16 0 0 1 9.166 10.48c0.38 1.385 0.695 2.575 0.942 3.57A198.992 198.992 0 0 1 912 714.91c0 18.075-2.424 35.85-7.152 52.976-0.204 0.74-0.452 1.6-0.745 2.584a16 16 0 0 1-8.956 10.114l-1.606 0.699-28.225 12.274-11.471 19.547 2.152 24.3 0.645 7.282a16 16 0 0 1-4.654 12.755 179.21 179.21 0 0 1-4.143 4.013A205.62 205.62 0 0 1 762.876 909c-1.373 0.382-3.109 0.83-5.206 1.345a16 16 0 0 1-12.839-2.331l-4.217-2.883-22.143-15.135H695.53l-23.053 15.757-3.288 2.248a16 16 0 0 1-12.864 2.324c-3.02-0.745-5.463-1.389-7.331-1.93a205.604 205.604 0 0 1-83.28-47.352 173.687 173.687 0 0 1-3.705-3.6 16 16 0 0 1-4.65-12.751c0.252-2.85 0.458-5.184 0.62-7.001l2.177-24.587-11.471-19.547-28.313-12.313-1.5-0.652a16 16 0 0 1-8.957-10.116 163.909 163.909 0 0 1-1.291-4.546c-4.38-16.522-6.623-33.632-6.623-51.02 0-17.065 2.16-33.866 6.384-50.11 0.042-0.158 0.193-0.697 0.454-1.615a16 16 0 0 1 9.128-10.347l1.675-0.713 29.043-12.352 11.471-19.547a317416336.627 317416336.627 0 0 0-4.464-32.62 16 16 0 0 1 4.413-13.357z m58.693 51.865l-32.6 57.431-26.86 10.457A155.784 155.784 0 0 0 558 714.416c0 8.177 0.634 16.258 1.884 24.192l26.314 10.244 32.599 57.43-4.232 27.01c11.838 9.538 25.036 17.206 39.159 22.708l20.677-17.064h65.198L760.276 856c14.123-5.502 27.321-13.17 39.16-22.709l-4.233-27.008 32.6-57.431 26.313-10.244A155.435 155.435 0 0 0 856 714.416c0-6.882-0.45-13.696-1.337-20.413l-26.86-10.457-32.6-57.431 4.728-30.173A148.3 148.3 0 0 0 763.181 574L739.6 593.462h-65.198L650.819 574a148.3 148.3 0 0 0-36.75 21.942l4.728 30.173zM707.1 802.289c-48.228 0-87.324-39.096-87.324-87.324s39.096-87.324 87.324-87.324 87.325 39.096 87.325 87.324-39.097 87.324-87.325 87.324z m0-56.938c17.768 0 32.172-14.404 32.172-32.172 0-17.768-14.404-32.172-32.172-32.172-17.768 0-32.172 14.404-32.172 32.172 0 17.768 14.404 32.172 32.172 32.172zM256 348v-56a8 8 0 0 1 8-8h432a8 8 0 0 1 8 8v56a8 8 0 0 1-8 8H264a8 8 0 0 1-8-8z m0 192v-56a8 8 0 0 1 8-8h176a8 8 0 0 1 8 8v56a8 8 0 0 1-8 8H264a8 8 0 0 1-8-8z m0 192v-56a8 8 0 0 1 8-8h176a8 8 0 0 1 8 8v56a8 8 0 0 1-8 8H264a8 8 0 0 1-8-8z m584-548H184v656h288a8 8 0 0 1 8 8v56a8 8 0 0 1-8 8H144c-17.673 0-32-14.327-32-32V144c0-17.673 14.327-32 32-32h736c17.673 0 32 14.327 32 32v328a8 8 0 0 1-8 8h-56a8 8 0 0 1-8-8V184z"></path>\r
</svg>\r
`,Bn=`<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">\r
	<path\r
		d="M648.6016 128c0-18.7904 15.2576-34.048 34.048-34.048H896c18.7904 0 34.048 15.2576 34.048 34.048v213.3504a34.048 34.048 0 1 1-68.096 0V162.048h-179.3024a34.048 34.048 0 0 1-34.048-34.048zM93.952 128c0-18.7904 15.2576-34.048 34.048-34.048h213.3504a34.048 34.048 0 1 1 0 68.096H162.048v179.3024a34.048 34.048 0 1 1-68.096 0V128zM896 648.6016c18.7904 0 34.048 15.2576 34.048 34.048V896a34.048 34.048 0 0 1-34.048 34.048h-213.3504a34.048 34.048 0 0 1 0-68.096h179.3024v-179.3024c0-18.7904 15.2576-34.048 34.048-34.048zM128 648.6016c18.7904 0 34.048 15.2576 34.048 34.048v179.3024h179.3024a34.048 34.048 0 1 1 0 68.096H128a34.048 34.048 0 0 1-34.048-34.048v-213.3504c0-18.7904 15.2576-34.048 34.048-34.048zM322.3552 358.4c0-18.8416 15.3088-34.1504 34.1504-34.1504h310.9888c18.8416 0 34.1504 15.3088 34.1504 34.1504v58.3168a34.1504 34.1504 0 0 1-68.2496 0v-24.1664H390.6048v24.1664a34.1504 34.1504 0 0 1-68.2496 0V358.4zM438.9888 708.2496c0-18.8416 15.3088-34.0992 34.1504-34.0992h77.7216a34.0992 34.0992 0 1 1 0 68.2496H473.1392a34.0992 34.0992 0 0 1-34.1504-34.1504z"></path>\r
	<path\r
		d="M512 363.1616c18.8416 0 34.0992 15.2576 34.0992 34.0992v310.9888a34.0992 34.0992 0 1 1-68.1984 0V397.312c0-18.8416 15.2576-34.0992 34.0992-34.0992z"></path>\r
</svg>\r
`,Un=`<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">\r
	<path\r
		d="M563.2 672c-6.4-6.4 0 0 0 0L448 793.6c-57.6 57.6-153.6 57.6-211.2 0-57.6-57.6-64-147.2 0-211.2l121.6-121.6-6.4-6.4-38.4-32-6.4-6.4-121.6 121.6C108.8 614.4 108.8 755.2 192 832s217.6 83.2 300.8 0l121.6-121.6-6.4-6.4-44.8-32z m38.4-294.4c6.4 0 6.4 0 0 0l38.4 38.4 6.4 6.4-230.4 230.4-38.4-51.2 224-224zM531.2 192c83.2-83.2 217.6-83.2 300.8 0 83.2 83.2 83.2 217.6 0 300.8l-121.6 121.6-44.8-44.8 128-128c44.8-44.8 51.2-147.2-6.4-204.8-57.6-57.6-160-57.6-204.8-6.4l-128 128v-6.4l-38.4-38.4-6.4-6.4L531.2 192z"></path>\r
</svg>\r
`,Lt=`<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">\r
	<path\r
		d="M892 928.1H134c-19.9 0-36-16.1-36-36v-758c0-19.9 16.1-36 36-36h314.1c19.9 0 36 16.1 36 36s-16.1 36-36 36H170v686h686V579.6c0-19.9 16.1-36 36-36s36 16.1 36 36v312.5c0 19.9-16.1 36-36 36z"></path>\r
	<path\r
		d="M927.9 131.6v-0.5c-0.1-1.7-0.4-3.3-0.7-4.9 0-0.1 0-0.2-0.1-0.3-0.4-1.7-0.9-3.3-1.5-4.9v-0.1c-0.6-1.6-1.4-3.1-2.2-4.6 0-0.1-0.1-0.1-0.1-0.2-0.8-1.4-1.7-2.8-2.7-4.1-0.1-0.1-0.2-0.3-0.3-0.4-0.5-0.6-0.9-1.1-1.4-1.7 0-0.1-0.1-0.1-0.1-0.2-0.5-0.6-1-1.1-1.6-1.6l-0.4-0.4c-0.5-0.5-1.1-1-1.6-1.5l-0.1-0.1c-0.6-0.5-1.2-1-1.9-1.4-0.1-0.1-0.3-0.2-0.4-0.3-1.4-1-2.8-1.8-4.3-2.6l-0.1-0.1c-1.6-0.8-3.2-1.5-4.9-2-1.6-0.5-3.3-1-5-1.2-0.1 0-0.2 0-0.3-0.1l-2.4-0.3h-0.3c-0.7-0.1-1.3-0.1-2-0.1H640.1c-19.9 0-36 16.1-36 36s16.1 36 36 36h165L487.6 487.6c-14.1 14.1-14.1 36.9 0 50.9 7 7 16.2 10.5 25.5 10.5 9.2 0 18.4-3.5 25.5-10.5L856 221v162.8c0 19.9 16.1 36 36 36s36-16.1 36-36V134.1c0-0.8 0-1.7-0.1-2.5z"></path>\r
</svg>\r
`,zn=`<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">\r
	<path\r
		d="M288 384v-74.666667c0-123.722667 100.266667-224 224-224s224 100.224 224 224v74.666667h10.677333C811.445333 384 864 436.597333 864 501.333333v320c0 64.821333-52.469333 117.333333-117.322667 117.333334H277.333333C212.554667 938.666667 160 886.069333 160 821.333333V501.333333c0-64.821333 52.469333-117.333333 117.322667-117.333333H288z m64 0h320v-74.666667c0-88.426667-71.605333-160-160-160-88.384 0-160 71.626667-160 160v74.666667zM224 501.333333v320c0 29.397333 23.914667 53.333333 53.322667 53.333334H746.666667A53.269333 53.269333 0 0 0 800 821.333333V501.333333c0-29.397333-23.914667-53.333333-53.322667-53.333333H277.333333A53.269333 53.269333 0 0 0 224 501.333333z"></path>\r
</svg>\r
`,Fn=`<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">\r
	<path\r
		d="M826.92 857.397H197.08c-33.667 0-60.953-27.287-60.953-60.953V349.46c0-33.666 27.286-60.952 60.952-60.952h121.905v-60.952c0-33.666 27.286-60.953 60.953-60.953h243.809c33.666 0 60.952 27.287 60.952 60.953v60.952H826.921c33.666 0 60.952 27.286 60.952 60.952v446.984c0 33.666-27.286 60.953-60.952 60.953zM644.064 247.873c0-22.43-18.204-40.635-40.634-40.635H400.254c-22.43 0-40.635 18.205-40.635 40.635v40.635h284.444v-40.635z m203.175 121.905c0-22.43-18.204-40.635-40.635-40.635H217.397c-22.43 0-40.635 18.204-40.635 40.635v162.54h304.762v-50.794c0-16.823 13.653-30.476 30.476-30.476s30.476 13.653 30.476 30.476v50.793h304.762v-162.54z m0 203.174H542.476v10.16c0 16.842-13.653 30.475-30.476 30.475s-30.476-13.633-30.476-30.476v-10.159H176.762v203.175c0 22.43 18.204 40.635 40.635 40.635h589.206c22.43 0 40.635-18.205 40.635-40.635V572.952z"></path>\r
</svg>\r
`,lt={setGlobalRightClickMenu(t){Je.registerContextMenu(t,void 0,[{text:"è®¾ç½®",icon:En,callback(){m.info("å³é”®èœå•-æ‰“å¼€-"+this.text),gt.show();}},{text:"å†å²åŒ¹é…è®°å½•",icon:Ln,callback(){m.info("å³é”®èœå•-æ‰“å¼€-"+this.text),S.$inst.historyMatch.show();}},{text:"æ·»åŠ é“¾æ¥è¯†åˆ«è§„åˆ™",icon:Nn,callback(){m.info("å³é”®èœå•-æ‰“å¼€-"+this.text),Ve.show(false);}},{text:"è§„åˆ™ç®¡ç†å™¨",icon:Vn,callback(){m.info("å³é”®èœå•-æ‰“å¼€-"+this.text),Qe.showView();}},{text:"ä¸»åŠ¨è¯†åˆ«æ–‡æœ¬",icon:Bn,callback(){m.info("å³é”®èœå•-æ‰“å¼€-"+this.text),S.$inst.matchPasteText.show();}}]);},setRightClickMenu(t,e,a){let n=[{text:"é“¾æ¥",icon:Un,callback(i,s,r,l){return  false},item:[{text:"å¤åˆ¶",icon:"documentCopy",callback:function(i,s,r,l){let o=l;const{ruleKeyName:c,ruleIndex:u,shareCode:d,accessCode:p}=fe.parseBoxAttrRuleInfo(o);Se.copy(c,u,d,p);}},{text:"æ‰“å¼€",icon:Lt,callback:function(i,s,r,l){let o=l;const{ruleKeyName:c,ruleIndex:u,shareCode:d,accessCode:p}=fe.parseBoxAttrRuleInfo(o);let w=ee.getBlankUrl({ruleKeyName:c,ruleIndex:u,shareCode:d,accessCode:p});Se.openBlankUrl(w,c,u,d,p);}},{text:"åå°æ‰“å¼€",icon:Lt,callback:function(i,s,r,l){let o=l;const{ruleKeyName:c,ruleIndex:u,shareCode:d,accessCode:p}=fe.parseBoxAttrRuleInfo(o);let w=ee.getBlankUrl({ruleKeyName:c,ruleIndex:u,shareCode:d,accessCode:p});Se.openBlankUrl(w,c,u,d,p,true);}}]},{text:"å¯†ç ",icon:zn,callback:function(i,s,r){return  false},item:[{text:"å¤åˆ¶",icon:"documentCopy",callback(i,s,r,l){let o=l;const{ruleKeyName:c,ruleIndex:u,shareCode:d,accessCode:p}=fe.parseBoxAttrRuleInfo(o);if(p==null||typeof p=="string"&&p.trim()===""){g.warning("æ— è®¿é—®ç ");return}f.copy(p).then(w=>{w?g.success("å·²å¤åˆ¶"):g.error("æ‰§è¡Œå¤åˆ¶å¤±è´¥",{consoleLogContent:true});}).catch(()=>{g.error("æ‰§è¡Œå¤åˆ¶å¤±è´¥",{consoleLogContent:true});});}},{text:"ä¿®æ”¹",icon:"edit",callback:function(i,s,r,l){let o=l;const{ruleKeyName:c,ruleIndex:u,shareCode:d,accessCode:p}=fe.parseBoxAttrRuleInfo(o);S.$inst.newAccessCodeView(this.text,c,u,d,p,w=>{if(a)if(w.isUpdatedMatchedDict){let b=new Date().getTime(),x=o.closest("li").querySelector(".netdiskrecord-update-time");h.text(x,f.formatTime(b)),h.attr(o,"data-accesscode",w.accessCode),g.success(`
												<div style="text-align: left;">æ—§: ${p}</div>
												<div style="text-align: left;">æ–°: ${w.accessCode}</div>`,{isHTML:true});}else g.error("ä¿®æ”¹å¤±è´¥");else h.attr(o,"data-accesscode",w.accessCode),w.isUpdatedMatchedDict?g.success(`
												<div style="text-align: left;">æ—§: ${p}</div>
												<div style="text-align: left;">æ–°: ${w.accessCode}</div>`,{isHTML:true}):w.isFindInMatchedDict?g.error("ä¿®æ”¹è®¿é—®ç å¤±è´¥"):g.error("ä¿®æ”¹è®¿é—®ç å¤±è´¥ï¼Œå› ä¸ºå½“å‰å·²åŒ¹é…å­—å…¸ä¸­æœªæ‰¾åˆ°å¯¹åº”çš„è®¿é—®ç ");});}}]},{text:"å…¶å®ƒ",icon:Fn,callback(i,s,r,l){return  false},item:[{text:"å¤åˆ¶å…¨éƒ¨",icon:"documentCopy",callback(i,s,r,l){let c=l.closest(".netdisk-url-box-all"),u=[];c.querySelectorAll(e).forEach(d=>{const{ruleKeyName:p,ruleIndex:w,shareCode:b,accessCode:x}=fe.parseBoxAttrRuleInfo(d);let C=ee.getCopyUrlInfo({ruleKeyName:p,ruleIndex:w,shareCode:b,accessCode:x});u.push(C);}),f.copy(u.join(`
`)).then(d=>{d?g.success("æˆåŠŸå¤åˆ¶å…¨éƒ¨"):g.error("å¤åˆ¶å…¨éƒ¨å¤±è´¥");}).catch(()=>{g.error("å¤åˆ¶å…¨éƒ¨å¤±è´¥");});}}]}];a||n[2].item.push({text:"åˆ é™¤å½“å‰",icon:"delete",callback:function(i,s,r,l){let o=l,c=o.closest(".netdisk-url-box");const{ruleKeyName:u,ruleIndex:d,shareCode:p,accessCode:w}=fe.parseBoxAttrRuleInfo(o);let b=false;V.$match.matchedInfo.forEach((x,C)=>{C===u&&x.forEach((R,M)=>{M===p&&(b=true,x.delete(M),m.info("åˆ é™¤ï¼š",C,JSON.stringify(R)));});}),V.$match.matchedInfoRuleKey.clear(),V.$match.matchedInfo.forEach((x,C)=>{x.length&&V.$match.matchedInfoRuleKey.add(C);}),b?c.remove():g.error("å‘ç”Ÿæ„å¤–æƒ…å†µï¼Œæœªåœ¨å·²åŒ¹é…åˆ°çš„ä¿¡æ¯ä¸­åˆ°å¯¹åº”çš„ç½‘ç›˜ä¿¡æ¯");}},{text:"åˆ é™¤æ‰€æœ‰",icon:"delete",callback:function(i,s,r,l){let o=l,c=o.closest(".netdisk-url-box-all");const{ruleKeyName:u,ruleIndex:d,shareCode:p,accessCode:w}=fe.parseBoxAttrRuleInfo(o);V.$match.matchedInfo.forEach((b,x)=>{b.clear();}),V.$match.matchedInfoRuleKey.clear(),h.html(c,"");}}),Je.registerContextMenu(t,e,n);}},Pn=`.whitesevSuspension {
  top: 0;
  position: fixed;
  right: 10px;
  border-radius: 12px;
}
.whitesevSuspension .whitesevSuspensionMain {
  background: #fff;
  border: 1px solid #f2f2f2;
  box-shadow: 0 0 15px #e4e4e4;
  box-sizing: border-box;
  border-radius: inherit;
  height: inherit;
  width: inherit;
}
.whitesevSuspension .whitesevSuspensionFloor {
  border-bottom: 1px solid #f2f2f2;
  position: relative;
  box-sizing: border-box;
  border-radius: inherit;
  height: inherit;
  width: inherit;
}
.whitesevSuspension .whitesevSuspensionFloor .netdisk {
  background-position: center center;
  background-size: 115% 115%;
  background-repeat: no-repeat;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: inherit;
  height: inherit;
  width: inherit;
}
.whitesevSuspension .whitesevSuspensionFloor .netdisk:hover {
  transition: all 300ms linear;
  background-color: #e4e4e4;
  transform: scale(1.1);
}
.whitesevPop-content p[pop] {
  height: 100%;
}
`,ue={position:{suspensionX:Ne("suspensionX",U.width(window)-50),suspensionY:Ne("suspensionY",(U.height(window)-50)/2),suspensionMaxX:Ne("susponsionMax-x",U.width(window)-50),suspensionMaxY:Ne("suspensionMax-y",U.height(window)-50),isRight:Ne("isRight",false)},mode:{current_suspension_smallwindow_mode:Ne("current_suspension_smallwindow_mode","suspension")}},Ge={$el:{$suspension:null,$suspensionZIndexStyle:null},$data:{isShow:false,isInitAllEvent:false,isSwitchBackground:false},init(){this.$data.isShow||(this.$data.isShow=true,this.createElement(),this.updateZIndex(),this.updatePosition(true)),this.$data.isInitAllEvent||(this.$data.isInitAllEvent=true,this.setAllEvent(),this.setResizeEventListener()),this.changeBackground(),this.show();},show(){U.css(this.$el.$suspension,{display:""});},hide(){U.css(this.$el.$suspension,{display:"none"});},createElement(){k.suspension.size.value<15&&(k.suspension.size.value=15),k.suspension.size.value>250&&(k.suspension.size.value=250),k.suspension.opacity.value<.1&&(k.suspension.opacity.value=.1),k.suspension.opacity.value>1&&(k.suspension.opacity.value=1);const t=U.createElement("div",{className:"whitesev-suspension-shadow-container"}),e=t.attachShadow({mode:"open"});this.$el.$suspension=U.createElement("div",{id:"whitesevSuspensionId",className:"whitesevSuspension",innerHTML:`
      <style type="text/css">${Pn}</style>
      <style type="text/css" data-z-index></style>
      <div class="whitesevSuspensionMain">
        <div class="whitesevSuspensionFloor">
          <div class="netdisk"></div>
        </div>
      </div>`}),U.css(this.$el.$suspension,{width:`${k.suspension.size.value}px`,height:`${k.suspension.size.value}px`,opacity:`${k.suspension.opacity.value}`}),this.$el.$suspensionZIndexStyle=this.$el.$suspension.querySelector("style[data-z-index]"),e.appendChild(this.$el.$suspension),(document.body||document.documentElement).appendChild(t);},setAllEvent(){const t=this,e=S.$inst.suspension.$el.$suspension,a=new Ut(e);let n,i=false,s=false,r=0,l=0;a.on("pan",function(o){if(!i){i=true;let c=e.getBoundingClientRect();r=o.x-c.left,l=o.y-c.top,U.css(e,{cursor:"move",transition:"none"});}if(o.phase==="start"&&t.updateZIndex(),o.phase==="move"){const c=U.width(window)-k.suspension.size.value,u=U.height(window)-k.suspension.size.value;let d=o.x-r,p=o.y-l;d=d>c?c:d,p=p>u?u:p,d=d<0?0:d,p=p<0?0:p,Ge.savePosition({x:d,y:p}),U.css(e,{left:d+"px",top:p+"px"});}if(o.phase==="end"){i=false,U.css(e,{cursor:"auto"});const c=parseInt(U.css(e,"left"));if(k.suspension["suspended-button-adsorption-edge"].value){let u=0;c>=U.width(window)/2?(u=U.width(window)-k.suspension.size.value,F.isTopWindow()&&(ue.position.isRight.value=true)):F.isTopWindow()&&(ue.position.isRight.value=false),Ge.savePosition({x:u}),U.css(e,{left:u+"px"});}U.css(e,{transition:"left 300ms ease 0s"}),t.updateZIndex();}}),a.on("tap",function(o){clearTimeout(n),n=void 0,s?(s=false,gt.show()):(n=setTimeout(()=>{s=false,k.features["netdisk-behavior-mode"].value.includes("smallwindow")&&(ue.mode.current_suspension_smallwindow_mode.value="smallwindow",S.$inst.suspension.hide()),S.$inst.linkView.show();},200),s=true);}),lt.setGlobalRightClickMenu(e);},setResizeEventListener(){const t=e=>{const a=e?.localName?.toLowerCase?.();return typeof a=="string"&&["input","textarea"].includes(a)?true:!!(e?.getAttribute?.("contenteditable")==="true"||e?.closest?.("[contenteditable='true']"))};U.on(globalThis,"resize",()=>{if(f.isPhone()){const e=document.activeElement,a=e?.shadowRoot?.activeElement;if(t(a??e))return;if(!document.hasFocus())return  true}this.updatePosition(false);});},savePosition(t){F.isTopWindow()&&t!=null&&(typeof t.x=="number"&&(ue.position.suspensionX.value=t.x),typeof t.y=="number"&&(ue.position.suspensionY.value=t.y),ue.position.suspensionMaxX.value=ue.position.suspensionMaxX.default,ue.position.suspensionMaxY.value=ue.position.suspensionMaxY.default);},updatePosition(t){const e=k.suspension.size.value,a=U.width(window)-e,n=U.height(window)-e,i=ue.position.suspensionMaxX.value,s=ue.position.suspensionMaxY.value;ue.position.suspensionMaxX.default=a,ue.position.suspensionMaxY.default=n;let r=ue.position.suspensionX.value,l=ue.position.suspensionY.value;if(a!==i){let o=r/i;r=a*o;}if(n!==s){let o=l/s;l=n*o;}r>a?r=a:r<0&&(r=0),l>n?l=n:l<0&&(l=0),k.suspension["suspended-button-adsorption-edge"].value&&(ue.position.isRight.value?r=a:r=0),t&&Ge.savePosition({x:r,y:l}),U.css(S.$inst.suspension.$el.$suspension,{left:r+"px",top:l+"px"});},updateZIndex(){let t=k.suspension["suspended-z-index"].value;t<=0&&(t=f.getMaxValue(4e4,f.getMaxZIndex(10))),U.html(this.$el.$suspensionZIndexStyle,`
			#whitesevSuspensionId{
				z-index: ${t};
			}
			`);},changeBackground(){if(this.$data.isSwitchBackground)return;function t(){let r=[];return S.$data.isMatchedNetDiskIconMap.forEach(l=>{r=[...r,S.$inst.icon.getIcon(l)];}),r}function e(r,l){a=t(),U.fadeOut(s,r,function(){n++,n=n<a.length?n:0,l=a[n],U.css(s,{"background-image":`url(${l})`}),U.fadeIn(s,r,function(){setTimeout(()=>{e(parseInt(k.suspension["randbg-time"].value.toString()),l);},parseInt(k.suspension["randbg-show-time"].value.toString()));});});}let a=[],n=0;a=t();let i=a[n],s=S.$inst.suspension.$el.$suspension.querySelector(".whitesevSuspension .netdisk");U.css(s,{"background-image":`url(${i})`}),!(a.length<2||k.suspension["randbg-time"].value<=0)&&(this.$data.isSwitchBackground=true,e(parseInt(k.suspension["randbg-time"].value.toString().toString()),i));}},Nt=`.pops-folder-list .list-name-text {
  max-width: 300px;
}
.netdisk-static-link-onefile .pops-folder-list .list-name-text {
  max-width: 220px;
}
.netdisk-static-link-onefile .pops-mobile-folder-content .pops-folder-list .list-name-text {
  max-width: unset;
}
`,On={oneFile(t){m.success("æˆåŠŸè·å–å•æ–‡ä»¶ç›´é“¾",t),K.folder({title:{text:t.title},folder:[{fileName:t.fileName,fileSize:t.fileSize,fileType:t.fileType??"",createTime:t.fileUploadTime||t.fileLatestTime,latestTime:t.fileLatestTime||t.fileUploadTime,isFolder:false,index:0,async clickEvent(){if(typeof t.clickCallBack=="function"){const e=await t.clickCallBack(t);if(typeof e=="boolean"&&!e)return}return {autoDownload:true,mode:"aBlank",url:t.downloadUrl}}}],btn:{ok:{text:"ä¸‹è½½",async callback(){if(typeof t.clickCallBack=="function"){const e=await t.clickCallBack(t);if(typeof e=="boolean"&&!e)return}window.open(t.downloadUrl,"_blank");}}},class:"netdisk-static-link-onefile",style:Nt},S.$config.viewSizeConfig.oneFileStaticView);},moreFile(t,e=[]){m.success("æ–‡ä»¶è§£æä¿¡æ¯",e);let a=[],n=[],i=[];const s=r=>{if(typeof r=="number")return r;const l=r.match(/([\d]+)/);if(l){const o=Number(l[l.length-1]);if(!isNaN(o)){const c=Date.now();let u=0;if(r.includes("ç§’")?u=c-o*1e3:r.includes("åˆ†")?u=c-o*60*1e3:r.includes("æ—¶")?u=c-o*60*60*1e3:r.includes("å¤©")?u=c-o*24*60*60*1e3:r.includes("æ˜ŸæœŸ")||r.includes("å‘¨)")?u=c-o*24*60*60*1e3*7:r.includes("æœˆ")?u=c-o*30*24*60*60*1e3:r.includes("å¹´")&&(u=c-o*365*24*60*60*1e3),u)return f.formatTime(u,"yyyy-MM-dd")}}return r};e.forEach(r=>{r.isFolder?i.push(r):(typeof r.createTime=="string"&&(r.createTime=s(r.createTime)),typeof r.latestTime=="string"&&(r.latestTime=s(r.latestTime)),n.push(r));}),n.sort((r,l)=>r.fileName.localeCompare(l.fileName)),i.sort((r,l)=>r.fileName.localeCompare(l.fileName)),a=a.concat(i),a=a.concat(n),K.folder({title:{text:t},folder:a,btn:{ok:{enable:false},cancel:{enable:true}},style:Nt},S.$config.viewSizeConfig.moreFileStaticView);}},Hn=function(t="å¯†ç é”™è¯¯",e="",a,n,i,s=()=>{},r){const l=K.prompt({title:{text:t,position:"center",html:false},btn:{reverse:true,position:"end",cancel:{text:"å–æ¶ˆ",callback(o,c){l.close(),r?.();}},close:{callback(o,c){o.close(),r?.();}},ok:{callback:o=>{let c=o.text.replace(/[\s]*/gi,""),u=V.handleLinkShow({ruleKeyName:e,ruleIndex:a,shareCode:n,accessCode:c});if(!u)return;let d=`.netdisk-url a[data-rule-key='${e}'][data-sharecode='${n}']`,p=`.netdiskrecord-link a[data-rule-key='${e}'][data-sharecode='${n}']`,w=S.$el.$linkView?.$shadowRoot?.querySelector(d),b=S.$el.$historyView?.$shadowRoot?.querySelector(p);w&&(w.setAttribute("data-accesscode",c),h.html(w,u)),b&&(b.setAttribute("data-accesscode",c),h.html(b,u)),m.info(`${e} é‡æ–°è¾“å…¥çš„å¯†ç ï¼š${c}`);let x={isFindInMatchedDict:false,isUpdatedMatchedDict:false,isUpdatedHistoryMatched:false,accessCode:c},C=V.$match.matchedInfo.get(e);if(C.has(n)){x.isFindInMatchedDict=true,x.isUpdatedMatchedDict=true;let R=C.get(n);C.set(n,V.createLinkStorageInst(c,a,true,R.matchText));}x.isUpdatedHistoryMatched=ht.syncAccessCode(e,a,n,c),s(x),o.close(),r?.();}}},content:{placeholder:"è¯·é‡æ–°è¾“å…¥å¯†ç ",focus:true,select:true,text:i==null?"":typeof i=="string"?i:""},style:`
			input{
				font-size: larger;
			}
			`},S.$config.viewSizeConfig.inputNewAccessCodeView);h.onKeyboard(l.$shadowRoot,"keypress",o=>{o==="Enter"&&l.$shadowRoot.querySelector(".pops-prompt-btn-ok").click();});},jn=`.pops[type-value="confirm"] .pops-confirm-content {
  overflow: hidden;
}
.netdisk-match-paste-text {
  --textarea-bd-color: #dcdfe6;
  display: inline-block;
  resize: vertical;
  padding: 5px 15px;
  line-height: normal;
  box-sizing: border-box;
  color: #606266;
  border: 1px solid var(--textarea-bd-color);
  border-radius: 4px;
  transition: border-color 0.2s cubic-bezier(0.645, 0.045, 0.355, 1);
  outline: none;
  margin: 0;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  background: none;
  width: 100%;
  height: 100%;
  appearance: none;
  resize: none;
}
.netdisk-match-paste-text:hover {
  --textarea-bd-color: #c0c4cc;
}
.netdisk-match-paste-text:focus {
  --textarea-bd-color: #3677f0;
}
`,Kn={show(){let t=K.confirm({title:{text:"ä¸»åŠ¨è¯†åˆ«æ–‡æœ¬",position:"center"},content:{text:`
                    <textarea class="netdisk-match-paste-text"></textarea>
                    `,html:true},btn:{ok:{text:"è¯†åˆ«",callback(){let e=t.$pops?.querySelector(".netdisk-match-paste-text")?.value||"";e.trim()!==""&&(e=le.replaceChinese(e),q.postMessage({characterMapping:[{searchValue:/[\u4e00-\u9fa5]/g,replaceValue:""}],textList:[e],matchTextRange:k.match.pageMatchRange.value,matchedRuleOption:V.$rule.ruleOption,startTime:Date.now(),from:"PasteText"}));}}},class:"whitesevPopNetDiskMatchPasteText",style:jn},S.$config.viewSizeConfig.matchPasteTextView);t.$pops.querySelector("textarea").focus();},workerMatchEndCallBack(t){t.data.length?g.success(`æˆåŠŸåŒ¹é…${t.data.length}ä¸ªï¼Œç”¨æ—¶${Date.now()-t.startTime}ms`):g.error("æœªè¯†åˆ«åˆ°é“¾æ¥");}},Zn={src:new Ce.Dictionary,hasIcon(t){return this.src.has(t)},addIcon(t,e){return this.hasIcon(t)?(m.warn("å›¾æ ‡å­—å…¸ä¸­å·²å­˜åœ¨è¯¥iconï¼š"+t),false):this.src.set(t,e)},getIcon(t){return this.src.get(t)},assign(t){const e=Object.keys(t);for(let a=0;a<e.length;a++){const n=e[a],i=t[n];this.addIcon(n,i);}}},S={$el:{$linkView:void 0,$historyView:void 0,$settingView:void 0},$inst:{suspension:Ge,linkView:fe,linearChainDialogView:On,newAccessCodeView:Hn,historyMatch:ht,matchPasteText:Kn,icon:Zn},$data:{isMatchedNetDiskIconMap:new Set,isForbiddenScrollByDefault:false},$config:{viewSizeConfig:ga}},qn=`/* å®¹å™¨ */
.website-rule-container {
}
/* æ¯ä¸€æ¡è§„åˆ™ */
.website-rule-item {
  display: flex;
  align-items: center;
  line-height: normal;
  font-size: 16px;
  padding: 4px 4px;
  gap: 6px;
}
/* è§„åˆ™å */
.website-rule-item .website-rule-name {
  flex: 1;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
/* æ“ä½œæŒ‰é’® */
.website-rule-item .website-controls {
  display: flex;
  align-items: center;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
  gap: 8px;
  padding: 0px 4px;
}
/* ç¼–è¾‘å’Œåˆ é™¤æŒ‰é’® */
.website-rule-item .website-rule-edit,
.website-rule-item .website-rule-delete {
  width: 16px;
  height: 16px;
  cursor: pointer;
}
/* å¯ç”¨æŒ‰é’® */
.website-rule-item .website-rule-enable {
}
/* ç¼–è¾‘æŒ‰é’® */
.website-rule-item .website-rule-edit {
}
/* åˆ é™¤æŒ‰é’® */
.website-rule-item .website-rule-delete {
}
`;function Qt(t){if(t===null||typeof t!="object")return t;let e=Array.isArray(t)?[]:{};for(let a in t)t.hasOwnProperty(a)&&(e[a]=Qt(t[a]));return e}const De=new ze("websiteRule"),xe={$data:{STORAGE_KEY:"rule",EXPORT_CONFIG_KEY:"rule-export-config",isShowEditView:false},init(){},getTemplateData(){return {uuid:f.generateUUID(),subscribeUUID:null,enable:true,name:"",url:"",data:{}}},getRulePanelViewOption(t){const e=this;let a=z.config.PanelHandlerComponents(),n=()=>t??this.getTemplateData(),i=function(o){return {get(c,u){return o[c]??u},set(c,u){o[c]=u;}}};const s=(o,c,u)=>{e.$data.isShowEditView=true,c||(o=n());function d(y){return {get(v,$){if(u){let D=Y.getSubscribeRule(u,y);return Reflect.get(D.data,v)??$}else {let D=e.getRule(y)??n(),E=F.getValue(v,$);return (D&&Reflect.get(D.data,v))??E}},set(v,$){if(u){let D=Y.getSubscribeRule(u,y);Reflect.set(D.data,v,$),Y.updateSubscribeRule(u,D);}else {let D=e.getRule(y)??n();Reflect.set(D.data,v,$),e.updateRule(D);}}}}let p=document.createDocumentFragment(),w=Z("å¯ç”¨","enable",true);Reflect.set(w.props,j,i(o));let b=a.createSectionContainerItem_switch(w).$el,x=re("è§„åˆ™åç§°","name","","",void 0,"å¿…å¡«");Reflect.set(x.props,j,i(o));let C=a.createSectionContainerItem_input(x).$el,R=re("åŒ¹é…ç½‘å€","url","","",void 0,"å¿…å¡«ï¼Œå¯æ­£åˆ™");Reflect.set(R.props,j,i(o));let M=a.createSectionContainerItem_input(R).$el,T=Ct("è¦†ç›–è®¾ç½®","","è‡ªå®šä¹‰",void 0,false,false,"primary",y=>{h.preventEvent(y);let v=[...Be.getConfig(0),...ft.getRulePanelContent()],$=Qt(v);function D(E){E.forEach(I=>{if(typeof I?.props=="object"&&Reflect.has(I.props,j)){let H=d(o.uuid);Reflect.set(I.props,j,H);}let N=I.views;N&&Array.isArray(N)&&D(N);});}for(let E=0;E<$.length;E++){let I=$[E];if(!I.views)continue;if(typeof I.afterRender=="function"&&I?.id.toString().startsWith("netdisk-panel-config-")&&(I.afterRender=H=>{let W=Reflect.get(H.asideConfig.attributes,"data-key"),X=O.function.enable(W);if(u){let oe=Y.getSubscribeRule(u,o.uuid);H.$asideLiElement.setAttribute("data-function-enable",oe.data[X]??true);}else H.$asideLiElement.setAttribute("data-function-enable",c?xe.getRuleDataValue(o.uuid,X,true):o.data[X]??true);}),typeof I.attributes=="object"&&I.views!=null&&be in I.attributes){let H=I.attributes[be],W=Z("å¯ç”¨",rt.features.customAccessCodeEnable(H),false,void 0,"å¯ç”¨åå°†å…è®¸æ‰§è¡Œä¸‹é¢çš„åŠŸèƒ½");Reflect.set(W.props,j,d(o.uuid));let X=re("è‡ªå®šä¹‰è®¿é—®ç ",rt.features.customAccessCode(H),"","è®©è·å–çš„åˆ°çš„é“¾æ¥çš„è®¿é—®ç éƒ½ä¸ºè‡ªå®šä¹‰çš„è®¿é—®ç ",void 0,"è¯·è¾“å…¥è‡ªå®šä¹‰è®¿é—®ç ");Reflect.set(X.props,j,d(o.uuid));let oe={text:"é¢å¤–åŠŸèƒ½",type:"container",views:[W,X]};I.views.length?I.views.splice(1,0,oe):I.views.push(oe);}let N=I.views;N&&Array.isArray(N)&&D(N);}K.panel({title:{text:"è¦†ç›–è®¾ç½®",position:"center"},content:$,btn:{close:{enable:true,callback(E){E.close();}}},mask:{clickCallBack(E){E();}},only:false,class:"whitesevPopSetting",style:`
              ${Xt}
              
              ${qn}


              /* éšè—é¡¶éƒ¨çš„å›¾æ ‡ */
              .netdisk-custom-rule-edit,
              .netdisk-custom-rule-delete,
              /* éšè—å¿«æ·é”®è®¾ç½®èœå•ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯å…¨å±€å”¯ä¸€çš„ */
              .netdisk-panel-forms-shortcut-keys-deepMenu{
                display: none !important;
              }`},S.$config.viewSizeConfig.settingView);},void 0),_=a.createSectionContainerItem_button(T).$el;return p.appendChild(b),p.appendChild(C),p.appendChild(M),p.appendChild(_),p},r=(o,c,u)=>{let d=o.querySelectorAll(".rule-form-ulist > li"),p=n();if(c){p.uuid=u.uuid;let b=this.getAllRule().find(x=>x.uuid===p.uuid);b&&(p.data=b.data);}return d.forEach(w=>{let b=Reflect.get(w,a.$data.nodeStoreConfigKey),x=Reflect.get(b,"attributes"),C=Reflect.get(w,j),R=Reflect.get(x,be);if(R==null)return;let M=Reflect.get(x,Re),T=C.get(R,M);Reflect.has(p,R)?Reflect.set(p,R,T):Reflect.has(p.data,R)?Reflect.set(p.data,R,T):m.error(`${R}ä¸åœ¨æ•°æ®ä¸­`);}),p.name==null||p.name.trim()===""?(g.error("è§„åˆ™åç§°ä¸èƒ½ä¸ºç©º"),{success:false,data:p}):p.url.trim()===""?(g.error("åŒ¹é…ç½‘å€ä¸èƒ½ä¸ºç©º"),{success:false,data:p}):c?{success:this.updateRule(p),data:p}:{success:this.addRule(p),data:p}};return {id:"website-rule",title:"ç½‘ç«™è§„åˆ™",ruleOption:{btnControls:{add:{enable:true},filter:{enable:true,option:[{name:"æ— ",value:"",selectedCallBack(o){},filterCallBack(o){return  true}},{name:"å·²å¯ç”¨",value:"enable",selectedCallBack(o){},filterCallBack(o){return o.data.enable}},{name:"æœªå¯ç”¨",value:"notEnable",selectedCallBack(o){},filterCallBack(o){return !o.data.enable}},{name:"åœ¨å½“å‰ç½‘å€ç”Ÿæ•ˆ",value:"workInCurrentUrl",selectedCallBack(o){},filterCallBack(o){return e.checkRuleMatch(o)}}],inputOption:[{name:"è§„åˆ™å",value:"name",selectedCallBack(o){},filterCallBack(o,c){const u=o.name;return typeof u=="string"?!!u.match(c):false}},{name:"ç½‘å€",value:"url",selectedCallBack(o){},filterCallBack(o,c){return !!o.url.match(c)}}]},clearAll:{enable:true,callback:()=>{e.deleteAllRule();}},import:{enable:true,callback:o=>{e.importRule(()=>{o();});}},export:{enable:true,callback:()=>{e.exportRule($e+"-ç½‘ç«™è§„åˆ™.json",$e+"-ç½‘ç«™è§„åˆ™-è®¢é˜…æ¨¡å¼.json");}},ruleEnable:{enable:true,getEnable(o){return o.enable},callback:(o,c)=>{o.enable=c,e.updateRule(o);}},ruleEdit:{enable:true,getView:s,onsubmit:r},ruleDelete:{enable:true,deleteCallBack:o=>e.deleteRule(o.uuid)}},data:()=>this.getAllRule(),getAddData:()=>n(),getData:o=>this.getAllRule().find(d=>d.uuid===o.uuid)??o,getDataItemName:o=>o.name??o.url,updateData:o=>this.updateRule(o),deleteData:o=>(e.$data.isShowEditView=false,this.deleteRule(o.uuid))},subscribe:{enable:true,data(){return Y.getAllSubscribe()},getData:o=>Y.getSubscribe(o.uuid)??o,getDataItemName(o){return `
						<style>
							.subscribe-rule-title-info-wrapper{
								display: flex;
								flex-direction: column;
								gap: 4px;
							}
							.subscribe-rule-title-info-wrapper .rule-name-text{
								white-space: nowrap;
								text-overflow: ellipsis;
								overflow: hidden;
								font-weight: 600;
								font-size: 16px;
								line-height: 24px;
							}
							.subscribe-rule-title-info-wrapper .subscribe-rule-small-span-text{
								font-size: 14px;
								line-height: 16px;
								white-space: pre-wrap;
							}
						</style>
						<div class="subscribe-rule-title-info-wrapper">
							<div class="rule-name-text" style="white-space: nowrap;text-overflow: ellipsis;overflow: hidden;font-size: 16px;font-weight: 600;line-height: 24px;">${o.data.title||o.subscribeData.title||o.data.url}</div>
								<div class="subscribe-rule-small-span-text">${o.subscribeData.ruleData.length} æ¡è§„åˆ™ï¼Œæ›´æ–°äºï¼š${f.formatTime(o.data.latestUpdateTime,"yyyyå¹´MMæœˆddæ—¥ HH:mm:ss")}${typeof o.data.updateFailedTime=="number"?`ï¼Œ<span style="color: red;">æ›´æ–°å¤±è´¥äºï¼š${f.formatTime(o.data.updateFailedTime,"yyyyå¹´MMæœˆddæ—¥ HH:mm:ss")}</span>`:""}</div>
								${o.subscribeData.homePage?`<a href="${o.subscribeData.homePage}" class="subscribe-rule-small-span-text" target="_blank" style="color:#67b279;">è½¬åˆ°ä¸»é¡µ</a>`:""}
								<a href="${o.data.url}" class="subscribe-rule-small-span-text" target="_blank" style="color:#67b279;">è®¢é˜…åœ°å€</a>
						</div>`},addData:o=>Y.addSubscribe(o),updateData:o=>Y.updateSubscribe(o),deleteData:o=>Y.deleteSubscribe(o),btnControls:{add:{enable:true},filter:{enable:true,option:[{name:"æ— ",value:"",selectedCallBack(o){},filterCallBack(o){return  true}},{name:"å·²å¯ç”¨",value:"enable",selectedCallBack(o){},filterCallBack(o){return o.data.enable}},{name:"æœªå¯ç”¨",value:"notEnable",selectedCallBack(o){},filterCallBack(o){return !o.data.enable}}],inputOption:[{name:"æ ‡é¢˜",value:"name",selectedCallBack(o){},filterCallBack(o,c){let u=false;return typeof o.data.title=="string"&&(u=!!o.data.title.match(c)),!u&&typeof o.subscribeData.title=="string"&&(u=!!o.subscribeData.title.match(c)),u}},{name:"è®¢é˜…åœ°å€",value:"url",selectedCallBack(o){},filterCallBack(o,c){return !!o.data.url.match(c)}}]},clearAll:{enable:true,callback:()=>{Y.deleteAllSubscribe();}},ruleEnable:{enable:true,getEnable(o){return o.data.enable},async callback(o,c){o.data.enable=c,Y.updateSubscribe(o);}},ruleEdit:{enable:true,callback:o=>{let c=o.ruleData.uuid;return o.enterDeepMenu({headerTitle:o.ruleData.data.title||o.ruleData.subscribeData.title||o.ruleData.data.url,data(){return Y.getSubscribe(c)?.subscribeData?.ruleData??o.ruleData.subscribeData.ruleData},getData(u){return Y.getSubscribeRule(c,u.uuid)??u},getDataItemName(u){return u.name??u.url},addData(u){return  true},updateData(u){return Y.updateSubscribeRule(c,u)},deleteData(u){return Y.deleteSubscribeRule(c,u)},btnControls:{filter:{enable:true,option:[{name:"æ— ",value:"",selectedCallBack(u){},filterCallBack(u){return  true}},{name:"å·²å¯ç”¨",value:"enable",selectedCallBack(u){},filterCallBack(u){return u.data.enable}},{name:"æœªå¯ç”¨",value:"notEnable",selectedCallBack(u){},filterCallBack(u){return !u.data.enable}}],inputOption:[{name:"è§„åˆ™å",value:"name",selectedCallBack(u){},filterCallBack(u,d){const p=u.name;return typeof p=="string"?!!p.match(d):false}},{name:"ç½‘å€",value:"url",selectedCallBack(u){},filterCallBack(u,d){return !!u.url.match(d)}}]},clearAll:{enable:true,callback:()=>{Y.clearSubscribe(c);}},ruleEnable:{enable:true,getEnable(u){return u.enable},callback(u,d){u.data.enable=d,Y.updateSubscribeRule(c,u);}},ruleEdit:{enable:true,getView:(u,d)=>s(u,d,c),onsubmit:r},ruleDelete:{enable:true,deleteCallBack(u){return Y.deleteSubscribeRule(c,u)}}}}),false}},ruleDelete:{enable:true,deleteCallBack:o=>Y.deleteSubscribe(o)},import:{enable:true,callback(o){Y.importSubscribe(()=>{o();});}},export:{enable:true,callback(){Y.exportSubscribe($e+"-ç½‘ç«™è§„åˆ™-è®¢é˜….json");}}},getSubscribeInfo:Y.getSubscribeInfo.bind(Y)}}},addRule(t){const e=this.getAllRule();return e.push(t),De.set(this.$data.STORAGE_KEY,e),true},getRule(t){const e=this.getAllRule().find(n=>n.uuid===t);return e||Y.getAllSubscribeRule().find(n=>n.uuid===t)},getRuleData(t){return typeof t=="string"?this.getRule(t).data:t.data},getRuleDataValue(t,e,a){const n=this.getRuleData(t);return (n&&Reflect.get(n,e))??a},updateRule(t){const e=this.getAllRule();let a=false;for(let n=0;n<e.length;n++)if(e[n].uuid===t.uuid){e[n]=t,a=true;break}return a?De.set(this.$data.STORAGE_KEY,e):Y.getAllSubscribeRule().find(i=>i.uuid===t.uuid)&&(a=Y.updateSubscribeRule(t.subscribeUUID,t)),a},deleteRule(t){const e=this.getAllRule();let a=false;const n=typeof t=="string"?t:t.uuid;for(let i=0;i<e.length;i++)if(e[i].uuid===n){e.splice(i,1),a=true;break}if(a)De.set(this.$data.STORAGE_KEY,e);else {const i=Y.getAllSubscribeRule().find(s=>s.uuid===n);i&&(a=Y.deleteSubscribeRule(i.subscribeUUID,i));}return a},deleteAllRule(){De.delete(this.$data.STORAGE_KEY);},getAllRule(){return De.get(this.$data.STORAGE_KEY,[])},checkRuleMatch(t,e=window.location.href){const a=new RegExp(t.url,"ig");return !!e.match(a)},getUrlMatchedRule(t=true,e=window.location.href){let a=this.getAllRule();const n=Y.getAllSubscribeRule(true);return a=a.concat(n),a.filter(s=>t&&!s.enable?false:this.checkRuleMatch(s,e))},exportRule(t="rule.json",e="rule-subscribe.json"){const a=K.alert({title:{text:"è¯·é€‰æ‹©å¯¼å‡ºæ–¹å¼",position:"center"},content:{text:`
                    <div class="btn-control" data-mode="only-export-rule-list">å¯¼å‡ºè§„åˆ™</div>
                    <div class="btn-control" data-mode="export-to-subscribe">å¯¼å‡ºè®¢é˜…è§„åˆ™</div>
                `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(r,l){r.close();}}},mask:{enable:true},drag:true,width:P.info.width,height:P.info.height,style:`
                .btn-control{
                    display: inline-block;
                    margin: 10px;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    cursor: pointer;
                }
				.btn-control:hover{
					color: #409eff;
					border-color: #c6e2ff;
					background-color: #ecf5ff;
				}
            `});let n=a.$shadowRoot.querySelector(".btn-control[data-mode='only-export-rule-list']"),i=a.$shadowRoot.querySelector(".btn-control[data-mode='export-to-subscribe']"),s=(r,l)=>{let o=new Blob([JSON.stringify(l,null,4)]),c=window.URL.createObjectURL(o),u=document.createElement("a");u.href=c,u.download=r,u.click(),setTimeout(()=>{window.URL.revokeObjectURL(c);},1500);};h.on(n,"click",r=>{h.preventEvent(r);try{let l=this.getAllRule();if(l.length===0){g.warning("è§„åˆ™ä¸ºç©ºï¼Œæ— éœ€å¯¼å‡º");return}s(t,l),a.close();}catch(l){g.error(l.toString(),{consoleLogContent:true});}}),h.on(i,"click",r=>{h.preventEvent(r);const l=this;a.close();try{if(this.getAllRule().length===0){g.warning("è§„åˆ™ä¸ºç©ºï¼Œæ— éœ€å¯¼å‡º");return}let c=z.config.PanelHandlerComponents(),u=function(y){return {get(v,$){return y[v]??$},set(v,$){y[v]=$,De.set(l.$data.EXPORT_CONFIG_KEY,y);}}},d=()=>{let y=De.get(this.$data.EXPORT_CONFIG_KEY,{});if(y?.title===""||y.title==null){g.error("è®¢é˜…æ ‡é¢˜ä¸èƒ½ä¸ºç©º");return}if(y.version==null){g.error("ç‰ˆæœ¬å·ä¸èƒ½ä¸ºç©º");return}else y.version=Number(y.version);y.homePage==null&&(y.homePage=void 0),y.lastModified=Date.now(),y.ruleData=this.getAllRule(),s(e,y),p.close();},p=K.alert({title:{text:"è¯·å¡«å†™å¯¼å‡ºé…ç½®",position:"center"},content:{text:`
							
						`,html:!0},btn:{ok:{enable:!0,text:"å¯¼å‡º",callback(y,v){d();}},close:{enable:!0,callback(y,v){y.close();}}},mask:{enable:!0},drag:!0,width:P.info.width,height:P.info.height,style:`
						${z.config.cssText.panelCSS}

						.pops-alert-content li{
							list-style-type: none;
							display: flex;
							align-items: center;
							justify-content: space-between;
							margin: 10px;
						}
					`}),w=p.$shadowRoot.querySelector(".pops-alert-content"),b=De.get(this.$data.EXPORT_CONFIG_KEY,{}),x=re("è®¢é˜…æ ‡é¢˜","title","");Reflect.set(x.props,j,u(b));let C=c.createSectionContainerItem_input(x).$el,R=re("ç‰ˆæœ¬å·","version","");Reflect.set(R.props,j,u(b));let M=c.createSectionContainerItem_input(R).$el,T=re("ä¸»é¡µåœ°å€","homePage","","",void 0,"é€‰å¡«");Reflect.set(T.props,j,u(b));let _=c.createSectionContainerItem_input(T).$el;h.append(w,C),h.append(w,M),h.append(w,_);}catch(o){g.error(o.toString(),{consoleLogContent:true});}});},importRule(t){let e=K.alert({title:{text:"è¯·é€‰æ‹©å¯¼å…¥æ–¹å¼",position:"center"},content:{text:`
                    <div class="btn-control" data-mode="local">æœ¬åœ°å¯¼å…¥</div>
                    <div class="btn-control" data-mode="network">ç½‘ç»œå¯¼å…¥</div>
                    <div class="btn-control" data-mode="clipboard">å‰ªè´´æ¿å¯¼å…¥</div>
                `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(l,o){l.close();}}},mask:{enable:true},drag:true,width:P.info.width,height:P.info.height,style:`
                .btn-control{
                    display: inline-block;
                    margin: 10px;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    cursor: pointer;
                }
				.btn-control:hover{
					color: #409eff;
					border-color: #c6e2ff;
					background-color: #ecf5ff;
				}
            `}),a=e.$shadowRoot.querySelector(".btn-control[data-mode='local']"),n=e.$shadowRoot.querySelector(".btn-control[data-mode='network']"),i=e.$shadowRoot.querySelector(".btn-control[data-mode='clipboard']"),s=l=>{let o=this.getAllRule(),c=[];for(let u=0;u<l.length;u++){const d=l[u];o.findIndex(w=>w.uuid===d.uuid)!==-1||c.push(d);}o=o.concat(c),De.set(this.$data.STORAGE_KEY,o),g.success(`å…± ${l.length} æ¡è§„åˆ™ï¼Œæ–°å¢ ${c.length} æ¡`),t?.();},r=l=>new Promise(o=>{let c=f.toJSON(l);if(!Array.isArray(c)){m.error(c),g.error("å¯¼å…¥å¤±è´¥ï¼Œæ ¼å¼ä¸ç¬¦åˆï¼ˆä¸æ˜¯æ•°ç»„ï¼‰",{consoleLogContent:true}),o(false);return}if(!c.length){g.error("å¯¼å…¥å¤±è´¥ï¼Œè§£æå‡ºçš„æ•°æ®ä¸ºç©º",{consoleLogContent:true}),o(false);return}s(c),o(true);});h.on(a,"click",l=>{h.preventEvent(l),e.close();let o=h.createElement("input",{type:"file",accept:".json"});h.on(o,["propertychange","input"],c=>{if(!o.files?.length)return;let u=o.files[0],d=new FileReader;d.onload=()=>{r(d.result);},d.readAsText(u,"UTF-8");}),o.click();}),h.on(n,"click",l=>{h.preventEvent(l),e.close();let o=K.prompt({title:{text:"ç½‘ç»œå¯¼å…¥",position:"center"},content:{text:"",placeholder:"è¯·å¡«å†™URL",focus:true},btn:{close:{enable:true,callback(d,p){d.close();}},ok:{text:"å¯¼å…¥",callback:async(d,p)=>{let w=d.text;if(f.isNull(w)){g.error("è¯·å¡«å…¥å®Œæ•´çš„url");return}let b=g.loading("æ­£åœ¨è·å–é…ç½®..."),x=await L.get(w,{allowInterceptConfig:false});if(b.close(),!x.status){m.error(x),g.error("è·å–é…ç½®å¤±è´¥",{consoleLogContent:true});return}await r(x.data.responseText)&&d.close();}},cancel:{enable:false}},mask:{enable:true},drag:true,width:P.info.width,height:"auto"}),c=o.$shadowRoot.querySelector("input"),u=o.$shadowRoot.querySelector(".pops-prompt-btn-ok");h.on(c,["input","propertychange"],d=>{h.val(c)===""?h.attr(u,"disabled","true"):h.removeAttr(u,"disabled");}),h.onKeyboard(c,"keydown",(d,p,w)=>{d==="Enter"&&w.length===0&&h.val(c)!==""&&h.emit(u,"click");}),h.emit(c,"input");}),h.on(i,"click",async l=>{h.preventEvent(l),e.close();let o=await f.getClipboardInfo();if(o.error!=null){g.error(o.error.toString());return}if(o.content.trim()===""){g.warning("è·å–åˆ°çš„å‰ªè´´æ¿å†…å®¹ä¸ºç©º");return}await r(o.content);});}},Wn=(t,e,a)=>{if(xe.$data.isShowEditView)return e??a;let i=xe.getUrlMatchedRule().find(s=>{let r=xe.getRuleData(s);return Reflect.has(r,t)});return i?Reflect.get(xe.getRuleData(i),t):e??a},Gn=function(t,e,a){return {get KEY(){return t},get default(){return e},get value(){let n=ie(t,this.default);return typeof a=="function"?a(t,n,this.default):n},set value(n){he(t,n);}}},B=function(t,e){return Gn(t,e,Wn)},k={toast:{position:B("qmsg-config-position","top"),maxnums:B("qmsg-config-maxnums",3),showreverse:B("qmsg-config-showreverse",true)},pops:{popsAnimation:B("popsAnimation","pops-anim-fadein-zoom"),clickMaskToCloseDialog:B("clickMaskToCloseDialog",true),pcDrag:B("pcDrag",true),pcDragLimit:B("pcDragLimit",true),popsAcrylic:B("popsAcrylic",false)},popsFolder:{"pops-folder-sort-name":B("pops-folder-sort-name","fileName"),"pops-folder-sort-is-desc":B("pops-folder-sort-is-desc",false)},smallIconNavgiator:{"pops-netdisk-icon-click-event-find-sharecode":B("pops-netdisk-icon-click-event-find-sharecode",true),"pops-netdisk-icon-click-event-find-sharecode-with-select":B("pops-netdisk-icon-click-event-find-sharecode-with-select",true),"pops-netdisk-icon-click-event-loop-find-sharecode":B("pops-netdisk-icon-click-event-loop-find-sharecode",true)},suspension:{size:B("size",50),opacity:B("opacity",1),"randbg-time":B("randbg-time",1500),"randbg-show-time":B("randbg-show-time",1200),"suspended-button-adsorption-edge":B("suspended-button-adsorption-edge",true),"suspended-z-index":B("suspended-z-index",-1)},smallWindow:{"netdisk-ui-small-window-width":B("netdisk-ui-small-window-width",250),"netdisk-ui-small-window-max-height":B("netdisk-ui-small-window-max-height",200),"netdisk-link-view-z-index":B("netdisk-link-view-z-index",-1),"netdisk-ui-link-view-data-paging-enable":B("netdisk-ui-link-view-data-paging-enable",false),"netdisk-ui-link-view-data-paging-show-data-count":B("netdisk-ui-link-view-data-paging-show-data-count",10)},historyMatch:{saveMatchNetDisk:B("saveMatchNetDisk",false),"netdisk-history-match-ordering-rule":B("netdisk-history-match-ordering-rule","æŒ‰ æ›´æ–°æ—¶é—´ - é™åº"),"netdisk-history-match-merge-same-link":B("netdisk-history-match-merge-same-link",true)},match:{pageMatchRange:B("pageMatchRange",["innerText","innerHTML"]),depthQueryWithShadowRoot:B("depthQueryWithShadowRoot",false),readClipboard:B("readClipboard",false),allowMatchLocationHref:B("allowMatchLocationHref",true),toBeMatchedWithInputElementValue:B("to-be-matched-inputElementValue",false),toBeMatchedTextAreaElementValue:B("to-be-matched-textAreaElementValue",false),toBeMatchedXhrHookResponseText:B("to-be-matched-xhrHookResponseText",false),delaytime:B("delaytime",.8),isAddedNodesToMatch:B("isAddedNodesToMatch",false),"mutationObserver-childList":B("mutationObserver-childList",true),"mutationObserver-characterData":B("mutationObserver-characterData",true),"mutationObserver-subtree":B("mutationObserver-subtree",true)},features:{"netdisk-match-mode":B("netdisk-match-mode","MutationObserver"),"netdisk-behavior-mode":B("netdisk-behavior-mode","suspension_smallwindow"),autoFillAccessCode:B("autoFillAccessCode",true)},shareCode:{excludeIdenticalSharedCodesCoefficient:B("excludeIdenticalSharedCodesCoefficient",1),excludeIdenticalSharedCodes:B("excludeIdenticalSharedCodes",false)},accessCode:{allowQueryHistoryMatchingAccessCode:B("allowQueryHistoryMatchingAccessCode",true)}},V={$data:{isMatchedLink:false,clipboardText:""},$match:{matchedInfo:new Ce.Dictionary,blackMatchedInfo:new Ce.Dictionary,tempMatchedInfo:new Ce.Dictionary,matchedInfoRuleKey:new Set},$rule:{ruleOption:{},ruleSetting:{},rule:[]},$extraRule:{shareCodeNotMatchRegExpList:[/vipstyle|notexist|ajax|file|download|ptqrshow|xy-privacy/g,/comp|web|undefined|1125|unproved|console|account|favicon|setc/g],accessCodeNotMatchRegExpList:[/^(font|http)/gi],accessCodeNeedRemoveStr:["ï¼š"," ",":",`
`,"æå–ç ","å¯†ç ","?password=","?pwd=","&pwd=","?p=","è®¿é—®ç "],noAccessCodeRegExp:[/( |æå–ç :|\nå¯†ç ï¼š)/gi,/{#accessCode#}/gi,/{#encodeURI-accessCode#}|{#encodeURIComponent-accessCode#}/gi,/{#decodeURI-accessCode#}|{#decodeURIComponent-accessCode#}/gi,/(\?pwd=|&pwd=|\?password=|\?p=)/gi]},init(){this.initLinkDict();},initLinkDict(){Object.keys(this.$rule.ruleOption).forEach(i=>{this.$match.matchedInfo.set(i,new f.Dictionary),this.$match.blackMatchedInfo.set(i,new f.Dictionary),this.$match.tempMatchedInfo.set(i,new f.Dictionary);});const e=xe.getUrlMatchedRule(),a=F.isTopWindow()?"":"iframeï¼š";e.length&&(m.info(`${a}æˆåŠŸå‘½ä¸­çš„ç½‘ç«™è§„åˆ™ ==> `,e),Ke.add({key:"matchedUrlRuleList"+a,text:`${a}ğŸŒ å‘½ä¸­ç½‘ç«™è§„åˆ™ ${e.length} æ¡`,autoReload:false,isStoreValue:false,showText(i){return i},callback:()=>{m.info(`${a}å½“å‰ç½‘å€ï¼š`+self.location.href);const i=[],s=[];e.forEach(l=>{l.subscribeUUID?s.push(l):i.push(l);});let r="";i.length&&(r+=["=====â†“â†“â†“ ä»¥ä¸‹æ˜¯æœ¬åœ°çš„è§„åˆ™å â†“â†“â†“====="].concat(i.map(l=>l.name??l.url)).join(`
`)),s.length&&(r+=`


`,r+=["=====â†“â†“â†“ ä»¥ä¸‹æ˜¯è®¢é˜…çš„è§„åˆ™å â†“â†“â†“====="].concat(s.map(l=>l.name??l.url)).join(`
`)),m.info(r),globalThis.alert(r);}}));const n=dt.getUrlMatchedRule();n.length&&(m.info(`${a}æˆåŠŸå‘½ä¸­çš„å­—ç¬¦è§„åˆ™ ==> `,n),Ke.add({key:"characterMapping",text:`${a}ğŸŒ å‘½ä¸­å­—ç¬¦è§„åˆ™ ${n.length} æ¡`,autoReload:false,isStoreValue:false,showText(i){return i},callback:()=>{m.info(`${a}å½“å‰ç½‘å€ï¼š`+self.location.href);const i=[],s=[];n.forEach(l=>{l.subscribeUUID?s.push(l):i.push(l);});let r="";i.length&&(r+=["=====â†“â†“â†“ ä»¥ä¸‹æ˜¯æœ¬åœ°çš„è§„åˆ™å â†“â†“â†“====="].concat(i.map(l=>l.name??l.data.url)).join(`
`)),s.length&&(r+=`


`,r+=["=====â†“â†“â†“ ä»¥ä¸‹æ˜¯è®¢é˜…çš„è§„åˆ™å â†“â†“â†“====="].concat(s.map(l=>l.name??l.data.url)).join(`
`)),m.info(r),globalThis.alert(r);}}));},handleLink(t){const e=this.handleShareCode(t);if(f.isNull(e))return;let a=this.handleAccessCode(t);return a=this.handleAccessCodeByUserRule({...t,accessCode:a}),{shareCode:e,accessCode:a}},handleShareCode(t){const e=t?.debugConfig?.config??this.$rule.ruleOption[t.ruleKeyName][t.ruleIndex],a=t.matchText.match(e.shareCode)?.filter(s=>f.isNotNull(s));if(t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: shareCode","ä½œç”¨: è·å–shareCode","ç»“æœ: ",JSON.stringify(a)]}),f.isNull(a)){t.debugConfig?.logCallBack?.({status:false,msg:"åŒ¹é…shareCodeä¸ºç©º"});return}let n=a[0];if(t.debugConfig?.logCallBack?.({status:true,msg:["å–ç¬¬ä¸€ä¸ªå€¼: "+n]}),e.shareCodeNeedRemoveStr){let s=e.shareCodeNeedRemoveStr;Array.isArray(s)||(s=[s]);for(const r of s)n=n.replace(r,"");s.length&&t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: shareCodeNeedRemoveStr","ä½œç”¨: åˆ é™¤ShareCodeå‰é¢ä¸éœ€è¦çš„å­—ç¬¦ä¸²",`ç»“æœ: ${n}`]});}for(const s of V.$extraRule.shareCodeNotMatchRegExpList)if(n.match(s)){t.debugConfig?.logCallBack?.({status:false,msg:["æ­£åˆ™: å†…ç½®çš„shareCodeNotMatchRegExpList","ä½œç”¨: ä½¿ç”¨è¯¥æ­£åˆ™åˆ¤æ–­æå–åˆ°çš„shareCodeæ˜¯å¦æ­£ç¡®","ç»“æœ: true è¯¥shareCodeä¸æ˜¯æ­£ç¡®çš„"]});return}let i=e.shareCodeNotMatch;if(i!=null){Array.isArray(i)||(i=[i]);for(const s of i)if(n.match(s)){t.debugConfig?.logCallBack?.({status:false,msg:["æ­£åˆ™: shareCodeNotMatch","ä½œç”¨: ç”¨äºåˆ¤æ–­æå–åˆ°çš„shareCodeæ˜¯å¦æ˜¯é”™è¯¯çš„shareCode","ç»“æœ: true è¯¥shareCodeä¸æ˜¯æ­£ç¡®çš„"]});return}}if(n=decodeURI(n),t.debugConfig?.logCallBack?.({status:true,msg:["å¯¹shareCodeè¿›è¡Œè§£ç : "+n]}),k.shareCode.excludeIdenticalSharedCodes.value&&f.isSameChars(n,k.shareCode.excludeIdenticalSharedCodesCoefficient.value)){t.debugConfig?.logCallBack?.({status:false,msg:["å·²å¼€å¯ã€æ’é™¤åˆ†äº«ç ã€‘ä¸”è¯¥åˆ†äº«ç å‘½ä¸­è¯¥è§„åˆ™"]});return}if(n.endsWith("http")||n.endsWith("https")){t.debugConfig?.logCallBack?.({status:false,msg:["è¯¥åˆ†äº«ç ä»¥http|httpsç»“å°¾"]});return}return t.debugConfig?.logCallBack?.({status:true,msg:"å¤„ç†å®Œæ¯•çš„shareCode: "+n}),n},handleAccessCode(t){const e=t.debugConfig?.config??this.$rule.ruleOption[t.ruleKeyName][t.ruleIndex];let a="";if(!e.checkAccessCode)return t.debugConfig?.logCallBack?.({status:true,msg:"å› æœªé…ç½®è§„åˆ™checkAccessCodeï¼Œé»˜è®¤accessCodeçš„å€¼ä¸ºç©º"}),"";const n=t.matchText.match(e.checkAccessCode);if(t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: checkAccessCode","ä½œç”¨: ç”¨æ¥åˆ¤æ–­link_innerTextæˆ–è€…link_innerHTMLåŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨å¯†ç ","ç»“æœ: ",JSON.stringify(n)]}),n){const i=n[n.length-1];t.debugConfig?.logCallBack?.({status:true,msg:"å–æœ€åä¸€ä¸ªå€¼: "+i});const s=i.match(e.accessCode)?.filter(r=>f.isNotNull(r));if(t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: accessCode","ä½œç”¨: ç”¨æ¥æå–link_innerTextæˆ–è€…link_innerHTMLåŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ä¸­çš„å¯†ç ","ç»“æœ: ",JSON.stringify(s)]}),f.isNull(s))return t.debugConfig?.logCallBack?.({status:true,msg:"å› â†‘åŒ¹é…åˆ°çš„ç»“æœä¸ºç©ºï¼Œé»˜è®¤accessCodeçš„å€¼ä¸ºç©º"}),"";s.length&&(a=s[0],t.debugConfig?.logCallBack?.({status:true,msg:"å–ç¬¬ä¸€ä¸ªå€¼: "+a}));}if(f.isNotNull(a)){for(const r of V.$extraRule.accessCodeNotMatchRegExpList)if(a.match(r)){a="",t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: å†…ç½®çš„accessCodeNotMatchRegExpList","ä½œç”¨: ä½¿ç”¨è¯¥æ­£åˆ™åˆ¤æ–­æå–åˆ°çš„accessCodeæ˜¯å¦æ­£ç¡®","ç»“æœ: true é‡ç½®accessCodeä¸ºç©º"]});break}let i=e.acceesCodeNotMatch;if(i){Array.isArray(i)||(i=[i]);for(const r of i)if(a.match(r)){a="",t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: acceesCodeNotMatch","ä½œç”¨: ç”¨äºåˆ¤æ–­æå–åˆ°çš„accessCodeæ˜¯å¦æ˜¯é”™è¯¯çš„accessCode","ç»“æœ: true é‡ç½®accessCodeä¸ºç©º"]});break}}for(const r of V.$extraRule.accessCodeNeedRemoveStr)a=We.replaceText(a,r,"");t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: å†…ç½®çš„accessCodeNeedRemoveStr","ä½œç”¨: ç”¨äºå¤„ç†æå–åˆ°çš„accessCodeåˆ é™¤éƒ¨åˆ†ä¸éœ€è¦çš„å­—ç¬¦ä¸²",`ç»“æœ: ${a}`]});const s=e.accessCodeNeedRemoveStr;s&&(a=We.replaceText(a,s,""),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: accessCodeNeedRemoveStr","ä½œç”¨: ç”¨äºå¤„ç†æå–åˆ°çš„accessCodeåˆ é™¤éƒ¨åˆ†ä¸éœ€è¦çš„å­—ç¬¦ä¸²","ç»“æœ: true é‡ç½®accessCodeä¸ºç©º"]}));}return t.debugConfig?.logCallBack?.({status:true,msg:"å¤„ç†å®Œæ¯•çš„accessCode: "+a}),a},handleAccessCodeByUserRule(t){const e=xe.getUrlMatchedRule();let a=t.accessCode;for(let n=0;n<e.length;n++){const i=e[n],s=xe.getRuleData(i),r=Reflect.get(s,rt.features.customAccessCode(t.ruleKeyName));if(Reflect.get(s,rt.features.customAccessCodeEnable(t.ruleKeyName))&&typeof r=="string"){a=r;break}}return a},handleLinkShow(t){if(!(t.debugConfig?.config?true:this.checkHasRuleOption(t.ruleKeyName,t.ruleIndex))){m.error(`BUG: ${t.ruleKeyName}ä¸å­˜åœ¨ï¼Œåˆ†æå‚æ•°`,t),(t.showToast??true)&&g.error(`è§„åˆ™ï¼š${t.ruleKeyName}ä¸å­˜åœ¨`);return}const a=t.debugConfig?.config??V.$rule.ruleOption[t.ruleKeyName][t.ruleIndex];let n=le.replaceParam(a.uiLinkShow,{shareCode:t.shareCode});if(t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: uiLinkShow","ä½œç”¨: ç”¨äºæ˜¾ç¤ºåœ¨å¼¹çª—ä¸­çš„å­—ç¬¦ä¸²","å¤‡æ³¨: å¯¹shareCodeè¿›è¡Œå‚æ•°æ›¿æ¢",`ç»“æœ: ${n}`]}),typeof t.accessCode=="string"&&t.accessCode.trim()!=""?(n=le.replaceParam(n,{accessCode:t.accessCode}),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: uiLinkShow","ä½œç”¨: ç”¨äºæ˜¾ç¤ºåœ¨å¼¹çª—ä¸­çš„å­—ç¬¦ä¸²","å¤‡æ³¨: å¯¹accessCodeè¿›è¡Œå‚æ•°æ›¿æ¢",`ç»“æœ: ${n}`]})):(n=We.replaceText(n,V.$extraRule.noAccessCodeRegExp,""),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: å†…ç½®çš„noAccessCodeRegExp","ä½œç”¨: å› accessCodeä¸ºç©ºï¼Œä½¿ç”¨è¯¥æ­£åˆ™å»é™¤ä¸éœ€è¦çš„å­—ç¬¦ä¸²",`ç»“æœ: ${n}`]})),a.paramMatch){const i=V.$match.matchedInfo.get(t.ruleKeyName).get(t.shareCode);if(t.matchText=t.matchText??i?.matchText,f.isNotNull(t.matchText)){const s=t.matchText.match(a.paramMatch),r={};if(s)for(let l=0;l<s.length;l++)r[`$${l}`]=s[l];n=le.replaceParam(n,r),t.debugConfig?.logCallBack?.({status:true,msg:["æ­£åˆ™: paramMatch","ä½œç”¨: ç”¨äºå¯¹matchTextè¿›è¡Œæå–éœ€è¦çš„å…³é”®å†…å®¹ï¼Œæ›¿æ¢å…³é”®å­—ï¼š{#$1#}ã€{#$2#}...","å‚æ•°: "+JSON.stringify(r,void 0,4),`ç»“æœ: ${n}`]});}}return t.debugConfig?.logCallBack?.({status:true,msg:"å¤„ç†å®Œæ¯•çš„uiLink: "+n}),n},createLinkStorageInst(t,e=0,a=false,n){return {accessCode:t,ruleIndex:e,isForceAccessCode:a,matchText:n,matchTime:performance.now()}},checkHasRuleOption(t,e){const a=V.$rule.ruleOption?.[t];return !(!Array.isArray(a)||typeof e=="number"&&(e<0||a.length<=e))}};class Yn{KEY="short-cut";#e={otherShortCutOptions:[],localOptions:[],currentWaitEnterPressInstanceHandler:null};#t={isWaitPress:false};constructor(e){typeof e=="string"&&(this.KEY=e),this.initData();}initConfig(e,a){this.hasOption(e)||this.setOption(e,a);}initData(e){this.#e.localOptions.length=0,this.#e.localOptions=e??this.getLocalAllOptions();}initGlobalKeyboardListener(e,a){if(!this.#e.localOptions.length){m.warn("å¿«æ·é”®é…ç½®ä¸ºç©º");return}const n=this,i=function(l,o){h.onKeyboard(l,"keydown",async(c,u,d,p)=>{if(n.#t.isWaitPress)return;a?.isPrevent&&h.preventEvent(p);const b=JSON.stringify({keyName:c,keyValue:u,ohterCodeList:d}),x=n.#e.localOptions.find(C=>{const R=C.value;if(JSON.stringify(R)===b)return  true});if(x&&x.key in o){if(m.info("è°ƒç”¨å¿«æ·é”®",x),typeof a?.beforeCallBack=="function"){const R=await a.beforeCallBack();if(typeof R=="boolean"&&!R)return}const C=o[x.key].callback;await C();}},{capture:!!a?.capture});},s={},r={};Object.keys(e).forEach(l=>{const o=e[l];(o.target==null||typeof o.target=="string"&&o.target==="")&&(o.target="window"),o.target==="window"?Reflect.set(s,l,o):Reflect.set(r,l,o);}),i(window,s),h.onReady(()=>{Object.keys(r).forEach(async l=>{const o=r[l],c={};let u=null;typeof o.target=="string"?u=await h.waitNode(o.target,1e4):typeof o.target=="function"?u=await o.target():u=o.target,u&&(Reflect.set(c,l,o),i(u,c));});});}isWaitKeyboardPress(){return this.#t.isWaitPress}getStorageKey(){return this.KEY}getLocalAllOptions(){return ie(this.KEY,[])}hasOption(e){return !!this.getLocalAllOptions().find(i=>i.key===e)}hasOptionValue(e){return this.hasOption(e)?this.getOption(e)?.value!=null:false}getOption(e,a){return this.getLocalAllOptions().find(s=>s.key===e)??a}setOption(e,a){const n=this.getLocalAllOptions(),i=n.findIndex(s=>s.key===e);i==-1?n.push({key:e,value:a}):Reflect.set(n[i],"value",a),this.initData(n),he(this.KEY,n);}emptyOption(e){let a=false;const n=this.getLocalAllOptions(),i=n.findIndex(s=>s.key===e);return i!==-1&&(n[i].value=null,a=true),this.initData(n),he(this.KEY,n),a}deleteOption(e){let a=false;const n=this.getLocalAllOptions(),i=n.findIndex(s=>s.key===e);return i!==-1&&(n.splice(i,1),a=true),this.initData(n),he(this.KEY,n),a}translateKeyboardValueToButtonText(e){let a="";return e.ohterCodeList.forEach(n=>{a+=f.stringTitleToUpperCase(n,true)+" + ";}),e.keyName===" "?a+=f.stringTitleToUpperCase("space"):a+=f.stringTitleToUpperCase(e.keyName),a}getShowText(e,a){if(this.hasOption(e)){const n=this.getOption(e);return n.value==null?a:this.translateKeyboardValueToButtonText(n.value)}else return a}async enterShortcutKeys(e){return this.#t.isWaitPress=true,new Promise(a=>{const n=h.onKeyboard(window,"keyup",(i,s,r)=>{const l={keyName:i,keyValue:s,ohterCodeList:r};let o={};try{const c=JSON.stringify(l);let u=this.getLocalAllOptions();Array.isArray(this.#e.otherShortCutOptions)&&(u=u.concat(this.#e.otherShortCutOptions));for(let d=0;d<u.length;d++){let p=u[d];if(p.key===e)continue;const w=JSON.stringify(p.value);let b=!1;if(p.value!=null&&c===w&&(b=!0),b){o={status:!1,key:p.key,option:l};return}}this.setOption(e,l),o={status:!0,key:e,option:l};}catch(c){m.error(c),o={status:false,key:e,option:l};}finally{typeof this.#e.currentWaitEnterPressInstanceHandler=="function"&&this.#e.currentWaitEnterPressInstanceHandler(),this.#e.currentWaitEnterPressInstanceHandler=null,a(o);}});this.#e.currentWaitEnterPressInstanceHandler=null,this.#e.currentWaitEnterPressInstanceHandler=()=>{this.#t.isWaitPress=false,n.removeListen(),this.#e.currentWaitEnterPressInstanceHandler=null;};})}cancelEnterShortcutKeys(){typeof this.#e.currentWaitEnterPressInstanceHandler=="function"&&this.#e.currentWaitEnterPressInstanceHandler();}}const Ae={shortCut:new Yn("GM_shortcut"),init(){this.shortCut.initGlobalKeyboardListener(this.getShortCutMap());},getShortCutMap(){return {"netdisk-keyboard-open-setting":{target:"window",callback:()=>{m.info("å¿«æ·é”® ==> ã€æ‰“å¼€ã€‘âš™ è®¾ç½®"),gt.show();}},"netdisk-keyboard-open-history-matching-records":{target:"window",callback:()=>{m.info("å¿«æ·é”® ==> ã€æ‰“å¼€ã€‘âš™ å†å²åŒ¹é…è®°å½•"),S.$inst.historyMatch.show();}},"netdisk-keyboard-open-user-rule":{target:"window",callback:()=>{m.info("å¿«æ·é”® ==> ã€æ‰“å¼€ã€‘âš™ é“¾æ¥è¯†åˆ«è§„åˆ™"),Ve.show(false);}},"netdisk-keyboard-open-proactively-recognize-text":{target:"window",callback:()=>{m.info("å¿«æ·é”® ==> ã€æ‰“å¼€ã€‘âš™ ä¸»åŠ¨è¯†åˆ«æ–‡æœ¬"),S.$inst.matchPasteText.show();}},"netdisk-keyboard-performPageTextMatchingManually":{target:"window",callback(){m.info("å¿«æ·é”® ==> æ‰§è¡Œæ–‡æœ¬åŒ¹é…"),q.$flag.dispatchMonitorDOMChange=true;}},"netdisk-keyboard-character-mapping":{target:"window",callback(){m.info("å¿«æ·é”® ==> ã€æ‰“å¼€ã€‘âš™ å­—ç¬¦æ˜ å°„è§„åˆ™"),Qe.showView("å­—ç¬¦æ˜ å°„");}},"netdisk-keyboard-identifyTheSelectedContent":{target:"window",callback(){m.info("å¿«æ·é”® ==> è¯†åˆ«é€‰ä¸­å†…å®¹");const{text:t,html:e}=qe.getSelectContent();m.info("é€‰ä¸­çš„å†…å®¹ä¿¡æ¯ï¼š",[t,e]),q.postMessage({characterMapping:[],textList:[t,e],matchTextRange:k.match.pageMatchRange.value,matchedRuleOption:V.$rule.ruleOption,startTime:Date.now(),from:"ShortCut-Select-Content"});}}}}},Jn=()=>({id:"netdisk-panel-config-all-setting",title:"è®¾ç½®",headerTitle:"æ€»è®¾ç½®",isDefault:true,views:[{type:"container",text:"",views:[{type:"deepMenu",text:"Toast",views:[{type:"container",text:"",className:"netdisk-panel-forms-toast",views:[Me("ä½ç½®",k.toast.position.KEY,k.toast.position.default,[{value:"topleft",text:"å·¦ä¸Šè§’"},{value:"top",text:"é¡¶éƒ¨"},{value:"topright",text:"å³ä¸Šè§’"},{value:"left",text:"å·¦è¾¹"},{value:"center",text:"ä¸­é—´"},{value:"right",text:"å³è¾¹"},{value:"bottomleft",text:"å·¦ä¸‹è§’"},{value:"bottom",text:"åº•éƒ¨"},{value:"bottomright",text:"å³ä¸‹è§’"}],void 0,`Toastæ˜¾ç¤ºåœ¨ä¹å®«æ ¼çš„ä½ç½®ï¼Œé»˜è®¤: ${k.toast.position.default}`),Me("åŒæ—¶æœ€å¤šæ˜¾ç¤ºçš„æ•°é‡",k.toast.maxnums.KEY,k.toast.maxnums.default,[{value:1,text:"1"},{value:2,text:"2"},{value:3,text:"3"},{value:4,text:"4"},{value:5,text:"5"}],void 0,`é»˜è®¤: ${k.toast.maxnums.default}`),Z("é€†åºå¼¹å‡º",k.toast.showreverse.KEY,k.toast.showreverse.value,void 0,"é»˜è®¤æ˜¯è‡ªä¸Šå¾€ä¸‹æ˜¾ç¤ºToastï¼Œé€†åºåˆ™æ˜¯è‡ªä¸‹å¾€ä¸Šæ˜¾ç¤ºToast")]}]},{type:"deepMenu",text:"å¼¹çª—",views:[{className:"netdisk-panel-forms-pops",type:"container",text:"",views:[Me("åŠ¨ç”»",k.pops.popsAnimation.KEY,k.pops.popsAnimation.default,[{value:"",text:"æ— "},{value:"pops-anim-spread",text:"spread"},{value:"pops-anim-shake",text:"shake"},{value:"pops-anim-rolling-left",text:"rolling-left"},{value:"pops-anim-rolling-right",text:"rolling-right"},{value:"pops-anim-slide-top",text:"slide-top"},{value:"pops-anim-slide-bottom",text:"slide-bottom"},{value:"pops-anim-slide-left",text:"slide-left"},{value:"pops-anim-slide-right",text:"slide-right"},{value:"pops-anim-fadein",text:"fadein"},{value:"pops-anim-fadein-zoom",text:"fadein-zoom"},{value:"pops-anim-fadein-alert",text:"fadein-alert"},{value:"pops-anim-don",text:"don"},{value:"pops-anim-roll",text:"roll"},{value:"pops-anim-sandra",text:"sandra"},{value:"pops-anim-gather",text:"gather"}],void 0,`æ˜¾ç¤º/å…³é—­çš„åŠ¨ç”»æ•ˆæœï¼Œé»˜è®¤: ${k.pops.popsAnimation.default}`),Z("ç‚¹å‡»å¼¹çª—é®ç½©å±‚å…³é—­å¼¹çª—",k.pops.clickMaskToCloseDialog.KEY,k.pops.clickMaskToCloseDialog.default,void 0,"ç‚¹å‡»é®ç½©å±‚è§¦å‘å…³é—­å¼¹çª—äº‹ä»¶"),Z("çª—å£æ‹–æ‹½",k.pops.pcDrag.KEY,k.pops.pcDrag.default,void 0,"é•¿æŒ‰æ ‡é¢˜æ å¯æ‹–æ‹½ç§»åŠ¨å¼¹çª—"),Z("é™åˆ¶æ‹–æ‹½è·ç¦»",k.pops.pcDragLimit.KEY,k.pops.pcDragLimit.default,void 0,"åªèƒ½åœ¨æµè§ˆå™¨çš„å¯è§†çª—å£å†…æ‹–åŠ¨"),Z("äºšå…‹åŠ›æ•ˆæœ",k.pops.popsAcrylic.KEY,k.pops.popsAcrylic.default,void 0,"")]}]},{type:"deepMenu",text:"æ–‡ä»¶å¼¹çª—",views:[{type:"container",text:"",className:"netdisk-panel-forms-pops-folder",views:[Me("æ’åºå",k.popsFolder["pops-folder-sort-name"].KEY,k.popsFolder["pops-folder-sort-name"].default,[{value:"fileName",text:"æ–‡ä»¶å"},{value:"latestTime",text:"ä¿®æ”¹æ—¶é—´"},{value:"fileSize",text:"å¤§å°"}],void 0,"å½“å‰çš„è§„åˆ™"),Me("æ’åºè§„åˆ™",k.popsFolder["pops-folder-sort-is-desc"].KEY,k.popsFolder["pops-folder-sort-is-desc"].default,[{value:false,text:"å‡åº"},{value:true,text:"é™åº"}],void 0,"å½“å‰çš„è§„åˆ™")]}]},{type:"deepMenu",text:"æ‚¬æµ®æŒ‰é’®",views:[{type:"container",text:"",views:[ye("å¤§å°",k.suspension.size.KEY,k.suspension.size.default,15,250,(t,e)=>{k.suspension.size.value=parseInt(e.toString()),S.$inst.suspension.$data.isShow&&(U.css(S.$inst.suspension.$el.$suspension,{width:k.suspension.size.value,height:k.suspension.size.value}),S.$inst.suspension.updatePosition(true));},t=>`${t}px`,"æ‚¬æµ®æŒ‰é’®çš„å¤§å°ï¼Œé»˜è®¤: "+k.suspension.size.default+"px"),ye("é€æ˜åº¦",k.suspension.opacity.KEY,k.suspension.opacity.default,.1,1,(t,e)=>{k.suspension.opacity.value=parseFloat(e.toString()),S.$inst.suspension.$data.isShow&&U.css(S.$inst.suspension.$el.$suspension,{opacity:k.suspension.opacity.value});},void 0,"å€¼è¶Šå°è¶Šé€æ˜ï¼Œé»˜è®¤: "+k.suspension.opacity.default,.1),ye("èƒŒæ™¯è½®æ’­æ—¶é—´",k.suspension["randbg-time"].KEY,k.suspension["randbg-time"].default,0,1e4,void 0,t=>`${t}ms`,"æ·¡å…¥/æ·¡å‡ºçš„æ—¶é—´ï¼Œé»˜è®¤: "+k.suspension["randbg-time"].default+"ms",100),ye("èƒŒæ™¯æ˜¾ç¤ºæ—¶é—´",k.suspension["randbg-show-time"].KEY,k.suspension["randbg-show-time"].default,0,1e4,void 0,t=>`${t}ms`,"å›¾æ ‡æ˜¾ç¤ºçš„æŒç»­æ—¶é—´ï¼Œé»˜è®¤: 1200",100),Z("å¸é™„è¾¹ç¼˜",k.suspension["suspended-button-adsorption-edge"].KEY,k.suspension["suspended-button-adsorption-edge"].default,void 0,"ç§»åŠ¨æ‚¬æµ®æŒ‰é’®æ¾å¼€åè‡ªåŠ¨å¸é™„è¾¹ç¼˜",void 0,void 0,()=>{Ge.updatePosition(false);}),bt("z-index",k.suspension["suspended-z-index"].KEY,k.suspension["suspended-z-index"].default,"å€¼å°äºç­‰äº0åˆ™ä¸ºåŠ¨æ€è·å–z-index",(t,e,a)=>(k.suspension["suspended-z-index"].value=a,true))]}]},{type:"deepMenu",text:"å¤§/å°é“¾æ¥å¼¹çª—",views:[{type:"container",text:"é€šç”¨é…ç½®",views:[bt("z-index",k.smallWindow["netdisk-link-view-z-index"].KEY,k.smallWindow["netdisk-link-view-z-index"].default,"å€¼å°äºç­‰äº0åˆ™ä¸ºåŠ¨æ€è·å–z-index",(t,e,a)=>(k.smallWindow["netdisk-link-view-z-index"].value=a,true))]},{type:"container",text:"æ•°æ®åˆ†é¡µæ˜¾ç¤º",views:[Z("å¯ç”¨",k.smallWindow["netdisk-ui-link-view-data-paging-enable"].KEY,k.smallWindow["netdisk-ui-link-view-data-paging-enable"].default,void 0,"å¦‚æœé¡µé¢çš„æ•°æ®é‡å¤§ï¼Œå»ºè®®å¼€å¯åˆ†é¡µä»¥æ˜¾ç¤ºé˜²æ­¢å¡é¡¿"),bt("åˆ†é¡µæ•°é‡",k.smallWindow["netdisk-ui-link-view-data-paging-show-data-count"].KEY,k.smallWindow["netdisk-ui-link-view-data-paging-show-data-count"].default,"æ¯é¡µæ˜¾ç¤ºçš„æ•°æ®æ•°é‡",void 0,"é»˜è®¤ï¼š10")]},{type:"container",text:"å°çª—",className:"netdisk-panel-forms-small-window",views:[ye("å®½åº¦",k.smallWindow["netdisk-ui-small-window-width"].KEY,k.smallWindow["netdisk-ui-small-window-width"].default,50,U.width(window),void 0,t=>`${t}px`,"è®¾ç½®å°çª—å®½åº¦(px)ï¼Œé»˜è®¤: 250",1),ye("é«˜åº¦",k.smallWindow["netdisk-ui-small-window-max-height"].KEY,k.smallWindow["netdisk-ui-small-window-max-height"].default,50,U.height(window),void 0,t=>`${t}px`,"è®¾ç½®å°çª—æœ€å¤§é«˜åº¦(px)ï¼Œé»˜è®¤: "+k.smallWindow["netdisk-ui-small-window-max-height"].default,1)]}]}]},{type:"container",text:"",views:[{type:"deepMenu",text:"åŠŸèƒ½",views:[{type:"container",text:"",className:"netdisk-panel-forms-function",views:[Me("åŒ¹é…æ¨¡å¼",k.features["netdisk-match-mode"].KEY,k.features["netdisk-match-mode"].default,[{text:"MutationObserver",value:"MutationObserver"},{text:"Menu",value:"Menu"}],void 0,"MutationObserveræ˜¯è‡ªåŠ¨ç›‘å¬å¹¶è¯†åˆ«é“¾æ¥<br>Menuæ˜¯æ‰‹åŠ¨ç‚¹å‡»æ²¹çŒ´èœå•è¿›è¡Œè¯†åˆ«"),Me("è¡Œä¸ºæ¨¡å¼",k.features["netdisk-behavior-mode"].KEY,k.features["netdisk-behavior-mode"].default,[{text:"æ‚¬æµ®æŒ‰é’®+å°çª—",value:"suspension_smallwindow"},{text:"æ‚¬æµ®æŒ‰é’®+å¤§çª—",value:"suspension_window"},{text:"å°çª—",value:"smallwindow"}],void 0,"åŒ¹é…åˆ°é“¾æ¥æ—¶è§¦å‘çš„UIæ‰§è¡Œ"),Z("è‡ªåŠ¨å¡«å……è®¿é—®ç ",k.features.autoFillAccessCode.KEY,k.features.autoFillAccessCode.default,void 0,"é€šè¿‡ä¸»åŠ¨ç‚¹å‡»é“¾æ¥è·³è½¬æ—¶ï¼Œä¼šè‡ªåŠ¨è¾“å…¥ç½‘ç›˜è®¿é—®ç ")]}]},{type:"deepMenu",text:"åŒ¹é…è®¾ç½®",views:[{type:"container",text:"æ–‡æœ¬åŒ¹é…èŒƒå›´",views:[Ft("åŒ¹é…è§„åˆ™ç±»å‹",k.match.pageMatchRange.KEY,k.match.pageMatchRange.default,[{value:"innerText",text:"æ™®é€šæ–‡æœ¬"},{value:"innerHTML",text:"è¶…æ–‡æœ¬"}],void 0,"æ‰§è¡Œçš„æ–‡æœ¬åŒ¹é…è§„åˆ™",void 0,{height:"auto"}),Z("æ·±å…¥ShadowRootè·å–åŒ¹é…æ–‡æœ¬",k.match.depthQueryWithShadowRoot.KEY,k.match.depthQueryWithShadowRoot.default,void 0,"éå†ShadowRootï¼Œè·å–åŒ¹é…çš„å†…å®¹"),Z("åŒ¹é…å‰ªè´´æ¿",k.match.readClipboard.KEY,k.match.readClipboard.default,void 0,"Apiå…¼å®¹æ€§æŸ¥çœ‹ï¼š<a href='https://caniuse.com/mdn-api_permissions_permission_clipboard-read' target='_blank'>è¯»å–å‰ªè´´æ¿æƒé™ç”³è¯·</a>ã€<a href='https://caniuse.com/mdn-api_clipboard_readtext' target='_blank'>ç›´æ¥è¯»å–å‰ªè´´æ¿</a>"),Z("åŒ¹é…å½“å‰URL",k.match.allowMatchLocationHref.KEY,k.match.allowMatchLocationHref.default,void 0,"æå–<code>window.location.href</code>è¿›è¡ŒåŒ¹é…"),Z("åŒ¹é…inputæ ‡ç­¾çš„å†…å®¹",k.match.toBeMatchedWithInputElementValue.KEY,k.match.toBeMatchedWithInputElementValue.default,void 0,"æå–é¡µé¢ä¸­çš„<code>&lt;input&gt;</code>çš„å†…å®¹è¿›è¡ŒåŒ¹é…"),Z("åŒ¹é…textareaæ ‡ç­¾çš„å†…å®¹",k.match.toBeMatchedTextAreaElementValue.KEY,k.match.toBeMatchedTextAreaElementValue.default,void 0,"æå–é¡µé¢ä¸­çš„<code>&lt;textarea&gt;</code>çš„å†…å®¹è¿›è¡ŒåŒ¹é…"),Z("åŒ¹é…ç½‘ç»œè¯·æ±‚çš„å†…å®¹",k.match.toBeMatchedXhrHookResponseText.KEY,k.match.toBeMatchedXhrHookResponseText.default,void 0,"åŠ«æŒxhrè¯·æ±‚å¹¶å¯¹è¯·æ±‚çš„å†…å®¹è¿›è¡ŒåŒ¹é…ï¼Œæ³¨æ„ï¼šè¯¥åŠŸèƒ½å¯èƒ½ä¼šå¯¼è‡´é¡µé¢çš„éƒ¨åˆ†åŠŸèƒ½å¼‚å¸¸ï¼Œè¯·è°¨æ…ä½¿ç”¨")]},{type:"container",text:"MutationObserverè§‚å¯Ÿå™¨",views:[ye("åŒ¹é…é—´éš”",k.match.delaytime.KEY,k.match.delaytime.default,0,5,void 0,t=>`${t}s`,"åŒ¹é…æ–‡æœ¬å®Œæ¯•åçš„å»¶è¿Ÿxxxç§’å…è®¸ä¸‹ä¸€æ¬¡åŒ¹é…",.1),Z("æ·»åŠ å…ƒç´ æ—¶è¿›è¡ŒåŒ¹é…",k.match.isAddedNodesToMatch.KEY,k.match.isAddedNodesToMatch.default,void 0,"å½“ç›‘å¬åˆ°é¡µé¢æ·»åŠ å…ƒç´ æ—¶æ‰è¿›è¡ŒåŒ¹é…æ–‡æœ¬"),Z("è§‚å¯Ÿå™¨ï¼šchildList",k.match["mutationObserver-childList"].KEY,k.match["mutationObserver-childList"].default,void 0,"å­èŠ‚ç‚¹çš„å˜åŠ¨ï¼ˆæ–°å¢ã€åˆ é™¤æˆ–è€…æ›´æ”¹ï¼‰"),Z("è§‚å¯Ÿå™¨ï¼šcharacterData",k.match["mutationObserver-characterData"].KEY,k.match["mutationObserver-characterData"].default,void 0,"èŠ‚ç‚¹å†…å®¹æˆ–èŠ‚ç‚¹æ–‡æœ¬çš„å˜åŠ¨"),Z("è§‚å¯Ÿå™¨ï¼šsubtree",k.match["mutationObserver-subtree"].KEY,k.match["mutationObserver-subtree"].default,void 0,"æ˜¯å¦å°†è§‚å¯Ÿå™¨åº”ç”¨äºè¯¥èŠ‚ç‚¹çš„æ‰€æœ‰åä»£èŠ‚ç‚¹")]}]},{type:"deepMenu",text:"ç½‘ç›˜å›¾æ ‡",views:[{type:"container",text:"",views:[Z("ç‚¹å‡»å®šä½åˆ†äº«ç ",k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode"].KEY,k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode"].default,void 0,"è‡ªåŠ¨æ»šåŠ¨é¡µé¢è‡³åŒ…å«åˆ†äº«ç çš„å…ƒç´ "),Z("é€‰ä¸­åˆ†äº«ç ",k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].KEY,k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].default,void 0,"ä½¿ç”¨å…‰æ ‡é€‰ä¸­åˆ†äº«ç /å…ƒç´ "),Z("å¾ªç¯å®šä½",k.smallIconNavgiator["pops-netdisk-icon-click-event-loop-find-sharecode"].KEY,k.smallIconNavgiator["pops-netdisk-icon-click-event-loop-find-sharecode"].default,void 0,"å…³é—­åˆ™æ˜¯æ¯ä¸€ä¸ªå…ƒç´ åªå®šä½ä¸€æ¬¡")]}]},{type:"deepMenu",text:"å†å²åŒ¹é…è®°å½•",views:[{type:"container",text:"",className:"netdisk-panel-history-match",views:[Z("ä¿å­˜åŒ¹é…è®°å½•",k.historyMatch.saveMatchNetDisk.KEY,k.historyMatch.saveMatchNetDisk.default,void 0,"å°†åŒ¹é…åˆ°çš„é“¾æ¥ä¿¡æ¯è¿›è¡Œæœ¬åœ°å­˜å‚¨ï¼Œå¯ç‚¹å‡»ã€æ²¹çŒ´èœå•-âš™ å†å²åŒ¹é…è®°å½•ã€‘è¿›è¡ŒæŸ¥çœ‹"),Z("åˆå¹¶ç›¸åŒé“¾æ¥",k.historyMatch["netdisk-history-match-merge-same-link"].KEY,k.historyMatch["netdisk-history-match-merge-same-link"].default,void 0,"å°†åˆå¹¶åŒ¹é…åˆ°çš„ç›¸åŒé“¾æ¥ï¼Œå¹¶æ›´æ–°å®ƒæœ€åä¸€æ¬¡åŒ¹é…åˆ°çš„æ›´æ–°æ—¶é—´ã€ç½‘å€ä¿¡æ¯"),Me("æ’åºè§„åˆ™",k.historyMatch["netdisk-history-match-ordering-rule"].KEY,k.historyMatch["netdisk-history-match-ordering-rule"].default,[{value:"æŒ‰ è®°å½•æ—¶é—´ - å‡åº",text:"æŒ‰ è®°å½•æ—¶é—´ - å‡åº"},{value:"æŒ‰ è®°å½•æ—¶é—´ - é™åº",text:"æŒ‰ è®°å½•æ—¶é—´ - é™åº"},{value:"æŒ‰ æ›´æ–°æ—¶é—´ - å‡åº",text:"æŒ‰ æ›´æ–°æ—¶é—´ - å‡åº"},{value:"æŒ‰ æ›´æ–°æ—¶é—´ - é™åº",text:"æŒ‰ æ›´æ–°æ—¶é—´ - é™åº"}]),Ct("ä¿®å¤å­˜å‚¨è®°å½•","å¦‚æœã€åŒ¹é…è®°å½•ã€‘å¼¹çª—æ‰“ä¸å¼€ï¼Œå¯èƒ½æ˜¯å­˜å‚¨çš„æ•°æ®ç¼ºå¤±æŸäº›å­—æ®µï¼Œå¯å°è¯•ç‚¹å‡»æ­¤å¤„è¿›è¡Œä¿®å¤","ä¿®å¤",void 0,void 0,false,"primary",t=>{U.preventEvent(t);try{const{count:e,repairCount:a}=S.$inst.historyMatch.checkAndRepairLocalData();a===0?g.info("ä¸å­˜åœ¨éœ€è¦ä¿®å¤çš„æ•°æ®"):g.success(`å…±è®¡: ${e} æ¡ï¼Œä¿®å¤${a}æ¡`);}catch(e){g.error("ä¿®å¤å¼‚å¸¸ï¼š"+e.toString());}})]}]},{type:"deepMenu",text:"åˆ†äº«ç ",views:[{type:"container",text:"",className:"netdisk-panel-forms-share-code",views:[Z("æ’é™¤åˆ†äº«ç ",k.shareCode.excludeIdenticalSharedCodes.KEY,k.shareCode.excludeIdenticalSharedCodes.default,void 0,"å¯ç”¨åä¼šæ ¹æ®ã€ç›¸åŒç³»æ•°ã€‘æ’é™¤æ‰åŒ¹é…åˆ°çš„åˆ†äº«ç "),ye("ç›¸åŒç³»æ•°",k.shareCode.excludeIdenticalSharedCodesCoefficient.KEY,k.shareCode.excludeIdenticalSharedCodesCoefficient.default,0,1,void 0,t=>t.toString(),"ä¾‹å¦‚åˆ†äº«ç : aaaaaaaabbï¼Œå®ƒçš„ç›¸åŒç³»æ•°æ˜¯0.8ï¼Œè®¾ç½®ç›¸åŒç³»æ•°â‰¥0.8æ—¶ä¼šè¢«æ’é™¤",.01)]}]},{type:"deepMenu",text:"è®¿é—®ç ",views:[{className:"netdisk-panel-forms-access-code",text:"",type:"container",views:[Z("å…è®¸æŸ¥è¯¢å†å²åŒ¹é…è®°å½•",k.accessCode.allowQueryHistoryMatchingAccessCode.KEY,k.accessCode.allowQueryHistoryMatchingAccessCode.default,void 0,"å½“è®¿é—®ç ä¸ºç©ºæ—¶ï¼Œè®¿é—®ç å°†ä»å†å²åŒ¹é…è®°å½•ä¸­æŸ¥è¯¢ï¼Œä¼˜å…ˆçº§ï¼šé¡µé¢åŒ¹é… < å†å²åŒ¹é…è®°å½• < ç½‘ç«™è§„åˆ™ < é»‘åå•")]}]},{type:"deepMenu",className:"netdisk-panel-forms-shortcut-keys-deepMenu",text:"å¿«æ·é”®",views:[{className:"netdisk-panel-forms-shortcut-keys",text:"",type:"container",views:[Te("ã€æ‰“å¼€ã€‘âš™ è®¾ç½®","","netdisk-keyboard-open-setting",void 0,"æš‚æ— å¿«æ·é”®","default",Ae.shortCut),Te("ã€æ‰“å¼€ã€‘âš™ å†å²åŒ¹é…è®°å½•","","netdisk-keyboard-open-history-matching-records",void 0,"æš‚æ— å¿«æ·é”®","default",Ae.shortCut),Te("ã€æ‰“å¼€ã€‘âš™ è®¿é—®ç è§„åˆ™","","netdisk-keyboard-open-accesscode-rule",void 0,"æš‚æ— å¿«æ·é”®","default",Ae.shortCut),Te("ã€æ‰“å¼€ã€‘âš™ æ·»åŠ é“¾æ¥è¯†åˆ«è§„åˆ™","","netdisk-keyboard-open-user-rule",void 0,"æš‚æ— å¿«æ·é”®","default",Ae.shortCut),Te("ã€æ‰“å¼€ã€‘âš™ ç½‘ç«™è§„åˆ™","","netdisk-keyboard-website-rule",void 0,"æš‚æ— å¿«æ·é”®","default",Ae.shortCut),Te("ã€æ‰“å¼€ã€‘âš™ å­—ç¬¦æ˜ å°„è§„åˆ™","","netdisk-keyboard-character-mapping",void 0,"æš‚æ— å¿«æ·é”®","default",Ae.shortCut),Te("ã€æ‰“å¼€ã€‘âš™ è¯†åˆ«æ–‡æœ¬","","netdisk-keyboard-open-proactively-recognize-text",void 0,"æš‚æ— å¿«æ·é”®","default",Ae.shortCut),Te("æ‰§è¡Œæ–‡æœ¬åŒ¹é…","","netdisk-keyboard-performPageTextMatchingManually",void 0,"æš‚æ— å¿«æ·é”®","default",Ae.shortCut),Te("è¯†åˆ«é€‰ä¸­å†…å®¹","","netdisk-keyboard-identifyTheSelectedContent",void 0,"æš‚æ— å¿«æ·é”®","default",Ae.shortCut)]}]}]}]});try{let t;t=RESOURCE_ICON,S.$inst.icon.assign(t),Object.assign(S.$inst.icon.src,t);}catch(t){m.error("init NetDisk icon error",t);}["input","select-multiple","select","slider","switch","textarea"].forEach(t=>{Fe.setStorageApi(t,{get(e,a){return ie(e,a)},set(e,a){he(e,a);}});});xe.init();de.init();ft.init();Be.addContentConfig([Jn()]);Be.addContentConfig(ft.getRulePanelContent());let ea=ut.getMenuOption(0);ea.callback=()=>{gt.show();};ut.updateMenuOption(ea);ut.addMenuOption([{key:"showNetDiskHistoryMatch",text:"âš™ å†å²åŒ¹é…è®°å½•",autoReload:false,isStoreValue:false,showText(t){return t},callback(){S.$inst.historyMatch.show();}},{key:"ruleManager",text:"âš™ è§„åˆ™ç®¡ç†å™¨",autoReload:false,isStoreValue:false,showText(t){return t},callback(){Qe.showView();}},{key:"showUserRule",text:"âš™ æ·»åŠ é“¾æ¥è¯†åˆ«è§„åˆ™",autoReload:false,isStoreValue:false,showText(t){return t},callback(){Ve.show(false);}},{key:"showMatchPasteText",text:"âš™ è¯†åˆ«æ–‡æœ¬",autoReload:false,isStoreValue:false,showText(t){return t},callback(){S.$inst.matchPasteText.show();}}]);F.init();V.init();Ae.init();h.onReady(()=>{Xe.init(),St.init(),q.init(),Qe.init();});

})(DOMUtils, pops, Utils, Qmsg, CryptoJS, DataPaging, Viewer);